
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://docs.kubestellar.io/main/en/Coding%20Milestones/PoC2023q1/example1/">
      
      
        <link rel="prev" href="../kubestellar-syncer/">
      
      
        <link rel="next" href="../where-resolver/">
      
      <link rel="icon" href="../../../../favicons/favicon.ico">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.0">
    
    
      
        <title>Extended Example - KubeStellar</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.402914a4.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=SapceMono:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"SapceMono";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../stylesheets/kubestellar.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-SR5TD1CXY7"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-SR5TD1CXY7",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-SR5TD1CXY7",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>

  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  <meta name="google-site-verification" content="QZFIkG95fMxODWgQDK2OUn73HUIu9fZmuTer-ZA4UwI" />

  <!-- Determine title -->
  
  
    
  

  <!-- The image needs to have an absolute URL -->
  

  <!-- Open graph meta tags -->
  <meta property="og:type" content="website" />
  <meta property="og:title" content="KubeStellar - Extended Example" />
  <meta property="og:description" content="None" />
  <meta property="og:url" content="https://docs.kubestellar.io/main/en/Coding%20Milestones/PoC2023q1/example1/" />
  <meta property="og:image" content="https://docs.kubestellar.io/mainassets/images/illustrations/banner.png" />
  <meta property="og:image:type" content="image/png" />
  <meta property="og:image:width" content="1080" />
  <meta property="og:image:height" content="568" />

  <!-- google-site-verification meta-tag -->
  <meta name="google-site-verification" content="-Rj8YMCn9uu5IwOFdC-WfAzXp4ZOMJtYKxU40ZgcJIU" />

<!-- Extra stylesheets -->
<!--  <link
    rel="stylesheet"
    href="../../../../assets/stylesheets/overrides.css"
  />-->

  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#stage-1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
            
  <!-- Extra stylesing -->
  <style>
      .md-announce a,
      .md-announce a:focus,
      .md-announce a:hover{color:currentColor}.md-announce
      strong{white-space:nowrap}.md-announce
  </style>

<!--   
  <a href="https://www.linkedin.com/feed/hashtag/?keywords=kubestellar">
  <p style="color: #D5EE1C">For updates follow <strong style="color: #D5EE1C">@kubestellar</strong> on
    <strong style="color: white">LinkedIn</strong>
  </p>
</a> 
-->

<a href="https://www.linkedin.com/feed/hashtag/?keywords=kubestellar">
  <p style="color: #D5EE1C">Visit us at <strong style="color: #D5EE1C">KubeCon North America</strong> in Chicago November 6-9th, and follow us <strong style="color: #D5EE1C">@kubestellar</strong> on
    <strong style="color: white">LinkedIn</strong>
  </p>
</a>


          </div>
          
        </aside>
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the stable release.
  <a href="../latest/../../../..">
    <strong>Click here to go to the stable release</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../" title="KubeStellar" class="md-header__button md-logo" aria-label="KubeStellar" data-md-component="logo">
      
  <img src="../../../../logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            KubeStellar
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Extended Example
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/kubestellar/kubestellar" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../" class="md-tabs__link">
        Home
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../Getting-Started/user-quickstart-kind/" class="md-tabs__link">
        Getting Started
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../Contribution%20guidelines/CONTRIBUTING/" class="md-tabs__link">
        Contributing
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../outline/" class="md-tabs__link md-tabs__link--active">
        Coding Milestones
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../Community/_index/" class="md-tabs__link">
        Community
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="https://medium.com/@kubestellar/list/predefined:e785a0675051:READING_LIST" target="_blank" class="md-tabs__link">
      Blog
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../" title="KubeStellar" class="md-nav__button md-logo" aria-label="KubeStellar" data-md-component="logo">
      
  <img src="../../../../logo.png" alt="logo">

    </a>
    KubeStellar
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/kubestellar/kubestellar" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../">Home</a>
          
            <label for="__nav_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Home
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../readme/" class="md-nav__link">
        Readme
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Getting-Started/user-quickstart-kind/" class="md-nav__link">
        Quickstart using Kind
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Getting-Started/user-quickstart-openshift/" class="md-nav__link">
        Quickstart using OpenShift
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Getting Started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Getting-Started/user-quickstart-kind/" class="md-nav__link">
        Quickstart using Kind
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Getting-Started/user-quickstart-openshift/" class="md-nav__link">
        Quickstart using OpenShift
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Getting-Started/user-quickstart-test/" class="md-nav__link">
        Quickstart for testing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Getting-Started/quickstart/" class="md-nav__link">
        Detailed QuickStart
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Extended Example
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Extended Example
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#stage-1" class="md-nav__link">
    Stage 1
  </a>
  
    <nav class="md-nav" aria-label="Stage 1">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-two-kind-clusters" class="md-nav__link">
    Create two kind clusters.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-kind-cluster-for-space-management" class="md-nav__link">
    Create Kind cluster for space management
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-space-manager-controller" class="md-nav__link">
    The space-manager controller
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-kcp-and-kubestellar" class="md-nav__link">
    Deploy kcp and KubeStellar
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-kcp-and-kubestellar-as-bare-processes" class="md-nav__link">
    Deploy kcp and KubeStellar as bare processes
  </a>
  
    <nav class="md-nav" aria-label="Deploy kcp and KubeStellar as bare processes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#start-kcp" class="md-nav__link">
    Start kcp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-a-space-provider-description-for-kcp" class="md-nav__link">
    Create a space provider description for KCP
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-kubestellar" class="md-nav__link">
    Get KubeStellar
  </a>
  
    <nav class="md-nav" aria-label="Get KubeStellar">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-pre-built-archive" class="md-nav__link">
    Use pre-built archive
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-from-github" class="md-nav__link">
    Get from GitHub
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-binaries-of-kube-bind-and-dex" class="md-nav__link">
    Get binaries of kube-bind and dex
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initialize-the-kubestellar-platform-as-bare-processes" class="md-nav__link">
    Initialize the KubeStellar platform as bare processes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-kcp-and-kubestellar-as-a-workload-in-a-kubernetes-cluster" class="md-nav__link">
    Deploy kcp and KubeStellar as a workload in a Kubernetes cluster
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-synctarget-and-location-objects-to-represent-the-florin-and-guilder-clusters" class="md-nav__link">
    Create SyncTarget and Location objects to represent the florin and guilder clusters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-mailbox-controller" class="md-nav__link">
    The mailbox controller
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connect-guilder-edge-cluster-with-its-mailbox-workspace" class="md-nav__link">
    Connect guilder edge cluster with its mailbox workspace
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connect-florin-edge-cluster-with-its-mailbox-workspace" class="md-nav__link">
    Connect florin edge cluster with its mailbox workspace
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stage-2" class="md-nav__link">
    Stage 2
  </a>
  
    <nav class="md-nav" aria-label="Stage 2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-and-populate-the-workload-management-workspace-for-the-common-workload" class="md-nav__link">
    Create and populate the workload management workspace for the common workload
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-and-populate-the-workload-management-workspace-for-the-special-workload" class="md-nav__link">
    Create and populate the workload management workspace for the special workload
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#where-resolver" class="md-nav__link">
    Where Resolver
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stage-3" class="md-nav__link">
    Stage 3
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stage-4" class="md-nav__link">
    Stage 4
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stage-5" class="md-nav__link">
    Stage 5
  </a>
  
    <nav class="md-nav" aria-label="Stage 5">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#singleton-reported-state-return" class="md-nav__link">
    Singleton reported state return
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#status-summarization-aspirational" class="md-nav__link">
    Status Summarization (aspirational)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#teardown-the-environment" class="md-nav__link">
    Teardown the environment
  </a>
  
    <nav class="md-nav" aria-label="Teardown the environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#teardown-bare-processes" class="md-nav__link">
    Teardown bare processes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#teardown-kubernetes-workload" class="md-nav__link">
    Teardown Kubernetes workload
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Getting-Started/user-guide/" class="md-nav__link">
        User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Getting-Started/infomercial/" class="md-nav__link">
        KubeStellar - The Infomercial
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Contributing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Contributing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Contribution%20guidelines/CONTRIBUTING/" class="md-nav__link">
        Guidelines
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Contribution%20guidelines/coc/" class="md-nav__link">
        Code of Conduct
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Contribution%20guidelines/LICENSE/" class="md-nav__link">
        License
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Contribution%20guidelines/governance/" class="md-nav__link">
        Governance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Contribution%20guidelines/onboarding/" class="md-nav__link">
        Onboarding
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
          Security
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_6">
          <span class="md-nav__icon md-icon"></span>
          Security
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Contribution%20guidelines/security/security/" class="md-nav__link">
        Policy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Contribution%20guidelines/security/security_contacts/" class="md-nav__link">
        Contacts
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" >
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
          Operations
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_7">
          <span class="md-nav__icon md-icon"></span>
          Operations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Contribution%20guidelines/operations/code-management/" class="md-nav__link">
        Code Management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Contribution%20guidelines/operations/packaging-and-versioning/" class="md-nav__link">
        Packaging and Versioning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Contribution%20guidelines/operations/release-management/" class="md-nav__link">
        Release Management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Contribution%20guidelines/operations/document-management/" class="md-nav__link">
        Document Management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Contribution%20guidelines/operations/testing-doc-prs/" class="md-nav__link">
        Testing Documentation PRs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Coding Milestones
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Coding Milestones
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" checked>
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
          PoC2023q1
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          PoC2023q1
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../outline/" class="md-nav__link">
        Details
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../coding-milestone-invite-q1/" class="md-nav__link">
        Invitation to Contribute
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubestellar-syncer/" class="md-nav__link">
        KubeStellar-Syncer
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Extended Example
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Extended Example
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#stage-1" class="md-nav__link">
    Stage 1
  </a>
  
    <nav class="md-nav" aria-label="Stage 1">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-two-kind-clusters" class="md-nav__link">
    Create two kind clusters.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-kind-cluster-for-space-management" class="md-nav__link">
    Create Kind cluster for space management
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-space-manager-controller" class="md-nav__link">
    The space-manager controller
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-kcp-and-kubestellar" class="md-nav__link">
    Deploy kcp and KubeStellar
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-kcp-and-kubestellar-as-bare-processes" class="md-nav__link">
    Deploy kcp and KubeStellar as bare processes
  </a>
  
    <nav class="md-nav" aria-label="Deploy kcp and KubeStellar as bare processes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#start-kcp" class="md-nav__link">
    Start kcp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-a-space-provider-description-for-kcp" class="md-nav__link">
    Create a space provider description for KCP
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-kubestellar" class="md-nav__link">
    Get KubeStellar
  </a>
  
    <nav class="md-nav" aria-label="Get KubeStellar">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-pre-built-archive" class="md-nav__link">
    Use pre-built archive
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-from-github" class="md-nav__link">
    Get from GitHub
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-binaries-of-kube-bind-and-dex" class="md-nav__link">
    Get binaries of kube-bind and dex
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initialize-the-kubestellar-platform-as-bare-processes" class="md-nav__link">
    Initialize the KubeStellar platform as bare processes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-kcp-and-kubestellar-as-a-workload-in-a-kubernetes-cluster" class="md-nav__link">
    Deploy kcp and KubeStellar as a workload in a Kubernetes cluster
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-synctarget-and-location-objects-to-represent-the-florin-and-guilder-clusters" class="md-nav__link">
    Create SyncTarget and Location objects to represent the florin and guilder clusters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-mailbox-controller" class="md-nav__link">
    The mailbox controller
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connect-guilder-edge-cluster-with-its-mailbox-workspace" class="md-nav__link">
    Connect guilder edge cluster with its mailbox workspace
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connect-florin-edge-cluster-with-its-mailbox-workspace" class="md-nav__link">
    Connect florin edge cluster with its mailbox workspace
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stage-2" class="md-nav__link">
    Stage 2
  </a>
  
    <nav class="md-nav" aria-label="Stage 2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-and-populate-the-workload-management-workspace-for-the-common-workload" class="md-nav__link">
    Create and populate the workload management workspace for the common workload
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-and-populate-the-workload-management-workspace-for-the-special-workload" class="md-nav__link">
    Create and populate the workload management workspace for the special workload
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#where-resolver" class="md-nav__link">
    Where Resolver
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stage-3" class="md-nav__link">
    Stage 3
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stage-4" class="md-nav__link">
    Stage 4
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stage-5" class="md-nav__link">
    Stage 5
  </a>
  
    <nav class="md-nav" aria-label="Stage 5">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#singleton-reported-state-return" class="md-nav__link">
    Singleton reported state return
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#status-summarization-aspirational" class="md-nav__link">
    Status Summarization (aspirational)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#teardown-the-environment" class="md-nav__link">
    Teardown the environment
  </a>
  
    <nav class="md-nav" aria-label="Teardown the environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#teardown-bare-processes" class="md-nav__link">
    Teardown bare processes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#teardown-kubernetes-workload" class="md-nav__link">
    Teardown Kubernetes workload
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_5" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_1_5" id="__nav_4_1_5_label" tabindex="0">
          KubeStellar Processes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_1_5">
          <span class="md-nav__icon md-icon"></span>
          KubeStellar Processes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../where-resolver/" class="md-nav__link">
        KubeStellar Where Resolver
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mailbox-controller/" class="md-nav__link">
        KubeStellar Mailbox Controller
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../placement-translator/" class="md-nav__link">
        KubeStellar Placement Translator
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../roadmap-uses/" class="md-nav__link">
        Use Cases Affecting the Roadmap for PoC2023q1
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_7" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_1_7" id="__nav_4_1_7_label" tabindex="0">
          Environments
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_1_7">
          <span class="md-nav__icon md-icon"></span>
          Environments
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../environments/_index/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../environments/cloud-env/" class="md-nav__link">
        Cloud Environment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../environments/dev-env/" class="md-nav__link">
        Developer Environment
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_8" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_1_8" id="__nav_4_1_8_label" tabindex="0">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_1_8">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../commands/" class="md-nav__link">
        Commands
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
          PoC2023q4
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          PoC2023q4
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../PoC2023q4/outline/" class="md-nav__link">
        Details
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Community
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Community
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Community/_index/" class="md-nav__link">
        Get Involved
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://docs.kubestellar.io/main/Contribution%20guidelines/CONTRIBUTING/" class="md-nav__link">
        Contributor Guidelines
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
          Contact Us
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5_3">
          <span class="md-nav__icon md-icon"></span>
          Contact Us
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://kubestellar.io/join_us" class="md-nav__link">
        Mailing List
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://kubestellar.io/agenda" class="md-nav__link">
        Community Meeting Agenda (join mailing list first)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://kubestellar.io/slack" class="md-nav__link">
        Slack
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://kubestellar.io/blog" class="md-nav__link">
        Medium Blog
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://kubestellar.io/tv" class="md-nav__link">
        YouTube Channel
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://kubestellar.io/linkedin" class="md-nav__link">
        LinkedIn
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://www.reddit.com/r/kubestellar/" class="md-nav__link">
        Reddit
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://drive.google.com/drive/u/1/folders/1p68MwkX0sYdTvtup0DcnAEsnXElobFLS" class="md-nav__link">
        Google Drive
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
          Partners
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5_4">
          <span class="md-nav__icon md-icon"></span>
          Partners
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Community/partners/argocd/" class="md-nav__link">
        ArgoCD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Community/partners/turbonomic/" class="md-nav__link">
        Turbonomic
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Community/partners/mvi/" class="md-nav__link">
        MVI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Community/partners/fluxcd/" class="md-nav__link">
        FluxCD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Community/partners/openziti/" class="md-nav__link">
        OpenZiti
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Community/partners/kyverno/" class="md-nav__link">
        Kyverno
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://medium.com/@kubestellar/list/predefined:e785a0675051:READING_LIST" target="_blank" class="md-nav__link">
        Blog
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#stage-1" class="md-nav__link">
    Stage 1
  </a>
  
    <nav class="md-nav" aria-label="Stage 1">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-two-kind-clusters" class="md-nav__link">
    Create two kind clusters.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-kind-cluster-for-space-management" class="md-nav__link">
    Create Kind cluster for space management
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-space-manager-controller" class="md-nav__link">
    The space-manager controller
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-kcp-and-kubestellar" class="md-nav__link">
    Deploy kcp and KubeStellar
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-kcp-and-kubestellar-as-bare-processes" class="md-nav__link">
    Deploy kcp and KubeStellar as bare processes
  </a>
  
    <nav class="md-nav" aria-label="Deploy kcp and KubeStellar as bare processes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#start-kcp" class="md-nav__link">
    Start kcp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-a-space-provider-description-for-kcp" class="md-nav__link">
    Create a space provider description for KCP
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-kubestellar" class="md-nav__link">
    Get KubeStellar
  </a>
  
    <nav class="md-nav" aria-label="Get KubeStellar">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-pre-built-archive" class="md-nav__link">
    Use pre-built archive
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-from-github" class="md-nav__link">
    Get from GitHub
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-binaries-of-kube-bind-and-dex" class="md-nav__link">
    Get binaries of kube-bind and dex
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initialize-the-kubestellar-platform-as-bare-processes" class="md-nav__link">
    Initialize the KubeStellar platform as bare processes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-kcp-and-kubestellar-as-a-workload-in-a-kubernetes-cluster" class="md-nav__link">
    Deploy kcp and KubeStellar as a workload in a Kubernetes cluster
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-synctarget-and-location-objects-to-represent-the-florin-and-guilder-clusters" class="md-nav__link">
    Create SyncTarget and Location objects to represent the florin and guilder clusters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-mailbox-controller" class="md-nav__link">
    The mailbox controller
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connect-guilder-edge-cluster-with-its-mailbox-workspace" class="md-nav__link">
    Connect guilder edge cluster with its mailbox workspace
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connect-florin-edge-cluster-with-its-mailbox-workspace" class="md-nav__link">
    Connect florin edge cluster with its mailbox workspace
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stage-2" class="md-nav__link">
    Stage 2
  </a>
  
    <nav class="md-nav" aria-label="Stage 2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-and-populate-the-workload-management-workspace-for-the-common-workload" class="md-nav__link">
    Create and populate the workload management workspace for the common workload
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-and-populate-the-workload-management-workspace-for-the-special-workload" class="md-nav__link">
    Create and populate the workload management workspace for the special workload
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#where-resolver" class="md-nav__link">
    Where Resolver
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stage-3" class="md-nav__link">
    Stage 3
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stage-4" class="md-nav__link">
    Stage 4
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stage-5" class="md-nav__link">
    Stage 5
  </a>
  
    <nav class="md-nav" aria-label="Stage 5">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#singleton-reported-state-return" class="md-nav__link">
    Singleton reported state return
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#status-summarization-aspirational" class="md-nav__link">
    Status Summarization (aspirational)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#teardown-the-environment" class="md-nav__link">
    Teardown the environment
  </a>
  
    <nav class="md-nav" aria-label="Teardown the environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#teardown-bare-processes" class="md-nav__link">
    Teardown bare processes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#teardown-kubernetes-workload" class="md-nav__link">
    Teardown Kubernetes workload
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/kubestellar/kubestellar/edit/main/docs/content/Coding Milestones/PoC2023q1/example1.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/kubestellar/kubestellar/raw/main/docs/content/Coding Milestones/PoC2023q1/example1.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg>
    </a>
  


  <h1>Extended Example</h1>

<p><a href="https://github.com/kubestellar/kubestellar/actions/workflows/docs-ecutable-example1.yml"><img alt="docs-ecutable - example1" src="https://github.com/kubestellar/kubestellar/actions/workflows/docs-ecutable-example1.yml/badge.svg?branch=main" /></a></p>
<!-- BEGIN INCLUDE ../../common-subs/required-packages.md '&lt;!--required-packages-start--&gt;' '&lt;!--required-packages-end--&gt;' -->

<div class="admonition tip">
<p class="admonition-title">Required Packages for running and using KubeStellar:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:7"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><input id="__tabbed_1_3" name="__tabbed_1" type="radio" /><input id="__tabbed_1_4" name="__tabbed_1" type="radio" /><input id="__tabbed_1_5" name="__tabbed_1" type="radio" /><input id="__tabbed_1_6" name="__tabbed_1" type="radio" /><input id="__tabbed_1_7" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">General</label><label for="__tabbed_1_2">Mac</label><label for="__tabbed_1_3">Ubuntu</label><label for="__tabbed_1_4">Debian</label><label for="__tabbed_1_5">Fedora/RHEL/CentOS</label><label for="__tabbed_1_6">Windows</label><label for="__tabbed_1_7">WSL with Ubuntu</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>You will need the following tools to deploy and use KubeStellar. 
Select the tab for your environment for suggested commands to install them</p>
<ul>
<li>
<p><strong>curl</strong> (omitted from most OS-specific instructions)</p>
</li>
<li>
<p><a href="https://stedolan.github.io/jq/download/"><strong>jq</strong></a></p>
</li>
<li>
<p><a href="https://github.com/mikefarah/yq#install"><strong>yq</strong></a></p>
</li>
<li>
<p><a href="https://kubernetes.io/docs/tasks/tools/"><strong>kubectl</strong></a> (version range expected: 1.23-1.25)</p>
</li>
<li>
<p><a href="https://helm.sh/docs/intro/install/"><strong>helm</strong></a> (required when deploying as workload)</p>
</li>
</ul>
<p><strong>If you intend to build kubestellar from source</strong>  you will also need </p>
<ul>
<li>
<p><a href="https://go.dev/doc/install"><strong>go</strong></a> (Go version &gt;=1.19 required; 1.19 recommended) [<strong>go releases</strong>] (https://go.dev/dl)</p>
</li>
<li>
<p>for simplicity, here's a <a href="https://go.dev/dl"><strong>direct link to go releases</strong></a> Remember you need go v1.19 or greater; 1.19 recommended!</p>
</li>
</ul>
</div>
<div class="tabbed-block">
<p><div class="highlight"><span class="filename">jq - https://stedolan.github.io/jq/download/</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>brew install jq
</code></pre></div>
<div class="highlight"><span class="filename">yq - https://github.com/mikefarah/yq#install</span><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>brew install yq
</code></pre></div>
<div class="highlight"><span class="filename">kubectl - https://kubernetes.io/docs/tasks/tools/ (version range expected: 1.23-1.25)</span><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>brew install kubectl
</code></pre></div>
<div class="highlight"><span class="filename">helm (required when deploying as workload) - https://helm.sh/docs/intro/install/</span><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>brew install helm
</code></pre></div>
<div class="highlight"><span class="filename">go (only required if you build kubestellar from source)</span><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>
</code></pre></div></p>
<ol>
<li>
<p>Download the package from <a href="https://go.dev/dl#go1.19"><strong>https://go.dev/dl#go1.19</strong></a>  Be sure to get the correct one for your architecture</p>
</li>
<li>
<p>Open the package file you downloaded and follow the prompts to install Go.
   The package installs the Go distribution to /usr/local/go. The package should put the /usr/local/go/bin directory in your PATH environment variable. You may need to restart any open Terminal sessions for the change to take effect.</p>
</li>
<li>
<p>Verify that you've installed Go by opening a command prompt and typing the following command:
      <code>$ go version</code>
   Confirm that the command prints the desired installed version of Go. </p>
</li>
</ol>
</div>
<div class="tabbed-block">
<p><div class="highlight"><span class="filename">jq - https://stedolan.github.io/jq/download/</span><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>sudo apt-get install jq
</code></pre></div>
<div class="highlight"><span class="filename">yq - https://github.com/mikefarah/yq#install</span><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>sudo snap install yq
</code></pre></div>
<div class="highlight"><span class="filename">kubectl - https://kubernetes.io/docs/tasks/tools/ (version range expected: 1.23-1.25)</span><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>curl -LO &quot;https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/$(dpkg --print-architecture)/kubectl&quot; &amp;&amp; chmod +x kubectl &amp;&amp; sudo mv ./kubectl /usr/local/bin/kubectl
</code></pre></div>
<div class="highlight"><span class="filename">helm (required when deploying as workload) - https://helm.sh/docs/intro/install/</span><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>curl https://baltocdn.com/helm/signing.asc | gpg --dearmor | sudo tee /usr/share/keyrings/helm.gpg &gt; /dev/null
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>sudo apt-get install apt-transport-https --yes
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>echo &quot;deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/helm.gpg] https://baltocdn.com/helm/stable/debian/ all main&quot; | sudo tee /etc/apt/sources.list.d/helm-stable-debian.list
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>sudo apt-get update
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>sudo apt-get install helm
</code></pre></div>
<div class="highlight"><span class="filename">go (only required if you build kubestellar from source)</span><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>
</code></pre></div></p>
<p>visit https://go.dev/doc/install for latest instructions</p>
<ol>
<li>
<p>Remove any previous Go installation by deleting the /usr/local/go folder (if it exists), then extract the archive you just downloaded into /usr/local, creating a fresh Go tree in /usr/local/go:</p>
<p><code>$ rm -rf /usr/local/go &amp;&amp; tar -C /usr/local -xzf go1.21.3.linux-amd64.tar.gz</code></p>
<p>(You may need to run the command as root or through sudo).</p>
<p><strong>Do not</strong> untar the archive into an existing /usr/local/go tree. This is known to produce broken Go installations.</p>
</li>
<li>
<p>Add /usr/local/go/bin to the PATH environment variable.
      You can do this by adding the following line to your $HOME/.profile or /etc/profile (for a system-wide installation):</p>
<p><code>export PATH=$PATH:/usr/local/go/bin</code></p>
<p><strong>Note:</strong> Changes made to a profile file may not apply until the next time you log into your computer. To apply the changes immediately, just run the shell commands directly or execute them from the profile using a command such as source $HOME/.profile.</p>
</li>
<li>
<p>Verify that you've installed Go by opening a command prompt and typing the following command:</p>
<p><code>$ go version</code></p>
</li>
<li>
<p>Confirm that the command prints the installed version of Go.</p>
</li>
</ol>
</div>
<div class="tabbed-block">
<p><div class="highlight"><span class="filename">jq - https://stedolan.github.io/jq/download/</span><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>sudo apt-get install jq
</code></pre></div>
<div class="highlight"><span class="filename">yq - https://github.com/mikefarah/yq#install</span><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>sudo apt-get install yq
</code></pre></div>
<div class="highlight"><span class="filename">kubectl - https://kubernetes.io/docs/tasks/tools/ (version range expected: 1.23-1.25)</span><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>curl -LO &quot;https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/$(dpkg --print-architecture)/kubectl&quot; &amp;&amp; chmod +x kubectl &amp;&amp; sudo mv ./kubectl /usr/local/bin/kubectl
</code></pre></div>
<div class="highlight"><span class="filename">helm (required when deploying as workload) - https://helm.sh/docs/intro/install/</span><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>curl https://baltocdn.com/helm/signing.asc | gpg --dearmor | sudo tee /usr/share/keyrings/helm.gpg &gt; /dev/null
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>sudo apt-get install apt-transport-https --yes
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>echo &quot;deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/helm.gpg] https://baltocdn.com/helm/stable/debian/ all main&quot; | sudo tee /etc/apt/sources.list.d/helm-stable-debian.list
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>sudo apt-get update
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>sudo apt-get install helm
</code></pre></div>
<div class="highlight"><span class="filename">go (only required if you build kubestellar from source)</span><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>
</code></pre></div></p>
<p>visit https://go.dev/doc/install for latest instructions</p>
<ol>
<li>
<p>Remove any previous Go installation by deleting the /usr/local/go folder (if it exists), then extract the archive you just downloaded into /usr/local, creating a fresh Go tree in /usr/local/go:</p>
<p><code>$ rm -rf /usr/local/go &amp;&amp; tar -C /usr/local -xzf go1.21.3.linux-amd64.tar.gz</code></p>
<p>(You may need to run the command as root or through sudo).</p>
<p><strong>Do not</strong> untar the archive into an existing /usr/local/go tree. This is known to produce broken Go installations.</p>
</li>
<li>
<p>Add /usr/local/go/bin to the PATH environment variable.
      You can do this by adding the following line to your $HOME/.profile or /etc/profile (for a system-wide installation):</p>
<p><code>export PATH=$PATH:/usr/local/go/bin</code></p>
<p><strong>Note:</strong> Changes made to a profile file may not apply until the next time you log into your computer. To apply the changes immediately, just run the shell commands directly or execute them from the profile using a command such as source $HOME/.profile.</p>
</li>
<li>
<p>Verify that you've installed Go by opening a command prompt and typing the following command:</p>
<p><code>$ go version</code></p>
</li>
<li>
<p>Confirm that the command prints the installed version of Go.</p>
</li>
</ol>
</div>
<div class="tabbed-block">
<p><div class="highlight"><span class="filename">jq - https://stedolan.github.io/jq/download/</span><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>yum -y install jq
</code></pre></div>
<div class="highlight"><span class="filename">yq - https://github.com/mikefarah/yq#install</span><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a># easiest to install with snap
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>snap install yq
</code></pre></div>
<div class="highlight"><span class="filename">kubectl - https://kubernetes.io/docs/tasks/tools/ (version range expected: 1.23-1.25)</span><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a># For AMD64 / x86_64
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>[ $(uname -m) = x86_64 ] &amp;&amp; curl -LO &quot;https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl&quot; &amp;&amp; chmod +x kubectl &amp;&amp; mv ./kubectl /usr/local/bin/kubectl
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a># for ARM64 / aarch64
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>[ $(uname -m) = aarch64 ] &amp;&amp; curl -LO &quot;https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/arm64/kubectl&quot; &amp;&amp; chmod +x kubectl &amp;&amp; mv ./kubectl /usr/local/bin/kubectl
</code></pre></div>
<div class="highlight"><span class="filename">helm (required when deploying as workload) - https://helm.sh/docs/intro/install/</span><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>dnf install helm
</code></pre></div>
<div class="highlight"><span class="filename">go (only required if you build kubestellar from source)</span><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>
</code></pre></div></p>
<p>visit https://go.dev/doc/install for latest instructions</p>
<ol>
<li>
<p>Remove any previous Go installation by deleting the /usr/local/go folder (if it exists), then extract the archive you just downloaded into /usr/local, creating a fresh Go tree in /usr/local/go:</p>
<p><code>$ rm -rf /usr/local/go &amp;&amp; tar -C /usr/local -xzf go1.21.3.linux-amd64.tar.gz</code></p>
<p>(You may need to run the command as root or through sudo).</p>
<p><strong>Do not</strong> untar the archive into an existing /usr/local/go tree. This is known to produce broken Go installations.</p>
</li>
<li>
<p>Add /usr/local/go/bin to the PATH environment variable.
      You can do this by adding the following line to your $HOME/.profile or /etc/profile (for a system-wide installation):</p>
<p><code>export PATH=$PATH:/usr/local/go/bin</code></p>
<p><strong>Note:</strong> Changes made to a profile file may not apply until the next time you log into your computer. To apply the changes immediately, just run the shell commands directly or execute them from the profile using a command such as source $HOME/.profile.</p>
</li>
<li>
<p>Verify that you've installed Go by opening a command prompt and typing the following command:</p>
<p><code>$ go version</code></p>
</li>
<li>
<p>Confirm that the command prints the installed version of Go.</p>
</li>
</ol>
</div>
<div class="tabbed-block">
<p><div class="highlight"><span class="filename">Chocolatey - https://chocolatey.org/install#individual</span><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString(&#39;https://community.chocolatey.org/install.ps1&#39;))
</code></pre></div>
<div class="highlight"><span class="filename">curl</span><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>choco install curl -y
</code></pre></div>
<div class="highlight"><span class="filename">jq - https://stedolan.github.io/jq/download/</span><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>choco install jq -y
</code></pre></div>
<div class="highlight"><span class="filename">yq - https://github.com/mikefarah/yq#install</span><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>choco install yq -y
</code></pre></div>
<div class="highlight"><span class="filename">kubectl - https://kubernetes.io/docs/tasks/tools/install-kubectl-windows/ (version range expected: 1.23-1.25)</span><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>curl.exe -LO &quot;https://dl.k8s.io/release/v1.27.2/bin/windows/amd64/kubectl.exe&quot;    
</code></pre></div>
<div class="highlight"><span class="filename">helm (required when deploying as workload) - https://helm.sh/docs/intro/install/</span><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>choco install kubernetes-helm
</code></pre></div>
<div class="highlight"><span class="filename">go (only required if you build kubestellar from source)</span><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>visit https://go.dev/doc/install for latest instructions
</code></pre></div></p>
<ol>
<li>
<p>Download the go 1.19 MSI package from <a href="https://go.dev/dl#go1.19"><strong>https://go.dev/dl#go1.19</strong></a>  Be sure to get the correct one for your architecture</p>
</li>
<li>
<p>Open the MSI file you downloaded and follow the prompts to install Go.</p>
<p>By default, the installer will install Go to Program Files or Program Files (x86). You can change the location as needed. After installing, you will need to close and reopen any open command prompts so that changes to the environment made by the installer are reflected at the command prompt. </p>
</li>
<li>
<p>Verify that you've installed Go:</p>
<ol>
<li>
<p>In Windows, click the Start menu.</p>
</li>
<li>
<p>In the menu's search box, type cmd, then press the Enter key.</p>
</li>
<li>
<p>In the Command Prompt window that appears, type the following command:
    <code>$ go version</code></p>
</li>
<li>
<p>Confirm that the command prints the installed version of Go.</p>
</li>
</ol>
</li>
</ol>
</div>
<div class="tabbed-block">
<p><h3>How to install pre-requisites for a Windows Subsystem for Linux (WSL) envronment using an Ubuntu 22.04.01 distribution</h3></p>
<p>(Tested on a Intel(R) Core(TM) i7-9850H CPU @ 2.60GHz 2.59 GHz with 32GB RAM, a 64-bit operating system, x64-based processor
Using Windows 11 Enterprise)</p>
<p><h6> 1. If you're using a VPN, turn it off</h6></p>
<p><h6> 2. Install Ubuntu into WSL</h6></p>
<p><h6> 2.0 If wsl is not yet installed, open a powershell administrator window and run the following</h6>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>wsl --install
</code></pre></div>
<h6> 2.1 reboot your system</h6></p>
<p><h6> 2.2 In a Windows command terminal run the following to list all the linux distributions that are available online</h6>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>wsl -l -o
</code></pre></div>
<h6> 2.3 Select a linux distribution and install it into WSL</h6>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>wsl --install -d Ubuntu 22.04.01
</code></pre></div>
You will see something like:
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>Installing, this may take a few minutes...
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>Please create a default UNIX user account. The username does not need to match your Windows username.
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>For more information visit: https://aka.ms/wslusers
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>Enter new UNIX username:
</code></pre></div></p>
<p><h6> 2.4 Enter your new username and password at the prompts, and you will eventually see something like:</h6>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>Welcome to Ubuntu 22.04.1 LTS (GNU/Linux 5.10.102.1-microsoft-standard-WSL2 x86_64)
</code></pre></div></p>
<p><h6> 2.5 Click on the Windows "Start" icon and type in the name of your distribution into the search box.
Your new linux distribution should appear as a local "App". You can pin it to the Windows task bar or to Start for your future convenience.</h6>
Start a VM using your distribution by clicking on the App.</p>
<p><h6> 3. Install pre-requisites into your new VM</h6>
<h6> 3.1 update and apply apt-get packages</h6>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>sudo apt-get update
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>sudo apt-get upgrade
</code></pre></div></p>
<p><h6> 3.2 Install golang</h6>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>wget https://golang.org/dl/go1.19.linux-amd64.tar.gz
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>sudo tar -zxvf go1.19.linux-amd64.tar.gz -C /usr/local
<a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>echo export GOROOT=/usr/local/go | sudo tee -a /etc/profile
<a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a>echo export PATH=&quot;$PATH:/usr/local/go/bin&quot; | sudo tee -a /etc/profile
<a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a>source /etc/profile
<a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a>go version
</code></pre></div></p>
<p><h6> 3.3 Install ko (but don't do ko set action step)</h6>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>go install github.com/google/ko@latest
</code></pre></div></p>
<p><h6> 3.4 Install gcc</h6>
Either run this:
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>sudo apt install build-essential
</code></pre></div>
or this:
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>sudo apt-get update
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>apt install gcc
<a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a>gcc --version
</code></pre></div></p>
<p><h6> 3.5 Install make (if you installed build-essential this may already be installed)</h6>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>apt install make
</code></pre></div></p>
<p><h6> 3.6 Install jq</h6>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a>DEBIAN_FRONTEND=noninteractive apt-get install -y jq
<a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a>jq --version
</code></pre></div></p>
<p><h6> 3.7 install kubectl</h6>
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>curl -LO &quot;https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl&quot;
<a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a>curl -LO &quot;https://dl.k8s.io/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl.sha256&quot;
<a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a>echo &quot;$(cat kubectl.sha256)  kubectl&quot; | sha256sum --check
<a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a>sudo install -o root -g root -m 0755 kubectl /usr/local/bin/kubectl
</code></pre></div>
<h6> 3.8 install helm (required when deploying as workload)</h6>
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a>curl -fsSL -o get_helm.sh https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3
<a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a>chmod 700 get_helm.sh
<a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a>./get_helm.sh
</code></pre></div></p>
</div>
</div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Required Packages for the example usage:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:7"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><input id="__tabbed_2_3" name="__tabbed_2" type="radio" /><input id="__tabbed_2_4" name="__tabbed_2" type="radio" /><input id="__tabbed_2_5" name="__tabbed_2" type="radio" /><input id="__tabbed_2_6" name="__tabbed_2" type="radio" /><input id="__tabbed_2_7" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">General</label><label for="__tabbed_2_2">Mac</label><label for="__tabbed_2_3">Ubuntu</label><label for="__tabbed_2_4">Debian</label><label for="__tabbed_2_5">Fedora/RHEL/CentOS</label><label for="__tabbed_2_6">Windows</label><label for="__tabbed_2_7">WSL with Ubuntu</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>You will need the following tools for the example usage of KubeStellar in this quickstart example.
Select the tab for your environment for suggested commands to install them</p>
<ul>
<li>
<p><a href="https://docs.docker.com/engine/install/"><strong>docker</strong></a> or <a href="https://podman.io/"><strong>podman</strong></a>, to support <code>kind</code></p>
</li>
<li>
<p><a href="https://kind.sigs.k8s.io/docs/user/quick-start/"><strong>kind</strong></a></p>
</li>
</ul>
</div>
<div class="tabbed-block">
<p><div class="highlight"><span class="filename">docker - https://docs.docker.com/engine/install/</span><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a>brew install docker
<a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a>open -a Docker
</code></pre></div>
<div class="highlight"><span class="filename">kind - https://kind.sigs.k8s.io/docs/user/quick-start/</span><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a>brew install kind
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p><div class="highlight"><span class="filename">docker - https://docs.docker.com/engine/install/</span><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a>sudo mkdir -p /etc/apt/keyrings
<a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a>curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
<a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a>echo &quot;deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable&quot; | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null
<a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a>sudo apt update
<a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a>sudo apt-get install -y docker-ce docker-ce-cli containerd.io docker-compose-plugin
</code></pre></div>
<div class="highlight"><span class="filename">Enable rootless usage of Docker (requires relogin) - https://docs.docker.com/engine/security/rootless/</span><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a>sudo apt-get install -y dbus-user-session # *** Relogin after this
<a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a>sudo apt-get install -y uidmap
<a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a>dockerd-rootless-setuptool.sh install
<a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a>systemctl --user restart docker.service
</code></pre></div>
<div class="highlight"><span class="filename">kind - https://kind.sigs.k8s.io/docs/user/quick-start/</span><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a>curl -Lo ./kind https://kind.sigs.k8s.io/dl/v0.20.0/kind-linux-$(dpkg --print-architecture) &amp;&amp; chmod +x ./kind &amp;&amp; sudo mv ./kind /usr/local/bin
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p><div class="highlight"><span class="filename">docker - https://docs.docker.com/engine/install/</span><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a># Add Docker&#39;s official GPG key:
<a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a>sudo apt-get update
<a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a>sudo apt-get install ca-certificates curl gnupg
<a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a>sudo install -m 0755 -d /etc/apt/keyrings
<a id="__codelineno-46-5" name="__codelineno-46-5" href="#__codelineno-46-5"></a>curl -fsSL https://download.docker.com/linux/debian/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
<a id="__codelineno-46-6" name="__codelineno-46-6" href="#__codelineno-46-6"></a>sudo chmod a+r /etc/apt/keyrings/docker.gpg
<a id="__codelineno-46-7" name="__codelineno-46-7" href="#__codelineno-46-7"></a>
<a id="__codelineno-46-8" name="__codelineno-46-8" href="#__codelineno-46-8"></a># Add the repository to Apt sources:
<a id="__codelineno-46-9" name="__codelineno-46-9" href="#__codelineno-46-9"></a>echo \
<a id="__codelineno-46-10" name="__codelineno-46-10" href="#__codelineno-46-10"></a>  &quot;deb [arch=&quot;$(dpkg --print-architecture)&quot; signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/debian \
<a id="__codelineno-46-11" name="__codelineno-46-11" href="#__codelineno-46-11"></a>  &quot;$(. /etc/os-release &amp;&amp; echo &quot;$VERSION_CODENAME&quot;)&quot; stable&quot; | \
<a id="__codelineno-46-12" name="__codelineno-46-12" href="#__codelineno-46-12"></a>  sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null
<a id="__codelineno-46-13" name="__codelineno-46-13" href="#__codelineno-46-13"></a>sudo apt-get update
<a id="__codelineno-46-14" name="__codelineno-46-14" href="#__codelineno-46-14"></a>
<a id="__codelineno-46-15" name="__codelineno-46-15" href="#__codelineno-46-15"></a># Install packages
<a id="__codelineno-46-16" name="__codelineno-46-16" href="#__codelineno-46-16"></a>sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
</code></pre></div>
<div class="highlight"><span class="filename">Enable rootless usage of Docker (requires relogin) - https://docs.docker.com/engine/security/rootless/</span><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a>sudo apt-get install -y dbus-user-session # *** Relogin after this
<a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a>sudo apt-get install -y fuse-overlayfs
<a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a>sudo apt-get install -y slirp4netns
<a id="__codelineno-47-4" name="__codelineno-47-4" href="#__codelineno-47-4"></a>dockerd-rootless-setuptool.sh install
</code></pre></div>
<div class="highlight"><span class="filename">kind - https://kind.sigs.k8s.io/docs/user/quick-start/</span><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a>curl -Lo ./kind https://kind.sigs.k8s.io/dl/v0.14.0/kind-linux-$(dpkg --print-architecture) &amp;&amp; chmod +x ./kind &amp;&amp; sudo mv ./kind /usr/local/bin
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p><div class="highlight"><span class="filename">docker - https://docs.docker.com/engine/install/</span><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a>yum -y install epel-release &amp;&amp; yum -y install docker &amp;&amp; systemctl enable --now docker &amp;&amp; systemctl status docker
</code></pre></div>
Enable rootless usage of Docker by following the instructions at <a href="https://docs.docker.com/engine/security/rootless/">https://docs.docker.com/engine/security/rootless/</a>
<div class="highlight"><span class="filename">kind - https://kind.sigs.k8s.io/docs/user/quick-start/</span><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a># For AMD64 / x86_64
<a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a>[ $(uname -m) = x86_64 ] &amp;&amp; curl -Lo ./kind https://kind.sigs.k8s.io/dl/v0.14.0/kind-linux-amd64
<a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a># For ARM64
<a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a>[ $(uname -m) = aarch64 ] &amp;&amp; curl -Lo ./kind https://kind.sigs.k8s.io/dl/v0.14.0/kind-linux-arm64 
<a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a>chmod +x ./kind &amp;&amp; sudo mv ./kind /usr/local/bin/kind
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p><div class="highlight"><span class="filename">docker - https://docs.docker.com/engine/install/</span><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a>choco install docker -y
</code></pre></div>
<div class="highlight"><span class="filename">kind - https://kind.sigs.k8s.io/docs/user/quick-start/</span><pre><span></span><code><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a>curl.exe -Lo kind-windows-amd64.exe https://kind.sigs.k8s.io/dl/v0.14.0/kind-windows-amd64
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p><h3> How to install docker and kind into a Windows Subsystem for Linux (WSL) environment using an Ubuntu 22.04.01 distribution</h3></p>
<p><h6> 1.0 Start a VM terminal by clicking on the App you configured using the instructions in the General pre-requisites described above.</h6></p>
<p><h6> 2.0 Install docker</h6>
The installation instructions from docker are not sufficient to get docker working with WSL</p>
<p><h6> 2.1 Follow instructions here to install docker https://docs.docker.com/engine/install/ubuntu/</h6></p>
<p>Here some additional steps you will need to take:</p>
<p><h6> 2.2 Ensure that /etc/wsl.conf is configured so that systemd will run on booting.</h6>
If /etc/wsl.conf does not contain [boot] systemd=true, then edit /etc/wsl.com as follows:
<div class="highlight"><pre><span></span><code><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a>sudo vi /etc/wsl.conf
</code></pre></div>
Insert
<div class="highlight"><pre><span></span><code><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a>[boot]
<a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a>systemd=true
</code></pre></div></p>
<p><h6> 2.3 Edit /etc/sudoers: it is strongly recommended to not add directives directly to /etc/sudoers, but instead to put them in files in /etc/sudoers.d which are auto-included. So make/modify a new file via</h6>
<div class="highlight"><pre><span></span><code><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a>sudo vi /etc/sudoers.d/docker
</code></pre></div>
Insert
<div class="highlight"><pre><span></span><code><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a># Docker daemon specification
<a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a>&lt;your user account&gt; ALL=(ALL) NOPASSWD: /usr/bin/dockerd
</code></pre></div></p>
<p><h6> 2.4 Add your user to the docker group</h6>
<div class="highlight"><pre><span></span><code><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a>sudo usermod -aG docker $USER
</code></pre></div></p>
<p><h6> 2.5 If dockerd is already running, then stop it and restart it as follows (note: the new dockerd instance will be running in the foreground):</h6>
<div class="highlight"><pre><span></span><code><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a>sudo systemctl stop docker
<a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a>sudo dockerd &amp;
</code></pre></div></p>
<p><h6> 2.5.1 If you encounter an iptables issue, which is described here: https://github.com/microsoft/WSL/issues/6655 
The following commands will fix the issue:</h6>
<div class="highlight"><pre><span></span><code><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a>sudo update-alternatives --set iptables /usr/sbin/iptables-legacy
<a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a>sudo update-alternatives --set ip6tables /usr/sbin/ip6tables-legacy
<a id="__codelineno-59-3" name="__codelineno-59-3" href="#__codelineno-59-3"></a>sudo dockerd &amp; 
</code></pre></div></p>
<p><h6> 3. You will now need to open new terminals to access the VM since dockerd is running in the foreground of this terminal</h6></p>
<p><h6> 3.1 In your new terminal, install kind</h6>
<div class="highlight"><pre><span></span><code><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a>wget -nv https://github.com/kubernetes-sigs/kind/releases/download/v0.17.0/kind-linux-$(dpkg --print-architecture) -O kind 
<a id="__codelineno-60-2" name="__codelineno-60-2" href="#__codelineno-60-2"></a>sudo install -m 0755 kind /usr/local/bin/kind 
<a id="__codelineno-60-3" name="__codelineno-60-3" href="#__codelineno-60-3"></a>rm kind 
<a id="__codelineno-60-4" name="__codelineno-60-4" href="#__codelineno-60-4"></a>kind version
</code></pre></div></p>
</div>
</div>
</div>
</div>
<!-- END INCLUDE -->
<!-- BEGIN INCLUDE ../../common-subs/save-some-time.md '&lt;!--save-some-time-start--&gt;' '&lt;!--save-some-time-end--&gt;' -->

<div class="admonition tip">
<p class="admonition-title">This document is 'docs-ecutable' - you can 'run' this document, just like we do in our testing, on your local environment</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a>git clone -b main https://github.com/kubestellar/kubestellar
<a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a>cd kubestellar
<a id="__codelineno-61-3" name="__codelineno-61-3" href="#__codelineno-61-3"></a>make MANIFEST=&quot;&#39;docs/content/common-subs/pre-req.md&#39;,&#39;docs/content/Coding Milestones/PoC2023q1/example1.md&#39;&quot; docs-ecutable
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a># done? remove everything
<a id="__codelineno-62-2" name="__codelineno-62-2" href="#__codelineno-62-2"></a>make MANIFEST=&quot;docs/content/common-subs/remove-all.md&quot; docs-ecutable
<a id="__codelineno-62-3" name="__codelineno-62-3" href="#__codelineno-62-3"></a>cd ..
<a id="__codelineno-62-4" name="__codelineno-62-4" href="#__codelineno-62-4"></a>rm -rf kubestellar
</code></pre></div>
</div>
<!-- END INCLUDE -->

<p>This doc shows a detailed example usage of the KubeStellar components.</p>
<p>This example involves two edge clusters and two workloads.  One
workload goes on both edge clusters and one workload goes on only one
edge cluster.  Nothing changes after the initial activity.</p>
<p>This example is presented in stages.  The controllers involved are
always maintaining relationships.  This document focuses on changes as
they appear in this example.</p>
<h2 id="stage-1">Stage 1<a class="headerlink" href="#stage-1" title="Permanent link">#</a></h2>
<!-- BEGIN INCLUDE example1-subs/example1-pre-kcp.md '&lt;!--example1-pre-kcp-start--&gt;' '&lt;!--example1-pre-kcp-end--&gt;' -->

<p><img alt="Boxes and arrows. Two kind clusters exist, named florin and guilder. The Inventory Management workspace contains two pairs of SyncTarget and Location objects. The Edge Service Provider workspace contains the PoC controllers; the mailbox controller reads the SyncTarget objects and creates two mailbox workspaces." src="../Edge-PoC-2023q1-Scenario-1-stage-1.svg" title="Stage 1 Summary" /></p>
<p>Stage 1 creates the infrastructure and the edge service provider
workspace (ESPW) and lets that react to the inventory.  Then the KubeStellar syncers
are deployed, in the edge clusters and configured to work with the
corresponding mailbox workspaces.  This stage has the following steps.</p>
<h3 id="create-two-kind-clusters">Create two kind clusters.<a class="headerlink" href="#create-two-kind-clusters" title="Permanent link">#</a></h3>
<p>This example uses two <a href="https://kind.sigs.k8s.io/">kind</a> clusters as
edge clusters.  We will call them "florin" and "guilder".</p>
<p>This example uses extremely simple workloads, which
use <code>hostPort</code> networking in Kubernetes.  To make those ports easily
reachable from your host, this example uses an explicit <code>kind</code>
configuration for each edge cluster.</p>
<p>For the florin cluster, which will get only one workload, create a
file named <code>florin-config.yaml</code> with the following contents.  In a
<code>kind</code> config file, <code>containerPort</code> is about the container that is
also a host (a Kubernetes node), while the <code>hostPort</code> is about the
host that hosts that container.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a>cat<span class="w"> </span>&gt;<span class="w"> </span>florin-config.yaml<span class="w"> </span><span class="s">&lt;&lt; EOF</span>
<a id="__codelineno-63-2" name="__codelineno-63-2" href="#__codelineno-63-2"></a><span class="s">kind: Cluster</span>
<a id="__codelineno-63-3" name="__codelineno-63-3" href="#__codelineno-63-3"></a><span class="s">apiVersion: kind.x-k8s.io/v1alpha4</span>
<a id="__codelineno-63-4" name="__codelineno-63-4" href="#__codelineno-63-4"></a><span class="s">nodes:</span>
<a id="__codelineno-63-5" name="__codelineno-63-5" href="#__codelineno-63-5"></a><span class="s">- role: control-plane</span>
<a id="__codelineno-63-6" name="__codelineno-63-6" href="#__codelineno-63-6"></a><span class="s">  extraPortMappings:</span>
<a id="__codelineno-63-7" name="__codelineno-63-7" href="#__codelineno-63-7"></a><span class="s">  - containerPort: 8081</span>
<a id="__codelineno-63-8" name="__codelineno-63-8" href="#__codelineno-63-8"></a><span class="s">    hostPort: 8094</span>
<a id="__codelineno-63-9" name="__codelineno-63-9" href="#__codelineno-63-9"></a><span class="s">EOF</span>
</code></pre></div>
<p>For the guilder cluster, which will get two workloads, create a file
named <code>guilder-config.yaml</code> with the following contents.  The workload
that uses hostPort 8081 goes in both clusters, while the workload that
uses hostPort 8082 goes only in the guilder cluster.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a>cat<span class="w"> </span>&gt;<span class="w"> </span>guilder-config.yaml<span class="w"> </span><span class="s">&lt;&lt; EOF</span>
<a id="__codelineno-64-2" name="__codelineno-64-2" href="#__codelineno-64-2"></a><span class="s">kind: Cluster</span>
<a id="__codelineno-64-3" name="__codelineno-64-3" href="#__codelineno-64-3"></a><span class="s">apiVersion: kind.x-k8s.io/v1alpha4</span>
<a id="__codelineno-64-4" name="__codelineno-64-4" href="#__codelineno-64-4"></a><span class="s">nodes:</span>
<a id="__codelineno-64-5" name="__codelineno-64-5" href="#__codelineno-64-5"></a><span class="s">- role: control-plane</span>
<a id="__codelineno-64-6" name="__codelineno-64-6" href="#__codelineno-64-6"></a><span class="s">  extraPortMappings:</span>
<a id="__codelineno-64-7" name="__codelineno-64-7" href="#__codelineno-64-7"></a><span class="s">  - containerPort: 8081</span>
<a id="__codelineno-64-8" name="__codelineno-64-8" href="#__codelineno-64-8"></a><span class="s">    hostPort: 8096</span>
<a id="__codelineno-64-9" name="__codelineno-64-9" href="#__codelineno-64-9"></a><span class="s">  - containerPort: 8082</span>
<a id="__codelineno-64-10" name="__codelineno-64-10" href="#__codelineno-64-10"></a><span class="s">    hostPort: 8097</span>
<a id="__codelineno-64-11" name="__codelineno-64-11" href="#__codelineno-64-11"></a><span class="s">EOF</span>
</code></pre></div>
<p>Finally, create the two clusters with the following two commands,
paying attention to <code>$KUBECONFIG</code> and, if that's empty,
<code>~/.kube/config</code>: <code>kind create</code> will inject/replace the relevant
"context" in your active kubeconfig.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a>kind<span class="w"> </span>create<span class="w"> </span>cluster<span class="w"> </span>--name<span class="w"> </span>florin<span class="w"> </span>--config<span class="w"> </span>florin-config.yaml
<a id="__codelineno-65-2" name="__codelineno-65-2" href="#__codelineno-65-2"></a>kind<span class="w"> </span>create<span class="w"> </span>cluster<span class="w"> </span>--name<span class="w"> </span>guilder<span class="w"> </span>--config<span class="w"> </span>guilder-config.yaml
</code></pre></div>
<!-- END INCLUDE -->

<!-- BEGIN INCLUDE example1-subs/example1-space-manager.md '&lt;!--example1-space-manager-start--&gt;' '&lt;!--example1-space-manager-end--&gt;' -->

<h3 id="create-kind-cluster-for-space-management">Create Kind cluster for space management<a class="headerlink" href="#create-kind-cluster-for-space-management" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a>kind<span class="w"> </span>create<span class="w"> </span>cluster<span class="w"> </span>--name<span class="w"> </span>sm-mgt
<a id="__codelineno-66-2" name="__codelineno-66-2" href="#__codelineno-66-2"></a><span class="nv">KUBECONFIG</span><span class="o">=</span>~/.kube/config<span class="w"> </span>kubectl<span class="w"> </span>config<span class="w"> </span>rename-context<span class="w"> </span>kind-sm-mgt<span class="w"> </span>sm-mgt
<a id="__codelineno-66-3" name="__codelineno-66-3" href="#__codelineno-66-3"></a><span class="nb">export</span><span class="w"> </span><span class="nv">SM_CONFIG</span><span class="o">=</span>~/.kube/config
<a id="__codelineno-66-4" name="__codelineno-66-4" href="#__codelineno-66-4"></a><span class="nb">export</span><span class="w"> </span><span class="nv">SM_CONTEXT</span><span class="o">=</span>sm-mgt
</code></pre></div>
<h3 id="the-space-manager-controller">The space-manager controller<a class="headerlink" href="#the-space-manager-controller" title="Permanent link">#</a></h3>
<p>You can get the latest version from GitHub with the following command,
which will get you the default branch (which is named "main"); add <code>-b
$branch</code> to the <code>git</code> command in order to get a different branch.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/kubestellar/kubestellar
<a id="__codelineno-67-2" name="__codelineno-67-2" href="#__codelineno-67-2"></a><span class="nb">cd</span><span class="w"> </span>kubestellar
</code></pre></div>
<p>Use the following commands to build and add the executables to your
<code>$PATH</code>.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a><span class="nb">cd</span><span class="w"> </span>space-framework
<a id="__codelineno-68-2" name="__codelineno-68-2" href="#__codelineno-68-2"></a>make<span class="w"> </span>build
<a id="__codelineno-68-3" name="__codelineno-68-3" href="#__codelineno-68-3"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/bin:<span class="nv">$PATH</span>
</code></pre></div>
Next deploy the space framework CRDs in the space management cluster.
<div class="highlight"><pre><span></span><code><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a><span class="nv">KUBECONFIG</span><span class="o">=</span><span class="nv">$SM_CONFIG</span><span class="w"> </span>kubectl<span class="w"> </span>--context<span class="w"> </span>sm-mgt<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>config/crds/
<a id="__codelineno-69-2" name="__codelineno-69-2" href="#__codelineno-69-2"></a><span class="nb">cd</span><span class="w"> </span>..
</code></pre></div>
Finally, start the space-manager controller.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-70-1" name="__codelineno-70-1" href="#__codelineno-70-1"></a>space-manager<span class="w"> </span>--kubeconfig<span class="w"> </span><span class="nv">$SM_CONFIG</span><span class="w"> </span>--context<span class="w"> </span>sm-mgt<span class="w"> </span>-v<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="p">&amp;</span>
</code></pre></div>
<!-- END INCLUDE -->

<!-- BEGIN INCLUDE example1-subs/example1-start-kcp.md '&lt;!--example1-start-kcp-start--&gt;' '&lt;!--example1-start-kcp-end--&gt;' -->

<h3 id="deploy-kcp-and-kubestellar">Deploy kcp and KubeStellar<a class="headerlink" href="#deploy-kcp-and-kubestellar" title="Permanent link">#</a></h3>
<p>You need kcp and KubeStellar and can deploy them in either of two
ways: as bare processes on whatever host you are using to run this
example, or as workload in a Kubernetes cluster (an OpenShift cluster
qualifies).  Do one or the other, not both.</p>
<p>KubeStellar only works with release <code>v0.11.0</code> of kcp.</p>
<h3 id="deploy-kcp-and-kubestellar-as-bare-processes">Deploy kcp and KubeStellar as bare processes<a class="headerlink" href="#deploy-kcp-and-kubestellar-as-bare-processes" title="Permanent link">#</a></h3>
<h4 id="start-kcp">Start kcp<a class="headerlink" href="#start-kcp" title="Permanent link">#</a></h4>
<p>Download and build or install <a href="https://github.com/kcp-dev/kcp/releases/tag/v0.11.0">kcp</a>,
according to your preference.  See the start of <a href="https://docs.kcp.io/kcp/v0.11/#quickstart">the kcp quickstart</a> for instructions on that, but get <a href="https://github.com/kcp-dev/kcp/releases/tag/v0.11.0">release v0.11.0</a> rather than the latest (the downloadable assets appear after the long list of changes/features/etc).</p>
<p>Clone the v0.11.0 branch of the kcp source:
<div class="highlight"><pre><span></span><code><a id="__codelineno-71-1" name="__codelineno-71-1" href="#__codelineno-71-1"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>v0.11.0<span class="w"> </span>https://github.com/kcp-dev/kcp<span class="w"> </span>kcp
</code></pre></div>
and build the kubectl-ws binary and include it in <code>$PATH</code>
<div class="highlight"><pre><span></span><code><a id="__codelineno-72-1" name="__codelineno-72-1" href="#__codelineno-72-1"></a><span class="nb">pushd</span><span class="w"> </span>kcp
<a id="__codelineno-72-2" name="__codelineno-72-2" href="#__codelineno-72-2"></a>make<span class="w"> </span>build
<a id="__codelineno-72-3" name="__codelineno-72-3" href="#__codelineno-72-3"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/bin:<span class="nv">$PATH</span>
</code></pre></div></p>
<p>Running the kcp server creates a hidden subdirectory named <code>.kcp</code> to
hold all sorts of state related to the server. If you have run it
before and want to start over from scratch then you should <code>rm -rf
.kcp</code> first.</p>
<p>Use the following commands to: (a) run the kcp server in a forked
command, (b) update your <code>KUBECONFIG</code> environment variable to
configure <code>kubectl</code> to use the kubeconfig produced by the kcp server,
and (c) wait for the kcp server to get through some
initialization. The choice of <code>-v=3</code> for the kcp server makes it log a
line for every HTTP request (among other things).</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-73-1" name="__codelineno-73-1" href="#__codelineno-73-1"></a>kcp<span class="w"> </span>start<span class="w"> </span>-v<span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">&amp;</span>&gt;<span class="w"> </span>/tmp/kcp.log<span class="w"> </span><span class="p">&amp;</span>
<a id="__codelineno-73-2" name="__codelineno-73-2" href="#__codelineno-73-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">KUBECONFIG</span><span class="o">=</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/.kcp/admin.kubeconfig
<a id="__codelineno-73-3" name="__codelineno-73-3" href="#__codelineno-73-3"></a><span class="nb">popd</span>
<a id="__codelineno-73-4" name="__codelineno-73-4" href="#__codelineno-73-4"></a><span class="c1"># wait until KCP is ready checking availability of ws resource</span>
<a id="__codelineno-73-5" name="__codelineno-73-5" href="#__codelineno-73-5"></a><span class="k">while</span><span class="w"> </span>!<span class="w"> </span>kubectl<span class="w"> </span>ws<span class="w"> </span>tree<span class="w"> </span><span class="p">&amp;</span>&gt;<span class="w"> </span>/dev/null<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<a id="__codelineno-73-6" name="__codelineno-73-6" href="#__codelineno-73-6"></a><span class="w">  </span>sleep<span class="w"> </span><span class="m">10</span>
<a id="__codelineno-73-7" name="__codelineno-73-7" href="#__codelineno-73-7"></a><span class="k">done</span>
</code></pre></div>
<p>Note that you now care about two different kubeconfig files: the one
that you were using earlier, which holds the contexts for your <code>kind</code>
clusters, and the one that the kcp server creates. The remainder of
this document assumes that your <code>kind</code> cluster contexts are in
<code>~/.kube/config</code>.</p>
<!-- END INCLUDE -->

<!-- BEGIN INCLUDE example1-subs/example1-kcp-provider.md '&lt;!--example1-kcp-provider-start--&gt;' '&lt;!--example1-kcp-provider-end--&gt;' -->

<h4 id="create-a-space-provider-description-for-kcp">Create a space provider description for KCP<a class="headerlink" href="#create-a-space-provider-description-for-kcp" title="Permanent link">#</a></h4>
<p>Space provider for KCP will allow you to use KCP as backend provider for spaces.
Use the following commands to create a provider secret for KCP access and
a space provider definition.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-74-1" name="__codelineno-74-1" href="#__codelineno-74-1"></a><span class="nv">KUBECONFIG</span><span class="o">=</span><span class="nv">$SM_CONFIG</span><span class="w"> </span>kubectl<span class="w"> </span>--context<span class="w"> </span>sm-mgt<span class="w"> </span>create<span class="w"> </span>secret<span class="w"> </span>generic<span class="w"> </span>kcpsec<span class="w"> </span>--from-file<span class="o">=</span><span class="nv">kubeconfig</span><span class="o">=</span><span class="nv">$KUBECONFIG</span><span class="w"> </span>--from-file<span class="o">=</span><span class="nv">incluster</span><span class="o">=</span><span class="nv">$KUBECONFIG</span>
<a id="__codelineno-74-2" name="__codelineno-74-2" href="#__codelineno-74-2"></a><span class="nv">KUBECONFIG</span><span class="o">=</span><span class="nv">$SM_CONFIG</span><span class="w"> </span>kubectl<span class="w"> </span>--context<span class="w"> </span>sm-mgt<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>-<span class="w"> </span><span class="s">&lt;&lt;EOF</span>
<a id="__codelineno-74-3" name="__codelineno-74-3" href="#__codelineno-74-3"></a><span class="s">apiVersion: space.kubestellar.io/v1alpha1</span>
<a id="__codelineno-74-4" name="__codelineno-74-4" href="#__codelineno-74-4"></a><span class="s">kind: SpaceProviderDesc</span>
<a id="__codelineno-74-5" name="__codelineno-74-5" href="#__codelineno-74-5"></a><span class="s">metadata:</span>
<a id="__codelineno-74-6" name="__codelineno-74-6" href="#__codelineno-74-6"></a><span class="s">  name: default</span>
<a id="__codelineno-74-7" name="__codelineno-74-7" href="#__codelineno-74-7"></a><span class="s">spec:</span>
<a id="__codelineno-74-8" name="__codelineno-74-8" href="#__codelineno-74-8"></a><span class="s">  ProviderType: &quot;kcp&quot;</span>
<a id="__codelineno-74-9" name="__codelineno-74-9" href="#__codelineno-74-9"></a><span class="s">  SpacePrefixForDiscovery: &quot;ks-&quot;</span>
<a id="__codelineno-74-10" name="__codelineno-74-10" href="#__codelineno-74-10"></a><span class="s">  secretRef:</span>
<a id="__codelineno-74-11" name="__codelineno-74-11" href="#__codelineno-74-11"></a><span class="s">    namespace: default</span>
<a id="__codelineno-74-12" name="__codelineno-74-12" href="#__codelineno-74-12"></a><span class="s">    name: kcpsec</span>
<a id="__codelineno-74-13" name="__codelineno-74-13" href="#__codelineno-74-13"></a><span class="s">EOF</span>
</code></pre></div>
<p>Next, use the following command to wait for the space-manger to process the provider.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-75-1" name="__codelineno-75-1" href="#__codelineno-75-1"></a><span class="nv">KUBECONFIG</span><span class="o">=</span><span class="nv">$SM_CONFIG</span><span class="w"> </span>kubectl<span class="w"> </span>--context<span class="w"> </span>sm-mgt<span class="w"> </span><span class="nb">wait</span><span class="w"> </span>--for<span class="o">=</span><span class="nv">jsonpath</span><span class="o">=</span><span class="s1">&#39;{.status.Phase}&#39;</span><span class="o">=</span>Ready<span class="w"> </span>spaceproviderdesc/default<span class="w"> </span>--timeout<span class="o">=</span>90s
</code></pre></div>
<!-- END INCLUDE -->

<!-- BEGIN INCLUDE example1-subs/example1-post-kcp.md '&lt;!--example1-post-kcp-start--&gt;' '&lt;!--example1-post-kcp-end--&gt;' -->

<h4 id="get-kubestellar">Get KubeStellar<a class="headerlink" href="#get-kubestellar" title="Permanent link">#</a></h4>
<p>You will need a local copy of KubeStellar.  You can either use the
pre-built archive (containing executables and config files) from a
release or get any desired version from GitHub and build.</p>
<h5 id="use-pre-built-archive">Use pre-built archive<a class="headerlink" href="#use-pre-built-archive" title="Permanent link">#</a></h5>
<p>Fetch the archive for your operating system and instruction set
architecture as follows, in which <code>$kubestellar_version</code> is your
chosen release of KubeStellar (see <a href="https://github.com/kubestellar/kubestellar/releases">the releases on
GitHub</a>) and
<code>$os_type</code> and <code>$arch_type</code> are chosen according to the list of
"assets" for your chosen release.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-76-1" name="__codelineno-76-1" href="#__codelineno-76-1"></a>curl<span class="w"> </span>-SL<span class="w"> </span>-o<span class="w"> </span>kubestellar.tar.gz<span class="w"> </span><span class="s2">&quot;https://github.com/kubestellar/kubestellar/releases/download/</span><span class="si">${</span><span class="nv">kubestellar_version</span><span class="si">}</span><span class="s2">/kubestellar_</span><span class="si">${</span><span class="nv">kubestellar_version</span><span class="si">}</span><span class="s2">_</span><span class="si">${</span><span class="nv">os_type</span><span class="si">}</span><span class="s2">_</span><span class="si">${</span><span class="nv">arch_type</span><span class="si">}</span><span class="s2">.tar.gz</span>
<a id="__codelineno-76-2" name="__codelineno-76-2" href="#__codelineno-76-2"></a><span class="s2">tar xzf kubestellar.tar.gz</span>
<a id="__codelineno-76-3" name="__codelineno-76-3" href="#__codelineno-76-3"></a><span class="s2">export PATH=</span><span class="nv">$PWD</span><span class="s2">/bin:</span><span class="nv">$PATH</span>
</code></pre></div>
<h5 id="get-from-github">Get from GitHub<a class="headerlink" href="#get-from-github" title="Permanent link">#</a></h5>
<p>You can get the latest version from GitHub with the following command,
which will get you the default branch (which is named "main"); add <code>-b
$branch</code> to the <code>git</code> command in order to get a different branch.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-77-1" name="__codelineno-77-1" href="#__codelineno-77-1"></a>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/kubestellar/kubestellar
<a id="__codelineno-77-2" name="__codelineno-77-2" href="#__codelineno-77-2"></a><span class="nb">cd</span><span class="w"> </span>kubestellar
</code></pre></div>
<p>Use the following commands to build and add the executables to your
<code>$PATH</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-78-1" name="__codelineno-78-1" href="#__codelineno-78-1"></a>make<span class="w"> </span>build
<a id="__codelineno-78-2" name="__codelineno-78-2" href="#__codelineno-78-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/bin:<span class="nv">$PATH</span>
</code></pre></div>
<p>In the following exhibited command lines, the commands described as
"KubeStellar commands" and the commands that start with <code>kubectl
kubestellar</code> rely on the KubeStellar <code>bin</code> directory being on the
<code>$PATH</code>.  Alternatively you could invoke them with explicit pathnames.
The kubectl plugin lines use fully specific executables (e.g.,
<code>kubectl kubestellar prep-for-syncer</code> corresponds to
<code>bin/kubectl-kubestellar-prep_for_syncer</code>).</p>
<h4 id="get-binaries-of-kube-bind-and-dex">Get binaries of kube-bind and dex<a class="headerlink" href="#get-binaries-of-kube-bind-and-dex" title="Permanent link">#</a></h4>
<p>The command below makes kube-bind binaries and dex binary available in <code>$PATH</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-79-1" name="__codelineno-79-1" href="#__codelineno-79-1"></a>rm<span class="w"> </span>-rf<span class="w"> </span>kube-bind
<a id="__codelineno-79-2" name="__codelineno-79-2" href="#__codelineno-79-2"></a>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/waltforme/kube-bind.git<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-79-3" name="__codelineno-79-3" href="#__codelineno-79-3"></a><span class="nb">pushd</span><span class="w"> </span>kube-bind<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-79-4" name="__codelineno-79-4" href="#__codelineno-79-4"></a>mkdir<span class="w"> </span>bin<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-79-5" name="__codelineno-79-5" href="#__codelineno-79-5"></a><span class="nv">IGNORE_GO_VERSION</span><span class="o">=</span><span class="m">1</span><span class="w"> </span>go<span class="w"> </span>build<span class="w"> </span>-o<span class="w"> </span>./bin/example-backend<span class="w"> </span>./cmd/example-backend/main.go<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-79-6" name="__codelineno-79-6" href="#__codelineno-79-6"></a>git<span class="w"> </span>checkout<span class="w"> </span>origin/syncmore<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-79-7" name="__codelineno-79-7" href="#__codelineno-79-7"></a><span class="nv">IGNORE_GO_VERSION</span><span class="o">=</span><span class="m">1</span><span class="w"> </span>go<span class="w"> </span>build<span class="w"> </span>-o<span class="w"> </span>./bin/konnector<span class="w"> </span>./cmd/konnector/main.go<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-79-8" name="__codelineno-79-8" href="#__codelineno-79-8"></a>git<span class="w"> </span>checkout<span class="w"> </span>origin/autobind<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-79-9" name="__codelineno-79-9" href="#__codelineno-79-9"></a><span class="nv">IGNORE_GO_VERSION</span><span class="o">=</span><span class="m">1</span><span class="w"> </span>go<span class="w"> </span>build<span class="w"> </span>-o<span class="w"> </span>./bin/kubectl-bind<span class="w"> </span>./cmd/kubectl-bind/main.go<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-79-10" name="__codelineno-79-10" href="#__codelineno-79-10"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/bin:<span class="nv">$PATH</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-79-11" name="__codelineno-79-11" href="#__codelineno-79-11"></a><span class="nb">popd</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-79-12" name="__codelineno-79-12" href="#__codelineno-79-12"></a>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/dexidp/dex.git<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-79-13" name="__codelineno-79-13" href="#__codelineno-79-13"></a><span class="nb">pushd</span><span class="w"> </span>dex<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-79-14" name="__codelineno-79-14" href="#__codelineno-79-14"></a><span class="nv">IGNORE_GO_VERSION</span><span class="o">=</span><span class="m">1</span><span class="w"> </span>make<span class="w"> </span>build<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-79-15" name="__codelineno-79-15" href="#__codelineno-79-15"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/bin:<span class="nv">$PATH</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-79-16" name="__codelineno-79-16" href="#__codelineno-79-16"></a><span class="nb">popd</span>
</code></pre></div>
<h4 id="initialize-the-kubestellar-platform-as-bare-processes">Initialize the KubeStellar platform as bare processes<a class="headerlink" href="#initialize-the-kubestellar-platform-as-bare-processes" title="Permanent link">#</a></h4>
<p>In this step KubeStellar creates and populates the Edge Service
Provider Workspace (ESPW), which exports the KubeStellar API.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-80-1" name="__codelineno-80-1" href="#__codelineno-80-1"></a><span class="nv">IN_CLUSTER</span><span class="o">=</span><span class="nb">false</span><span class="w"> </span><span class="nv">SPACE_MANAGER_KUBECONFIG</span><span class="o">=</span><span class="nv">$SM_CONFIG</span><span class="w"> </span>kubestellar<span class="w"> </span>init
</code></pre></div>
<h3 id="deploy-kcp-and-kubestellar-as-a-workload-in-a-kubernetes-cluster">Deploy kcp and KubeStellar as a workload in a Kubernetes cluster<a class="headerlink" href="#deploy-kcp-and-kubestellar-as-a-workload-in-a-kubernetes-cluster" title="Permanent link">#</a></h3>
<p>(This style of deployment requires release v0.6 or later of KubeStellar.)</p>
<p>You need a Kubernetes cluster; see <a href="../commands/#deployment-into-a-kubernetes-cluster">the documentation for <code>kubectl kubestellar deploy</code></a> for more information.</p>
<p>You will need a domain name that, on each of your clients, resolves to
an IP address that the client can use to open a TCP connection to the
Ingress controller's listening socket.</p>
<p>You will need the kcp <code>kubectl</code> plugins.  See <a href="./#start-kcp">the "Start kcp" section
above</a> for instructions on how to get all of the kcp
executables.</p>
<p>You will need to get a build of KubeStellar.  See
<a href="./#get-kubestellar">above</a>.</p>
<p>To do the deployment and prepare to use it you will be using <a href="../commands/#deployment-into-a-kubernetes-cluster">the
commands defined for
that</a>.  These
require your shell to be in a state where <code>kubectl</code> manipulates the
hosting cluster (the Kubernetes cluster into which you want to deploy
kcp and KubeStellar), either by virtue of having set your <code>KUBECONFIG</code>
envar appropriately or putting the relevant contents in
<code>~/.kube/config</code> or by passing <code>--kubeconfig</code> explicitly on the
following command lines.</p>
<p>Use the <a href="../commands/#deploy-to-cluster">kubectl kubestellar deploy
command</a> to do the deployment.</p>
<p>Then use the <a href="../commands/#fetch-kubeconfig-for-external-clients">kubectl kubestellar get-external-kubeconfig
command</a> to put
into a file the kubeconfig that you will use as a user of kcp and
KubeStellar.  Do not overwrite the kubeconfig file for your hosting
cluster.  But <em>do</em> update your <code>KUBECONFIG</code> envar setting or remember
to pass the new file with <code>--kubeconfig</code> on the command lines when
using kcp or KubeStellar. For example, you might use the following
commands to fetch and start using that kubeconfig file; the first
assumes that you deployed the core into a Kubernetes namespace named
"kubestellar".</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-81-1" name="__codelineno-81-1" href="#__codelineno-81-1"></a>kubectl<span class="w"> </span>kubestellar<span class="w"> </span>get-external-kubeconfig<span class="w"> </span>-n<span class="w"> </span>kubestellar<span class="w"> </span>-o<span class="w"> </span>kcs.kubeconfig
<a id="__codelineno-81-2" name="__codelineno-81-2" href="#__codelineno-81-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">KUBECONFIG</span><span class="o">=</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/kcs.kubeconfig
</code></pre></div>
<p>Note that you now care about two different kubeconfig files: the one
that you were using earlier, which holds the contexts for your <code>kind</code>
clusters, and the one that you just fetched and started using for
working with the KubeStellar interface. The remainder of this document
assumes that your <code>kind</code> cluster contexts are in <code>~/.kube/config</code>.</p>
<h3 id="create-synctarget-and-location-objects-to-represent-the-florin-and-guilder-clusters">Create SyncTarget and Location objects to represent the florin and guilder clusters<a class="headerlink" href="#create-synctarget-and-location-objects-to-represent-the-florin-and-guilder-clusters" title="Permanent link">#</a></h3>
<p>Use the following two commands to put inventory objects in the IMW at
<code>root:imw1</code> that was automatically created during deployment of
KubeStellar. They label both florin and guilder with <code>env=prod</code>, and
also label guilder with <code>extended=yes</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-82-1" name="__codelineno-82-1" href="#__codelineno-82-1"></a><span class="nv">imw1_space_config</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span><span class="s2">/temp-space-config/spaceprovider-default-imw1&quot;</span>
<a id="__codelineno-82-2" name="__codelineno-82-2" href="#__codelineno-82-2"></a>kubectl-kubestellar-get-config-for-space<span class="w"> </span>--space-name<span class="w"> </span>imw1<span class="w"> </span>--provider-name<span class="w"> </span>default<span class="w"> </span>--sm-core-config<span class="w"> </span><span class="nv">$SM_CONFIG</span><span class="w"> </span>--space-config-file<span class="w"> </span><span class="nv">$imw1_space_config</span>
<a id="__codelineno-82-3" name="__codelineno-82-3" href="#__codelineno-82-3"></a><span class="nv">KUBECONFIG</span><span class="o">=</span><span class="nv">$imw1_space_config</span><span class="w"> </span>kubectl<span class="w"> </span>kubestellar<span class="w"> </span>ensure<span class="w"> </span>location<span class="w"> </span>florin<span class="w">  </span>loc-name<span class="o">=</span>florin<span class="w">  </span><span class="nv">env</span><span class="o">=</span>prod<span class="w"> </span>--imw<span class="w"> </span>imw1
<a id="__codelineno-82-4" name="__codelineno-82-4" href="#__codelineno-82-4"></a><span class="nv">KUBECONFIG</span><span class="o">=</span><span class="nv">$imw1_space_config</span><span class="w"> </span>kubectl<span class="w"> </span>kubestellar<span class="w"> </span>ensure<span class="w"> </span>location<span class="w"> </span>guilder<span class="w"> </span>loc-name<span class="o">=</span>guilder<span class="w"> </span><span class="nv">env</span><span class="o">=</span>prod<span class="w"> </span><span class="nv">extended</span><span class="o">=</span>yes<span class="w"> </span>--imw<span class="w"> </span>imw1
<a id="__codelineno-82-5" name="__codelineno-82-5" href="#__codelineno-82-5"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;describe the florin location object&quot;</span>
<a id="__codelineno-82-6" name="__codelineno-82-6" href="#__codelineno-82-6"></a><span class="nv">KUBECONFIG</span><span class="o">=</span><span class="nv">$imw1_space_config</span><span class="w"> </span>kubectl<span class="w"> </span>describe<span class="w"> </span>location.edge.kubestellar.io<span class="w"> </span>florin
</code></pre></div>
<p>Those two script invocations are equivalent to creating the following
four objects plus the kcp <code>APIBinding</code> objects that import the
definition of the KubeStellar API.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-83-1" name="__codelineno-83-1" href="#__codelineno-83-1"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">edge.kubestellar.io/v2alpha1</span>
<a id="__codelineno-83-2" name="__codelineno-83-2" href="#__codelineno-83-2"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SyncTarget</span>
<a id="__codelineno-83-3" name="__codelineno-83-3" href="#__codelineno-83-3"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-83-4" name="__codelineno-83-4" href="#__codelineno-83-4"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">florin</span>
<a id="__codelineno-83-5" name="__codelineno-83-5" href="#__codelineno-83-5"></a><span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-83-6" name="__codelineno-83-6" href="#__codelineno-83-6"></a><span class="w">    </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">florin</span>
<a id="__codelineno-83-7" name="__codelineno-83-7" href="#__codelineno-83-7"></a><span class="w">    </span><span class="nt">loc-name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">florin</span>
<a id="__codelineno-83-8" name="__codelineno-83-8" href="#__codelineno-83-8"></a><span class="w">    </span><span class="nt">env</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prod</span>
<a id="__codelineno-83-9" name="__codelineno-83-9" href="#__codelineno-83-9"></a><span class="nn">---</span>
<a id="__codelineno-83-10" name="__codelineno-83-10" href="#__codelineno-83-10"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">edge.kubestellar.io/v2alpha1</span>
<a id="__codelineno-83-11" name="__codelineno-83-11" href="#__codelineno-83-11"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Location</span>
<a id="__codelineno-83-12" name="__codelineno-83-12" href="#__codelineno-83-12"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-83-13" name="__codelineno-83-13" href="#__codelineno-83-13"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">florin</span>
<a id="__codelineno-83-14" name="__codelineno-83-14" href="#__codelineno-83-14"></a><span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-83-15" name="__codelineno-83-15" href="#__codelineno-83-15"></a><span class="w">    </span><span class="nt">loc-name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">florin</span>
<a id="__codelineno-83-16" name="__codelineno-83-16" href="#__codelineno-83-16"></a><span class="w">    </span><span class="nt">env</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prod</span>
<a id="__codelineno-83-17" name="__codelineno-83-17" href="#__codelineno-83-17"></a><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-83-18" name="__codelineno-83-18" href="#__codelineno-83-18"></a><span class="w">  </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="nv">edge.kubestellar.io</span><span class="p p-Indicator">,</span><span class="nt"> version</span><span class="p">:</span><span class="w"> </span><span class="nv">v2alpha1</span><span class="p p-Indicator">,</span><span class="nt"> resource</span><span class="p">:</span><span class="w"> </span><span class="nv">synctargets</span><span class="p p-Indicator">}</span>
<a id="__codelineno-83-19" name="__codelineno-83-19" href="#__codelineno-83-19"></a><span class="w">  </span><span class="nt">instanceSelector</span><span class="p">:</span>
<a id="__codelineno-83-20" name="__codelineno-83-20" href="#__codelineno-83-20"></a><span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="nv">florin</span><span class="p p-Indicator">}</span>
<a id="__codelineno-83-21" name="__codelineno-83-21" href="#__codelineno-83-21"></a><span class="nn">---</span>
<a id="__codelineno-83-22" name="__codelineno-83-22" href="#__codelineno-83-22"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">edge.kubestellar.io/v2alpha1</span>
<a id="__codelineno-83-23" name="__codelineno-83-23" href="#__codelineno-83-23"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SyncTarget</span>
<a id="__codelineno-83-24" name="__codelineno-83-24" href="#__codelineno-83-24"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-83-25" name="__codelineno-83-25" href="#__codelineno-83-25"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">guilder</span>
<a id="__codelineno-83-26" name="__codelineno-83-26" href="#__codelineno-83-26"></a><span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-83-27" name="__codelineno-83-27" href="#__codelineno-83-27"></a><span class="w">    </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">guilder</span>
<a id="__codelineno-83-28" name="__codelineno-83-28" href="#__codelineno-83-28"></a><span class="w">    </span><span class="nt">loc-name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">guilder</span>
<a id="__codelineno-83-29" name="__codelineno-83-29" href="#__codelineno-83-29"></a><span class="w">    </span><span class="nt">env</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prod</span>
<a id="__codelineno-83-30" name="__codelineno-83-30" href="#__codelineno-83-30"></a><span class="w">    </span><span class="nt">extended</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
<a id="__codelineno-83-31" name="__codelineno-83-31" href="#__codelineno-83-31"></a><span class="nn">---</span>
<a id="__codelineno-83-32" name="__codelineno-83-32" href="#__codelineno-83-32"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">edge.kubestellar.io/v2alpha1</span>
<a id="__codelineno-83-33" name="__codelineno-83-33" href="#__codelineno-83-33"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Location</span>
<a id="__codelineno-83-34" name="__codelineno-83-34" href="#__codelineno-83-34"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-83-35" name="__codelineno-83-35" href="#__codelineno-83-35"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">guilder</span>
<a id="__codelineno-83-36" name="__codelineno-83-36" href="#__codelineno-83-36"></a><span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-83-37" name="__codelineno-83-37" href="#__codelineno-83-37"></a><span class="w">    </span><span class="nt">loc-name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">guilder</span>
<a id="__codelineno-83-38" name="__codelineno-83-38" href="#__codelineno-83-38"></a><span class="w">    </span><span class="nt">env</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prod</span>
<a id="__codelineno-83-39" name="__codelineno-83-39" href="#__codelineno-83-39"></a><span class="w">    </span><span class="nt">extended</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
<a id="__codelineno-83-40" name="__codelineno-83-40" href="#__codelineno-83-40"></a><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-83-41" name="__codelineno-83-41" href="#__codelineno-83-41"></a><span class="w">  </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="nv">edge.kubestellar.io</span><span class="p p-Indicator">,</span><span class="nt"> version</span><span class="p">:</span><span class="w"> </span><span class="nv">v2alpha1</span><span class="p p-Indicator">,</span><span class="nt"> resource</span><span class="p">:</span><span class="w"> </span><span class="nv">synctargets</span><span class="p p-Indicator">}</span>
<a id="__codelineno-83-42" name="__codelineno-83-42" href="#__codelineno-83-42"></a><span class="w">  </span><span class="nt">instanceSelector</span><span class="p">:</span>
<a id="__codelineno-83-43" name="__codelineno-83-43" href="#__codelineno-83-43"></a><span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="nv">guilder</span><span class="p p-Indicator">}</span>
</code></pre></div>
<p>That script also deletes the Location named <code>default</code>, which is not
used in this PoC, if it shows up.</p>
<!-- END INCLUDE -->

<!-- BEGIN INCLUDE example1-subs/example1-post-espw.md '&lt;!--example1-post-espw-start--&gt;' '&lt;!--example1-post-espw-end--&gt;' -->

<!-- BEGIN INCLUDE ./example1-stage-1a.md '&lt;!--example1-stage-1a-start--&gt;' '&lt;!--example1-stage-1a-end--&gt;' -->

<h3 id="the-mailbox-controller">The mailbox controller<a class="headerlink" href="#the-mailbox-controller" title="Permanent link">#</a></h3>
<p>The mailbox controller is one of the central controllers of
KubeStellar.  If you have deployed the KubeStellar core as Kubernetes
workload then this controller is already running in a pod in your
hosting cluster. If instead you are running these controllers as bare
processes then launch this controller as follows.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-84-1" name="__codelineno-84-1" href="#__codelineno-84-1"></a><span class="c1"># TODO: mailbox controller has kcp dependencies. Will remove when controllers support spaces.</span>
<a id="__codelineno-84-2" name="__codelineno-84-2" href="#__codelineno-84-2"></a>kubectl<span class="w"> </span>ws<span class="w"> </span>root:espw
<a id="__codelineno-84-3" name="__codelineno-84-3" href="#__codelineno-84-3"></a>mailbox-controller<span class="w"> </span>-v<span class="o">=</span><span class="m">4</span><span class="w"> </span><span class="p">&amp;</span>&gt;<span class="w"> </span>/tmp/mailbox-controller.log<span class="w"> </span><span class="p">&amp;</span>
<a id="__codelineno-84-4" name="__codelineno-84-4" href="#__codelineno-84-4"></a>sleep<span class="w"> </span><span class="m">20</span>
</code></pre></div>
<p>This controller is in charge of maintaining the collection of mailbox
workspaces, which are an implementation detail not intended for user
consumption. You can use the following command to wait for the
appearance of the mailbox workspaces implied by the florin and guilder
<code>SyncTarget</code> objects that you made earlier.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-85-1" name="__codelineno-85-1" href="#__codelineno-85-1"></a><span class="c1"># TODO: leaving this here so we get a list of all the workspaces.  Once all the workspaces, including the ones created by the mailbox are converted to spaces, we&#39;ll remove this ws.&quot;</span>
<a id="__codelineno-85-2" name="__codelineno-85-2" href="#__codelineno-85-2"></a>kubectl<span class="w"> </span>ws<span class="w"> </span>root
<a id="__codelineno-85-3" name="__codelineno-85-3" href="#__codelineno-85-3"></a><span class="k">while</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="k">$(</span>kubectl<span class="w"> </span>ws<span class="w"> </span>tree<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;\-mb\-&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>wc<span class="w"> </span>-l<span class="k">)</span><span class="w"> </span>-ne<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<a id="__codelineno-85-4" name="__codelineno-85-4" href="#__codelineno-85-4"></a><span class="w">  </span>sleep<span class="w"> </span><span class="m">10</span>
<a id="__codelineno-85-5" name="__codelineno-85-5" href="#__codelineno-85-5"></a><span class="k">done</span>
</code></pre></div>
<p>If it is working correctly, lines like the following will appear in
the controller's log (which is being written into your shell if you ran the controller as a bare process above, otherwise you can fetch <a href="../commands/#fetch-a-log-from-a-kubestellar-runtime-container">as directed</a>).</p>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-86-1" name="__codelineno-86-1" href="#__codelineno-86-1"></a>...
<a id="__codelineno-86-2" name="__codelineno-86-2" href="#__codelineno-86-2"></a>I0721<span class="w"> </span><span class="m">17</span>:37:10.186848<span class="w">  </span><span class="m">189094</span><span class="w"> </span>main.go:206<span class="o">]</span><span class="w"> </span><span class="s2">&quot;Found APIExport view&quot;</span><span class="w"> </span><span class="nv">exportName</span><span class="o">=</span><span class="s2">&quot;e</span>
<a id="__codelineno-86-3" name="__codelineno-86-3" href="#__codelineno-86-3"></a><span class="s2">dge.kubestellar.io&quot;</span><span class="w"> </span><span class="nv">serverURL</span><span class="o">=</span><span class="s2">&quot;https://10.0.2.15:6443/services/apiexport/cseslli1ddit3s</span>
<a id="__codelineno-86-4" name="__codelineno-86-4" href="#__codelineno-86-4"></a><span class="s2">a5/edge.kubestellar.io&quot;</span>
<a id="__codelineno-86-5" name="__codelineno-86-5" href="#__codelineno-86-5"></a>...
<a id="__codelineno-86-6" name="__codelineno-86-6" href="#__codelineno-86-6"></a>I0721<span class="w"> </span><span class="m">19</span>:17:21.906984<span class="w">  </span><span class="m">189094</span><span class="w"> </span>controller.go:300<span class="o">]</span><span class="w"> </span><span class="s2">&quot;Created APIBinding&quot;</span><span class="w"> </span><span class="nv">worker</span><span class="o">=</span><span class="m">1</span>
<a id="__codelineno-86-7" name="__codelineno-86-7" href="#__codelineno-86-7"></a><span class="nv">mbwsName</span><span class="o">=</span><span class="s2">&quot;1d55jhazpo3d3va6-mb-551bebfd-b75e-47b1-b2e0-ff0a4cb7e006&quot;</span><span class="w"> </span><span class="nv">mbwsCluster</span>
<a id="__codelineno-86-8" name="__codelineno-86-8" href="#__codelineno-86-8"></a><span class="o">=</span><span class="s2">&quot;32x6b03ixc49cj48&quot;</span><span class="w"> </span><span class="nv">bindingName</span><span class="o">=</span><span class="s2">&quot;bind-edge&quot;</span><span class="w"> </span><span class="nv">resourceVersion</span><span class="o">=</span><span class="s2">&quot;1247&quot;</span>
<a id="__codelineno-86-9" name="__codelineno-86-9" href="#__codelineno-86-9"></a>...
<a id="__codelineno-86-10" name="__codelineno-86-10" href="#__codelineno-86-10"></a>I0721<span class="w"> </span><span class="m">19</span>:18:56.203057<span class="w">  </span><span class="m">189094</span><span class="w"> </span>controller.go:300<span class="o">]</span><span class="w"> </span><span class="s2">&quot;Created APIBinding&quot;</span><span class="w"> </span><span class="nv">worker</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-86-11" name="__codelineno-86-11" href="#__codelineno-86-11"></a><span class="nv">mbwsName</span><span class="o">=</span><span class="s2">&quot;1d55jhazpo3d3va6-mb-732cf72a-1ca9-4def-a5e7-78fd0e36e61c&quot;</span><span class="w"> </span><span class="nv">mbwsCluster</span>
<a id="__codelineno-86-12" name="__codelineno-86-12" href="#__codelineno-86-12"></a><span class="o">=</span><span class="s2">&quot;q31lsrpgur3eg9qk&quot;</span><span class="w"> </span><span class="nv">bindingName</span><span class="o">=</span><span class="s2">&quot;bind-edge&quot;</span><span class="w"> </span><span class="nv">resourceVersion</span><span class="o">=</span><span class="s2">&quot;1329&quot;</span>
<a id="__codelineno-86-13" name="__codelineno-86-13" href="#__codelineno-86-13"></a>^C
</code></pre></div>
<p>You need a <code>-v</code> setting of 2 or numerically higher to get log messages
about individual mailbox workspaces.</p>
<p>A mailbox workspace name is distinguished by <code>-mb-</code> separator.
You can get a listing of those mailbox workspaces as follows.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-87-1" name="__codelineno-87-1" href="#__codelineno-87-1"></a><span class="c1"># TODO: currently some workspaces are not created as spaces, specifically the mailbox workspaces, so leaving this code.</span>
<a id="__codelineno-87-2" name="__codelineno-87-2" href="#__codelineno-87-2"></a>kubectl<span class="w"> </span>ws<span class="w"> </span>root
<a id="__codelineno-87-3" name="__codelineno-87-3" href="#__codelineno-87-3"></a>kubectl<span class="w"> </span>get<span class="w"> </span>Workspaces
</code></pre></div>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-88-1" name="__codelineno-88-1" href="#__codelineno-88-1"></a>NAME<span class="w">                                                       </span>TYPE<span class="w">          </span>REGION<span class="w">   </span>PHASE<span class="w">   </span>URL<span class="w">                                                     </span>AGE
<a id="__codelineno-88-2" name="__codelineno-88-2" href="#__codelineno-88-2"></a>1t82bk54r6gjnzsp-mb-1a045336-8178-4026-8a56-5cd5609c0ec1<span class="w">   </span>universal<span class="w">              </span>Ready<span class="w">   </span>https://192.168.58.123:6443/clusters/1najcltzt2nqax47<span class="w">   </span>50s
<a id="__codelineno-88-3" name="__codelineno-88-3" href="#__codelineno-88-3"></a>1t82bk54r6gjnzsp-mb-f0a82ab1-63f4-49ea-954d-3a41a35a9f1c<span class="w">   </span>universal<span class="w">              </span>Ready<span class="w">   </span>https://192.168.58.123:6443/clusters/1y7wll1dz806h3sb<span class="w">   </span>50s
<a id="__codelineno-88-4" name="__codelineno-88-4" href="#__codelineno-88-4"></a>compute<span class="w">                                                    </span>universal<span class="w">              </span>Ready<span class="w">   </span>https://172.20.144.39:6443/clusters/root:compute<span class="w">        </span>6m8s
<a id="__codelineno-88-5" name="__codelineno-88-5" href="#__codelineno-88-5"></a>espw<span class="w">                                                       </span>organization<span class="w">           </span>Ready<span class="w">   </span>https://172.20.144.39:6443/clusters/root:espw<span class="w">           </span>2m4s
<a id="__codelineno-88-6" name="__codelineno-88-6" href="#__codelineno-88-6"></a>imw1<span class="w">                                                       </span>organization<span class="w">           </span>Ready<span class="w">   </span>https://172.20.144.39:6443/clusters/root:imw1<span class="w">           </span>1m9s
</code></pre></div></p>
<p>More usefully, using custom columns you can get a listing that shows
the <em>name</em> of the associated SyncTarget.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-89-1" name="__codelineno-89-1" href="#__codelineno-89-1"></a><span class="c1"># TODO: currently some workspaces are not created as spaces, specifically the mailbox workspaces, so leaving this code</span>
<a id="__codelineno-89-2" name="__codelineno-89-2" href="#__codelineno-89-2"></a>kubectl<span class="w"> </span>get<span class="w"> </span>Workspace<span class="w"> </span>-o<span class="w"> </span><span class="s2">&quot;custom-columns=NAME:.metadata.name,SYNCTARGET:.metadata.annotations[&#39;edge\.kubestellar\.io/sync-target-name&#39;],CLUSTER:.spec.cluster&quot;</span>
</code></pre></div>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-90-1" name="__codelineno-90-1" href="#__codelineno-90-1"></a>NAME<span class="w">                                                       </span>SYNCTARGET<span class="w">   </span>CLUSTER
<a id="__codelineno-90-2" name="__codelineno-90-2" href="#__codelineno-90-2"></a>1t82bk54r6gjnzsp-mb-1a045336-8178-4026-8a56-5cd5609c0ec1<span class="w">   </span>florin<span class="w">       </span>1najcltzt2nqax47
<a id="__codelineno-90-3" name="__codelineno-90-3" href="#__codelineno-90-3"></a>1t82bk54r6gjnzsp-mb-f0a82ab1-63f4-49ea-954d-3a41a35a9f1c<span class="w">   </span>guilder<span class="w">      </span>1y7wll1dz806h3sb
<a id="__codelineno-90-4" name="__codelineno-90-4" href="#__codelineno-90-4"></a>compute<span class="w">                                                    </span>&lt;none&gt;<span class="w">       </span>mqnl7r5f56hswewy
<a id="__codelineno-90-5" name="__codelineno-90-5" href="#__codelineno-90-5"></a>espw<span class="w">                                                       </span>&lt;none&gt;<span class="w">       </span>2n88ugkhysjbxqp5
<a id="__codelineno-90-6" name="__codelineno-90-6" href="#__codelineno-90-6"></a>imw1<span class="w">                                                       </span>&lt;none&gt;<span class="w">       </span>4d2r9stcyy2qq5c1
</code></pre></div></p>
<p>Also: if you ever need to look up just one mailbox workspace by
SyncTarget name, you could do it as follows.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-91-1" name="__codelineno-91-1" href="#__codelineno-91-1"></a><span class="c1"># TODO: currently some workspaces are not created as spaces, specifically the mailbox workspaces, so leaving this code</span>
<a id="__codelineno-91-2" name="__codelineno-91-2" href="#__codelineno-91-2"></a><span class="nv">GUILDER_WS</span><span class="o">=</span><span class="k">$(</span>kubectl<span class="w"> </span>get<span class="w"> </span>Workspace<span class="w"> </span>-o<span class="w"> </span>json<span class="w"> </span><span class="p">|</span><span class="w"> </span>jq<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;.items | .[] | .metadata | select(.annotations [&quot;edge.kubestellar.io/sync-target-name&quot;] == &quot;guilder&quot;) | .name&#39;</span><span class="k">)</span>
<a id="__codelineno-91-3" name="__codelineno-91-3" href="#__codelineno-91-3"></a><span class="nb">echo</span><span class="w"> </span>The<span class="w"> </span>guilder<span class="w"> </span>mailbox<span class="w"> </span>workspace<span class="w"> </span>name<span class="w"> </span>is<span class="w"> </span><span class="nv">$GUILDER_WS</span>
</code></pre></div>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-92-1" name="__codelineno-92-1" href="#__codelineno-92-1"></a>The<span class="w"> </span>guilder<span class="w"> </span>mailbox<span class="w"> </span>workspace<span class="w"> </span>name<span class="w"> </span>is<span class="w"> </span>1t82bk54r6gjnzsp-mb-f0a82ab1-63f4-49ea-954d-3a41a35a9f1c
</code></pre></div></p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-93-1" name="__codelineno-93-1" href="#__codelineno-93-1"></a><span class="c1"># TODO: currently some workspaces are not created as spaces, specifically the mailbox workspaces, so leaving this code</span>
<a id="__codelineno-93-2" name="__codelineno-93-2" href="#__codelineno-93-2"></a><span class="nv">FLORIN_WS</span><span class="o">=</span><span class="k">$(</span>kubectl<span class="w"> </span>get<span class="w"> </span>Workspace<span class="w"> </span>-o<span class="w"> </span>json<span class="w"> </span><span class="p">|</span><span class="w"> </span>jq<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;.items | .[] | .metadata | select(.annotations [&quot;edge.kubestellar.io/sync-target-name&quot;] == &quot;florin&quot;) | .name&#39;</span><span class="k">)</span>
<a id="__codelineno-93-3" name="__codelineno-93-3" href="#__codelineno-93-3"></a><span class="nb">echo</span><span class="w"> </span>The<span class="w"> </span>florin<span class="w"> </span>mailbox<span class="w"> </span>workspace<span class="w"> </span>name<span class="w"> </span>is<span class="w"> </span><span class="nv">$FLORIN_WS</span>
</code></pre></div>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-94-1" name="__codelineno-94-1" href="#__codelineno-94-1"></a>The<span class="w"> </span>florin<span class="w"> </span>mailbox<span class="w"> </span>workspace<span class="w"> </span>name<span class="w"> </span>is<span class="w"> </span>1t82bk54r6gjnzsp-mb-1a045336-8178-4026-8a56-5cd5609c0ec1
</code></pre></div></p>
<!-- END INCLUDE -->

<!-- BEGIN INCLUDE ./example1-stage-1b.md '&lt;!--example1-stage-1b-start--&gt;' '&lt;!--example1-stage-1b-end--&gt;' -->

<h3 id="connect-guilder-edge-cluster-with-its-mailbox-workspace">Connect guilder edge cluster with its mailbox workspace<a class="headerlink" href="#connect-guilder-edge-cluster-with-its-mailbox-workspace" title="Permanent link">#</a></h3>
<p>The following command will (a) create, in the mailbox workspace for
guilder, an identity and authorizations for the edge syncer and (b)
write a file containing YAML for deploying the syncer in the guilder
cluster.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-95-1" name="__codelineno-95-1" href="#__codelineno-95-1"></a>kubectl<span class="w"> </span>kubestellar<span class="w"> </span>prep-for-syncer<span class="w"> </span>--imw<span class="w"> </span>imw1<span class="w"> </span>--espw<span class="w"> </span>espw<span class="w"> </span>guilder
</code></pre></div>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-96-1" name="__codelineno-96-1" href="#__codelineno-96-1"></a>Current<span class="w"> </span>workspace<span class="w"> </span>is<span class="w"> </span><span class="s2">&quot;root:imw1&quot;</span>.
<a id="__codelineno-96-2" name="__codelineno-96-2" href="#__codelineno-96-2"></a>Current<span class="w"> </span>workspace<span class="w"> </span>is<span class="w"> </span><span class="s2">&quot;root:espw&quot;</span>.
<a id="__codelineno-96-3" name="__codelineno-96-3" href="#__codelineno-96-3"></a>Current<span class="w"> </span>workspace<span class="w"> </span>is<span class="w"> </span><span class="s2">&quot;root:espw:1t82bk54r6gjnzsp-mb-f0a82ab1-63f4-49ea-954d-3a41a35a9f1c&quot;</span><span class="w"> </span><span class="o">(</span><span class="nb">type</span><span class="w"> </span>root:universal<span class="o">)</span>.
<a id="__codelineno-96-4" name="__codelineno-96-4" href="#__codelineno-96-4"></a>Creating<span class="w"> </span>service<span class="w"> </span>account<span class="w"> </span><span class="s2">&quot;kubestellar-syncer-guilder-wfeig2lv&quot;</span>
<a id="__codelineno-96-5" name="__codelineno-96-5" href="#__codelineno-96-5"></a>Creating<span class="w"> </span>cluster<span class="w"> </span>role<span class="w"> </span><span class="s2">&quot;kubestellar-syncer-guilder-wfeig2lv&quot;</span><span class="w"> </span>to<span class="w"> </span>give<span class="w"> </span>service<span class="w"> </span>account<span class="w"> </span><span class="s2">&quot;kubestellar-syncer-guilder-wfeig2lv&quot;</span>
<a id="__codelineno-96-6" name="__codelineno-96-6" href="#__codelineno-96-6"></a>
<a id="__codelineno-96-7" name="__codelineno-96-7" href="#__codelineno-96-7"></a><span class="w"> </span><span class="m">1</span>.<span class="w"> </span>write<span class="w"> </span>and<span class="w"> </span>sync<span class="w"> </span>access<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>synctarget<span class="w"> </span><span class="s2">&quot;kubestellar-syncer-guilder-wfeig2lv&quot;</span>
<a id="__codelineno-96-8" name="__codelineno-96-8" href="#__codelineno-96-8"></a><span class="w"> </span><span class="m">2</span>.<span class="w"> </span>write<span class="w"> </span>access<span class="w"> </span>to<span class="w"> </span>apiresourceimports.
<a id="__codelineno-96-9" name="__codelineno-96-9" href="#__codelineno-96-9"></a>
<a id="__codelineno-96-10" name="__codelineno-96-10" href="#__codelineno-96-10"></a>Creating<span class="w"> </span>or<span class="w"> </span>updating<span class="w"> </span>cluster<span class="w"> </span>role<span class="w"> </span>binding<span class="w"> </span><span class="s2">&quot;kubestellar-syncer-guilder-wfeig2lv&quot;</span><span class="w"> </span>to<span class="w"> </span><span class="nb">bind</span><span class="w"> </span>service<span class="w"> </span>account<span class="w"> </span><span class="s2">&quot;kubestellar-syncer-guilder-wfeig2lv&quot;</span><span class="w"> </span>to<span class="w"> </span>cluster<span class="w"> </span>role<span class="w"> </span><span class="s2">&quot;kubestellar-syncer-guilder-wfeig2lv&quot;</span>.
<a id="__codelineno-96-11" name="__codelineno-96-11" href="#__codelineno-96-11"></a>
<a id="__codelineno-96-12" name="__codelineno-96-12" href="#__codelineno-96-12"></a>Wrote<span class="w"> </span>WEC<span class="w"> </span>manifest<span class="w"> </span>to<span class="w"> </span>guilder-syncer.yaml<span class="w"> </span><span class="k">for</span><span class="w"> </span>namespace<span class="w"> </span><span class="s2">&quot;kubestellar-syncer-guilder-wfeig2lv&quot;</span>.<span class="w"> </span>Use
<a id="__codelineno-96-13" name="__codelineno-96-13" href="#__codelineno-96-13"></a>
<a id="__codelineno-96-14" name="__codelineno-96-14" href="#__codelineno-96-14"></a><span class="w">  </span><span class="nv">KUBECONFIG</span><span class="o">=</span>&lt;workload-execution-cluster-config&gt;<span class="w"> </span>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;guilder-syncer.yaml&quot;</span>
<a id="__codelineno-96-15" name="__codelineno-96-15" href="#__codelineno-96-15"></a>
<a id="__codelineno-96-16" name="__codelineno-96-16" href="#__codelineno-96-16"></a>to<span class="w"> </span>apply<span class="w"> </span>it.<span class="w"> </span>Use
<a id="__codelineno-96-17" name="__codelineno-96-17" href="#__codelineno-96-17"></a>
<a id="__codelineno-96-18" name="__codelineno-96-18" href="#__codelineno-96-18"></a><span class="w">  </span><span class="nv">KUBECONFIG</span><span class="o">=</span>&lt;workload-execution-cluster-config&gt;<span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>deployment<span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;kubestellar-syncer-guilder-wfeig2lv&quot;</span><span class="w"> </span>kubestellar-syncer-guilder-wfeig2lv
<a id="__codelineno-96-19" name="__codelineno-96-19" href="#__codelineno-96-19"></a>
<a id="__codelineno-96-20" name="__codelineno-96-20" href="#__codelineno-96-20"></a>to<span class="w"> </span>verify<span class="w"> </span>the<span class="w"> </span>syncer<span class="w"> </span>pod<span class="w"> </span>is<span class="w"> </span>running.
<a id="__codelineno-96-21" name="__codelineno-96-21" href="#__codelineno-96-21"></a>Current<span class="w"> </span>workspace<span class="w"> </span>is<span class="w"> </span><span class="s2">&quot;root:espw&quot;</span>.
</code></pre></div></p>
<p>The file written was, as mentioned in the output,
<code>guilder-syncer.yaml</code>.  Next <code>kubectl apply</code> that to the guilder
cluster.  That will look something like the following; adjust as
necessary to make kubectl manipulate <strong>your</strong> guilder cluster.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-97-1" name="__codelineno-97-1" href="#__codelineno-97-1"></a><span class="nv">KUBECONFIG</span><span class="o">=</span>~/.kube/config<span class="w"> </span>kubectl<span class="w"> </span>--context<span class="w"> </span>kind-guilder<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>guilder-syncer.yaml
</code></pre></div>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-98-1" name="__codelineno-98-1" href="#__codelineno-98-1"></a>namespace/kubestellar-syncer-guilder-wfeig2lv<span class="w"> </span>created
<a id="__codelineno-98-2" name="__codelineno-98-2" href="#__codelineno-98-2"></a>serviceaccount/kubestellar-syncer-guilder-wfeig2lv<span class="w"> </span>created
<a id="__codelineno-98-3" name="__codelineno-98-3" href="#__codelineno-98-3"></a>secret/kubestellar-syncer-guilder-wfeig2lv-token<span class="w"> </span>created
<a id="__codelineno-98-4" name="__codelineno-98-4" href="#__codelineno-98-4"></a>clusterrole.rbac.authorization.k8s.io/kubestellar-syncer-guilder-wfeig2lv<span class="w"> </span>created
<a id="__codelineno-98-5" name="__codelineno-98-5" href="#__codelineno-98-5"></a>clusterrolebinding.rbac.authorization.k8s.io/kubestellar-syncer-guilder-wfeig2lv<span class="w"> </span>created
<a id="__codelineno-98-6" name="__codelineno-98-6" href="#__codelineno-98-6"></a>secret/kubestellar-syncer-guilder-wfeig2lv<span class="w"> </span>created
<a id="__codelineno-98-7" name="__codelineno-98-7" href="#__codelineno-98-7"></a>deployment.apps/kubestellar-syncer-guilder-wfeig2lv<span class="w"> </span>created
</code></pre></div></p>
<p>You might check that the syncer is running, as follows.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-99-1" name="__codelineno-99-1" href="#__codelineno-99-1"></a><span class="nv">KUBECONFIG</span><span class="o">=</span>~/.kube/config<span class="w"> </span>kubectl<span class="w"> </span>--context<span class="w"> </span>kind-guilder<span class="w"> </span>get<span class="w"> </span>deploy<span class="w"> </span>-A
</code></pre></div>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-100-1" name="__codelineno-100-1" href="#__codelineno-100-1"></a>NAMESPACE<span class="w">                          </span>NAME<span class="w">                               </span>READY<span class="w">   </span>UP-TO-DATE<span class="w">   </span>AVAILABLE<span class="w">   </span>AGE
<a id="__codelineno-100-2" name="__codelineno-100-2" href="#__codelineno-100-2"></a>kubestellar-syncer-guilder-saaywsu5<span class="w">   </span>kubestellar-syncer-guilder-saaywsu5<span class="w">   </span><span class="m">1</span>/1<span class="w">     </span><span class="m">1</span><span class="w">            </span><span class="m">1</span><span class="w">           </span>52s
<a id="__codelineno-100-3" name="__codelineno-100-3" href="#__codelineno-100-3"></a>kube-system<span class="w">                        </span>coredns<span class="w">                            </span><span class="m">2</span>/2<span class="w">     </span><span class="m">2</span><span class="w">            </span><span class="m">2</span><span class="w">           </span>35m
<a id="__codelineno-100-4" name="__codelineno-100-4" href="#__codelineno-100-4"></a>local-path-storage<span class="w">                 </span>local-path-provisioner<span class="w">             </span><span class="m">1</span>/1<span class="w">     </span><span class="m">1</span><span class="w">            </span><span class="m">1</span><span class="w">           </span>35m
</code></pre></div></p>
<h3 id="connect-florin-edge-cluster-with-its-mailbox-workspace">Connect florin edge cluster with its mailbox workspace<a class="headerlink" href="#connect-florin-edge-cluster-with-its-mailbox-workspace" title="Permanent link">#</a></h3>
<p>Do the analogous stuff for the florin cluster.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-101-1" name="__codelineno-101-1" href="#__codelineno-101-1"></a>kubectl<span class="w"> </span>kubestellar<span class="w"> </span>prep-for-syncer<span class="w"> </span>--imw<span class="w"> </span>imw1<span class="w"> </span>--espw<span class="w"> </span>espw<span class="w"> </span>florin
</code></pre></div>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-102-1" name="__codelineno-102-1" href="#__codelineno-102-1"></a>Current<span class="w"> </span>workspace<span class="w"> </span>is<span class="w"> </span><span class="s2">&quot;root:imw1&quot;</span>.
<a id="__codelineno-102-2" name="__codelineno-102-2" href="#__codelineno-102-2"></a>Current<span class="w"> </span>workspace<span class="w"> </span>is<span class="w"> </span><span class="s2">&quot;root:espw&quot;</span>.
<a id="__codelineno-102-3" name="__codelineno-102-3" href="#__codelineno-102-3"></a>Current<span class="w"> </span>workspace<span class="w"> </span>is<span class="w"> </span><span class="s2">&quot;root:espw:1t82bk54r6gjnzsp-mb-1a045336-8178-4026-8a56-5cd5609c0ec1&quot;</span><span class="w"> </span><span class="o">(</span><span class="nb">type</span><span class="w"> </span>root:universal<span class="o">)</span>.
<a id="__codelineno-102-4" name="__codelineno-102-4" href="#__codelineno-102-4"></a>Creating<span class="w"> </span>service<span class="w"> </span>account<span class="w"> </span><span class="s2">&quot;kubestellar-syncer-florin-32uaph9l&quot;</span>
<a id="__codelineno-102-5" name="__codelineno-102-5" href="#__codelineno-102-5"></a>Creating<span class="w"> </span>cluster<span class="w"> </span>role<span class="w"> </span><span class="s2">&quot;kubestellar-syncer-florin-32uaph9l&quot;</span><span class="w"> </span>to<span class="w"> </span>give<span class="w"> </span>service<span class="w"> </span>account<span class="w"> </span><span class="s2">&quot;kubestellar-syncer-florin-32uaph9l&quot;</span>
<a id="__codelineno-102-6" name="__codelineno-102-6" href="#__codelineno-102-6"></a>
<a id="__codelineno-102-7" name="__codelineno-102-7" href="#__codelineno-102-7"></a><span class="w"> </span><span class="m">1</span>.<span class="w"> </span>write<span class="w"> </span>and<span class="w"> </span>sync<span class="w"> </span>access<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>synctarget<span class="w"> </span><span class="s2">&quot;kubestellar-syncer-florin-32uaph9l&quot;</span>
<a id="__codelineno-102-8" name="__codelineno-102-8" href="#__codelineno-102-8"></a><span class="w"> </span><span class="m">2</span>.<span class="w"> </span>write<span class="w"> </span>access<span class="w"> </span>to<span class="w"> </span>apiresourceimports.
<a id="__codelineno-102-9" name="__codelineno-102-9" href="#__codelineno-102-9"></a>
<a id="__codelineno-102-10" name="__codelineno-102-10" href="#__codelineno-102-10"></a>Creating<span class="w"> </span>or<span class="w"> </span>updating<span class="w"> </span>cluster<span class="w"> </span>role<span class="w"> </span>binding<span class="w"> </span><span class="s2">&quot;kubestellar-syncer-florin-32uaph9l&quot;</span><span class="w"> </span>to<span class="w"> </span><span class="nb">bind</span><span class="w"> </span>service<span class="w"> </span>account<span class="w"> </span><span class="s2">&quot;kubestellar-syncer-florin-32uaph9l&quot;</span><span class="w"> </span>to<span class="w"> </span>cluster<span class="w"> </span>role<span class="w"> </span><span class="s2">&quot;kubestellar-syncer-florin-32uaph9l&quot;</span>.
<a id="__codelineno-102-11" name="__codelineno-102-11" href="#__codelineno-102-11"></a>
<a id="__codelineno-102-12" name="__codelineno-102-12" href="#__codelineno-102-12"></a>Wrote<span class="w"> </span>workload<span class="w"> </span>execution<span class="w"> </span>cluster<span class="w"> </span><span class="o">(</span>WEC<span class="o">)</span><span class="w"> </span>manifest<span class="w"> </span>to<span class="w"> </span>florin-syncer.yaml<span class="w"> </span><span class="k">for</span><span class="w"> </span>namespace<span class="w"> </span><span class="s2">&quot;kubestellar-syncer-florin-32uaph9l&quot;</span>.<span class="w"> </span>Use
<a id="__codelineno-102-13" name="__codelineno-102-13" href="#__codelineno-102-13"></a>
<a id="__codelineno-102-14" name="__codelineno-102-14" href="#__codelineno-102-14"></a><span class="w">  </span><span class="nv">KUBECONFIG</span><span class="o">=</span>&lt;workload-execution-cluster-config&gt;<span class="w"> </span>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;florin-syncer.yaml&quot;</span>
<a id="__codelineno-102-15" name="__codelineno-102-15" href="#__codelineno-102-15"></a>
<a id="__codelineno-102-16" name="__codelineno-102-16" href="#__codelineno-102-16"></a>to<span class="w"> </span>apply<span class="w"> </span>it.<span class="w"> </span>Use
<a id="__codelineno-102-17" name="__codelineno-102-17" href="#__codelineno-102-17"></a>
<a id="__codelineno-102-18" name="__codelineno-102-18" href="#__codelineno-102-18"></a><span class="w">  </span><span class="nv">KUBECONFIG</span><span class="o">=</span>&lt;workload-execution-cluster-config&gt;<span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>deployment<span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;kubestellar-syncer-florin-32uaph9l&quot;</span><span class="w"> </span>kubestellar-syncer-florin-32uaph9l
<a id="__codelineno-102-19" name="__codelineno-102-19" href="#__codelineno-102-19"></a>
<a id="__codelineno-102-20" name="__codelineno-102-20" href="#__codelineno-102-20"></a>to<span class="w"> </span>verify<span class="w"> </span>the<span class="w"> </span>syncer<span class="w"> </span>pod<span class="w"> </span>is<span class="w"> </span>running.
<a id="__codelineno-102-21" name="__codelineno-102-21" href="#__codelineno-102-21"></a>Current<span class="w"> </span>workspace<span class="w"> </span>is<span class="w"> </span><span class="s2">&quot;root:espw&quot;</span>.
</code></pre></div></p>
<p>And deploy the syncer in the florin cluster.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-103-1" name="__codelineno-103-1" href="#__codelineno-103-1"></a><span class="nv">KUBECONFIG</span><span class="o">=</span>~/.kube/config<span class="w"> </span>kubectl<span class="w"> </span>--context<span class="w"> </span>kind-florin<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>florin-syncer.yaml<span class="w"> </span>
</code></pre></div>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-104-1" name="__codelineno-104-1" href="#__codelineno-104-1"></a>namespace/kubestellar-syncer-florin-32uaph9l<span class="w"> </span>created
<a id="__codelineno-104-2" name="__codelineno-104-2" href="#__codelineno-104-2"></a>serviceaccount/kubestellar-syncer-florin-32uaph9l<span class="w"> </span>created
<a id="__codelineno-104-3" name="__codelineno-104-3" href="#__codelineno-104-3"></a>secret/kubestellar-syncer-florin-32uaph9l-token<span class="w"> </span>created
<a id="__codelineno-104-4" name="__codelineno-104-4" href="#__codelineno-104-4"></a>clusterrole.rbac.authorization.k8s.io/kubestellar-syncer-florin-32uaph9l<span class="w"> </span>created
<a id="__codelineno-104-5" name="__codelineno-104-5" href="#__codelineno-104-5"></a>clusterrolebinding.rbac.authorization.k8s.io/kubestellar-syncer-florin-32uaph9l<span class="w"> </span>created
<a id="__codelineno-104-6" name="__codelineno-104-6" href="#__codelineno-104-6"></a>secret/kubestellar-syncer-florin-32uaph9l<span class="w"> </span>created
<a id="__codelineno-104-7" name="__codelineno-104-7" href="#__codelineno-104-7"></a>deployment.apps/kubestellar-syncer-florin-32uaph9l<span class="w"> </span>created
</code></pre></div></p>
<!-- END INCLUDE -->

<!-- BEGIN INCLUDE ./example1-stage-2.md '&lt;!--example1-stage-2-start--&gt;' '&lt;!--example1-stage-2-end--&gt;' -->

<h2 id="stage-2">Stage 2<a class="headerlink" href="#stage-2" title="Permanent link">#</a></h2>
<p><img alt="Placement and Where Resolving" src="../Edge-PoC-2023q1-Scenario-1-stage-2.svg" title="Stage 2 summary" /></p>
<p>Stage 2 creates two workloads, called "common" and "special", and lets
the Where Resolver react.  It has the following steps.</p>
<h3 id="create-and-populate-the-workload-management-workspace-for-the-common-workload">Create and populate the workload management workspace for the common workload<a class="headerlink" href="#create-and-populate-the-workload-management-workspace-for-the-common-workload" title="Permanent link">#</a></h3>
<p>One of the workloads is called "common", because it will go to both
edge clusters.  The other one is called "special".</p>
<p>In this example, each workload description goes in its own workload
management workspace (WMW).  Start by creating a WMW for the common
workload, with the following commands.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-105-1" name="__codelineno-105-1" href="#__codelineno-105-1"></a><span class="nv">IN_CLUSTER</span><span class="o">=</span><span class="nb">false</span><span class="w"> </span><span class="nv">SPACE_MANAGER_KUBECONFIG</span><span class="o">=</span><span class="nv">$SM_CONFIG</span><span class="w"> </span>kubectl<span class="w"> </span>kubestellar<span class="w"> </span>ensure<span class="w"> </span>wmw<span class="w"> </span>wmw-c
<a id="__codelineno-105-2" name="__codelineno-105-2" href="#__codelineno-105-2"></a><span class="nv">wmw_c_space_config</span><span class="o">=</span><span class="nv">$PWD</span>/temp-space-config/spaceprovider-default-wmw-c
</code></pre></div>
<div class="hide-me highlight"><pre><span></span><code><a id="__codelineno-106-1" name="__codelineno-106-1" href="#__codelineno-106-1"></a>sleep<span class="w"> </span><span class="m">15</span>
</code></pre></div>
<p>Next, use <code>kubectl</code> to create the following workload objects in that
workspace.  The workload in this example in an Apache httpd server
that serves up a very simple web page, conveyed via a Kubernetes
ConfigMap that is mounted as a volume for the httpd pod.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-107-1" name="__codelineno-107-1" href="#__codelineno-107-1"></a>kubectl<span class="w"> </span>--kubeconfig<span class="w"> </span><span class="nv">$wmw_c_space_config</span><span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>-<span class="w"> </span><span class="s">&lt;&lt;EOF</span>
<a id="__codelineno-107-2" name="__codelineno-107-2" href="#__codelineno-107-2"></a><span class="s">apiVersion: v1</span>
<a id="__codelineno-107-3" name="__codelineno-107-3" href="#__codelineno-107-3"></a><span class="s">kind: Namespace</span>
<a id="__codelineno-107-4" name="__codelineno-107-4" href="#__codelineno-107-4"></a><span class="s">metadata:</span>
<a id="__codelineno-107-5" name="__codelineno-107-5" href="#__codelineno-107-5"></a><span class="s">  name: commonstuff</span>
<a id="__codelineno-107-6" name="__codelineno-107-6" href="#__codelineno-107-6"></a><span class="s">---</span>
<a id="__codelineno-107-7" name="__codelineno-107-7" href="#__codelineno-107-7"></a><span class="s">apiVersion: v1</span>
<a id="__codelineno-107-8" name="__codelineno-107-8" href="#__codelineno-107-8"></a><span class="s">kind: ConfigMap</span>
<a id="__codelineno-107-9" name="__codelineno-107-9" href="#__codelineno-107-9"></a><span class="s">metadata:</span>
<a id="__codelineno-107-10" name="__codelineno-107-10" href="#__codelineno-107-10"></a><span class="s">  namespace: commonstuff</span>
<a id="__codelineno-107-11" name="__codelineno-107-11" href="#__codelineno-107-11"></a><span class="s">  name: httpd-htdocs</span>
<a id="__codelineno-107-12" name="__codelineno-107-12" href="#__codelineno-107-12"></a><span class="s">  annotations:</span>
<a id="__codelineno-107-13" name="__codelineno-107-13" href="#__codelineno-107-13"></a><span class="s">    edge.kubestellar.io/expand-parameters: &quot;true&quot;</span>
<a id="__codelineno-107-14" name="__codelineno-107-14" href="#__codelineno-107-14"></a><span class="s">data:</span>
<a id="__codelineno-107-15" name="__codelineno-107-15" href="#__codelineno-107-15"></a><span class="s">  index.html: |</span>
<a id="__codelineno-107-16" name="__codelineno-107-16" href="#__codelineno-107-16"></a><span class="s">    &lt;!DOCTYPE html&gt;</span>
<a id="__codelineno-107-17" name="__codelineno-107-17" href="#__codelineno-107-17"></a><span class="s">    &lt;html&gt;</span>
<a id="__codelineno-107-18" name="__codelineno-107-18" href="#__codelineno-107-18"></a><span class="s">      &lt;body&gt;</span>
<a id="__codelineno-107-19" name="__codelineno-107-19" href="#__codelineno-107-19"></a><span class="s">        This is a common web site.</span>
<a id="__codelineno-107-20" name="__codelineno-107-20" href="#__codelineno-107-20"></a><span class="s">        Running in %(loc-name).</span>
<a id="__codelineno-107-21" name="__codelineno-107-21" href="#__codelineno-107-21"></a><span class="s">      &lt;/body&gt;</span>
<a id="__codelineno-107-22" name="__codelineno-107-22" href="#__codelineno-107-22"></a><span class="s">    &lt;/html&gt;</span>
<a id="__codelineno-107-23" name="__codelineno-107-23" href="#__codelineno-107-23"></a><span class="s">---</span>
<a id="__codelineno-107-24" name="__codelineno-107-24" href="#__codelineno-107-24"></a><span class="s">apiVersion: edge.kubestellar.io/v2alpha1</span>
<a id="__codelineno-107-25" name="__codelineno-107-25" href="#__codelineno-107-25"></a><span class="s">kind: Customizer</span>
<a id="__codelineno-107-26" name="__codelineno-107-26" href="#__codelineno-107-26"></a><span class="s">metadata:</span>
<a id="__codelineno-107-27" name="__codelineno-107-27" href="#__codelineno-107-27"></a><span class="s">  namespace: commonstuff</span>
<a id="__codelineno-107-28" name="__codelineno-107-28" href="#__codelineno-107-28"></a><span class="s">  name: example-customizer</span>
<a id="__codelineno-107-29" name="__codelineno-107-29" href="#__codelineno-107-29"></a><span class="s">  annotations:</span>
<a id="__codelineno-107-30" name="__codelineno-107-30" href="#__codelineno-107-30"></a><span class="s">    edge.kubestellar.io/expand-parameters: &quot;true&quot;</span>
<a id="__codelineno-107-31" name="__codelineno-107-31" href="#__codelineno-107-31"></a><span class="s">replacements:</span>
<a id="__codelineno-107-32" name="__codelineno-107-32" href="#__codelineno-107-32"></a><span class="s">- path: &quot;$.spec.template.spec.containers.0.env.0.value&quot;</span>
<a id="__codelineno-107-33" name="__codelineno-107-33" href="#__codelineno-107-33"></a><span class="s">  value: &#39;&quot;env is %(env)&quot;&#39;</span>
<a id="__codelineno-107-34" name="__codelineno-107-34" href="#__codelineno-107-34"></a><span class="s">---</span>
<a id="__codelineno-107-35" name="__codelineno-107-35" href="#__codelineno-107-35"></a><span class="s">apiVersion: apps/v1</span>
<a id="__codelineno-107-36" name="__codelineno-107-36" href="#__codelineno-107-36"></a><span class="s">kind: ReplicaSet</span>
<a id="__codelineno-107-37" name="__codelineno-107-37" href="#__codelineno-107-37"></a><span class="s">metadata:</span>
<a id="__codelineno-107-38" name="__codelineno-107-38" href="#__codelineno-107-38"></a><span class="s">  namespace: commonstuff</span>
<a id="__codelineno-107-39" name="__codelineno-107-39" href="#__codelineno-107-39"></a><span class="s">  name: commond</span>
<a id="__codelineno-107-40" name="__codelineno-107-40" href="#__codelineno-107-40"></a><span class="s">  annotations:</span>
<a id="__codelineno-107-41" name="__codelineno-107-41" href="#__codelineno-107-41"></a><span class="s">    edge.kubestellar.io/customizer: example-customizer</span>
<a id="__codelineno-107-42" name="__codelineno-107-42" href="#__codelineno-107-42"></a><span class="s">spec:</span>
<a id="__codelineno-107-43" name="__codelineno-107-43" href="#__codelineno-107-43"></a><span class="s">  selector: {matchLabels: {app: common} }</span>
<a id="__codelineno-107-44" name="__codelineno-107-44" href="#__codelineno-107-44"></a><span class="s">  template:</span>
<a id="__codelineno-107-45" name="__codelineno-107-45" href="#__codelineno-107-45"></a><span class="s">    metadata:</span>
<a id="__codelineno-107-46" name="__codelineno-107-46" href="#__codelineno-107-46"></a><span class="s">      labels: {app: common}</span>
<a id="__codelineno-107-47" name="__codelineno-107-47" href="#__codelineno-107-47"></a><span class="s">    spec:</span>
<a id="__codelineno-107-48" name="__codelineno-107-48" href="#__codelineno-107-48"></a><span class="s">      containers:</span>
<a id="__codelineno-107-49" name="__codelineno-107-49" href="#__codelineno-107-49"></a><span class="s">      - name: httpd</span>
<a id="__codelineno-107-50" name="__codelineno-107-50" href="#__codelineno-107-50"></a><span class="s">        env:</span>
<a id="__codelineno-107-51" name="__codelineno-107-51" href="#__codelineno-107-51"></a><span class="s">        - name: EXAMPLE_VAR</span>
<a id="__codelineno-107-52" name="__codelineno-107-52" href="#__codelineno-107-52"></a><span class="s">          value: example value</span>
<a id="__codelineno-107-53" name="__codelineno-107-53" href="#__codelineno-107-53"></a><span class="s">        image: library/httpd:2.4</span>
<a id="__codelineno-107-54" name="__codelineno-107-54" href="#__codelineno-107-54"></a><span class="s">        ports:</span>
<a id="__codelineno-107-55" name="__codelineno-107-55" href="#__codelineno-107-55"></a><span class="s">        - name: http</span>
<a id="__codelineno-107-56" name="__codelineno-107-56" href="#__codelineno-107-56"></a><span class="s">          containerPort: 80</span>
<a id="__codelineno-107-57" name="__codelineno-107-57" href="#__codelineno-107-57"></a><span class="s">          hostPort: 8081</span>
<a id="__codelineno-107-58" name="__codelineno-107-58" href="#__codelineno-107-58"></a><span class="s">          protocol: TCP</span>
<a id="__codelineno-107-59" name="__codelineno-107-59" href="#__codelineno-107-59"></a><span class="s">        volumeMounts:</span>
<a id="__codelineno-107-60" name="__codelineno-107-60" href="#__codelineno-107-60"></a><span class="s">        - name: htdocs</span>
<a id="__codelineno-107-61" name="__codelineno-107-61" href="#__codelineno-107-61"></a><span class="s">          readOnly: true</span>
<a id="__codelineno-107-62" name="__codelineno-107-62" href="#__codelineno-107-62"></a><span class="s">          mountPath: /usr/local/apache2/htdocs</span>
<a id="__codelineno-107-63" name="__codelineno-107-63" href="#__codelineno-107-63"></a><span class="s">      volumes:</span>
<a id="__codelineno-107-64" name="__codelineno-107-64" href="#__codelineno-107-64"></a><span class="s">      - name: htdocs</span>
<a id="__codelineno-107-65" name="__codelineno-107-65" href="#__codelineno-107-65"></a><span class="s">        configMap:</span>
<a id="__codelineno-107-66" name="__codelineno-107-66" href="#__codelineno-107-66"></a><span class="s">          name: httpd-htdocs</span>
<a id="__codelineno-107-67" name="__codelineno-107-67" href="#__codelineno-107-67"></a><span class="s">          optional: false</span>
<a id="__codelineno-107-68" name="__codelineno-107-68" href="#__codelineno-107-68"></a><span class="s">EOF</span>
</code></pre></div>
<p>Finally, use <code>kubectl</code> to create the following EdgePlacement object.
Its "where predicate" (the <code>locationSelectors</code> array) has one label
selector that matches both Location objects created earlier, thus
directing the common workload to both edge clusters.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-108-1" name="__codelineno-108-1" href="#__codelineno-108-1"></a>kubectl<span class="w"> </span>--kubeconfig<span class="w"> </span><span class="nv">$wmw_c_space_config</span><span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>-<span class="w"> </span><span class="s">&lt;&lt;EOF</span>
<a id="__codelineno-108-2" name="__codelineno-108-2" href="#__codelineno-108-2"></a><span class="s">apiVersion: edge.kubestellar.io/v2alpha1</span>
<a id="__codelineno-108-3" name="__codelineno-108-3" href="#__codelineno-108-3"></a><span class="s">kind: EdgePlacement</span>
<a id="__codelineno-108-4" name="__codelineno-108-4" href="#__codelineno-108-4"></a><span class="s">metadata:</span>
<a id="__codelineno-108-5" name="__codelineno-108-5" href="#__codelineno-108-5"></a><span class="s">  name: edge-placement-c</span>
<a id="__codelineno-108-6" name="__codelineno-108-6" href="#__codelineno-108-6"></a><span class="s">spec:</span>
<a id="__codelineno-108-7" name="__codelineno-108-7" href="#__codelineno-108-7"></a><span class="s">  locationSelectors:</span>
<a id="__codelineno-108-8" name="__codelineno-108-8" href="#__codelineno-108-8"></a><span class="s">  - matchLabels: {&quot;env&quot;:&quot;prod&quot;}</span>
<a id="__codelineno-108-9" name="__codelineno-108-9" href="#__codelineno-108-9"></a><span class="s">  downsync:</span>
<a id="__codelineno-108-10" name="__codelineno-108-10" href="#__codelineno-108-10"></a><span class="s">  - apiGroup: &quot;&quot;</span>
<a id="__codelineno-108-11" name="__codelineno-108-11" href="#__codelineno-108-11"></a><span class="s">    resources: [ configmaps ]</span>
<a id="__codelineno-108-12" name="__codelineno-108-12" href="#__codelineno-108-12"></a><span class="s">    namespaces: [ commonstuff ]</span>
<a id="__codelineno-108-13" name="__codelineno-108-13" href="#__codelineno-108-13"></a><span class="s">    objectNames: [ httpd-htdocs ]</span>
<a id="__codelineno-108-14" name="__codelineno-108-14" href="#__codelineno-108-14"></a><span class="s">  - apiGroup: apps</span>
<a id="__codelineno-108-15" name="__codelineno-108-15" href="#__codelineno-108-15"></a><span class="s">    resources: [ replicasets ]</span>
<a id="__codelineno-108-16" name="__codelineno-108-16" href="#__codelineno-108-16"></a><span class="s">    namespaces: [ commonstuff ]</span>
<a id="__codelineno-108-17" name="__codelineno-108-17" href="#__codelineno-108-17"></a><span class="s">  wantSingletonReportedState: true</span>
<a id="__codelineno-108-18" name="__codelineno-108-18" href="#__codelineno-108-18"></a><span class="s">  upsync:</span>
<a id="__codelineno-108-19" name="__codelineno-108-19" href="#__codelineno-108-19"></a><span class="s">  - apiGroup: &quot;group1.test&quot;</span>
<a id="__codelineno-108-20" name="__codelineno-108-20" href="#__codelineno-108-20"></a><span class="s">    resources: [&quot;sprockets&quot;, &quot;flanges&quot;]</span>
<a id="__codelineno-108-21" name="__codelineno-108-21" href="#__codelineno-108-21"></a><span class="s">    namespaces: [&quot;orbital&quot;]</span>
<a id="__codelineno-108-22" name="__codelineno-108-22" href="#__codelineno-108-22"></a><span class="s">    names: [&quot;george&quot;, &quot;cosmo&quot;]</span>
<a id="__codelineno-108-23" name="__codelineno-108-23" href="#__codelineno-108-23"></a><span class="s">  - apiGroup: &quot;group2.test&quot;</span>
<a id="__codelineno-108-24" name="__codelineno-108-24" href="#__codelineno-108-24"></a><span class="s">    resources: [&quot;cogs&quot;]</span>
<a id="__codelineno-108-25" name="__codelineno-108-25" href="#__codelineno-108-25"></a><span class="s">    names: [&quot;william&quot;]</span>
<a id="__codelineno-108-26" name="__codelineno-108-26" href="#__codelineno-108-26"></a><span class="s">EOF</span>
</code></pre></div>
<div class="hide-me highlight"><pre><span></span><code><a id="__codelineno-109-1" name="__codelineno-109-1" href="#__codelineno-109-1"></a>sleep<span class="w"> </span><span class="m">10</span>
</code></pre></div></p>
<h3 id="create-and-populate-the-workload-management-workspace-for-the-special-workload">Create and populate the workload management workspace for the special workload<a class="headerlink" href="#create-and-populate-the-workload-management-workspace-for-the-special-workload" title="Permanent link">#</a></h3>
<p>Use the following <code>kubectl</code> commands to create the WMW for the special
workload.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-110-1" name="__codelineno-110-1" href="#__codelineno-110-1"></a><span class="nv">IN_CLUSTER</span><span class="o">=</span><span class="nb">false</span><span class="w"> </span><span class="nv">SPACE_MANAGER_KUBECONFIG</span><span class="o">=</span><span class="nv">$SM_CONFIG</span><span class="w"> </span>kubectl<span class="w"> </span>kubestellar<span class="w"> </span>ensure<span class="w"> </span>wmw<span class="w"> </span>wmw-s
<a id="__codelineno-110-2" name="__codelineno-110-2" href="#__codelineno-110-2"></a><span class="nv">wmw_s_space_config</span><span class="o">=</span><span class="nv">$PWD</span>/temp-space-config/spaceprovider-default-wmw-s
</code></pre></div>
<p>In this workload we will also demonstrate how to downsync objects
whose kind is defined by a <code>CustomResourceDefinition</code> object. We will
use the one from <a href="https://kubernetes.io/docs/tasks/extend-kubernetes/custom-resources/custom-resource-definitions/">the Kubernetes documentation for
CRDs</a>,
modified so that the resource it defines is in the category
<code>all</code>. First, create the definition object with the following command.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-111-1" name="__codelineno-111-1" href="#__codelineno-111-1"></a>kubectl<span class="w"> </span>--kubeconfig<span class="w"> </span><span class="nv">$wmw_s_space_config</span><span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>-<span class="w"> </span><span class="s">&lt;&lt;EOF</span>
<a id="__codelineno-111-2" name="__codelineno-111-2" href="#__codelineno-111-2"></a><span class="s">apiVersion: apiextensions.k8s.io/v1</span>
<a id="__codelineno-111-3" name="__codelineno-111-3" href="#__codelineno-111-3"></a><span class="s">kind: CustomResourceDefinition</span>
<a id="__codelineno-111-4" name="__codelineno-111-4" href="#__codelineno-111-4"></a><span class="s">metadata:</span>
<a id="__codelineno-111-5" name="__codelineno-111-5" href="#__codelineno-111-5"></a><span class="s">  # name must match the spec fields below, and be in the form: &lt;plural&gt;.&lt;group&gt;</span>
<a id="__codelineno-111-6" name="__codelineno-111-6" href="#__codelineno-111-6"></a><span class="s">  name: crontabs.stable.example.com</span>
<a id="__codelineno-111-7" name="__codelineno-111-7" href="#__codelineno-111-7"></a><span class="s">spec:</span>
<a id="__codelineno-111-8" name="__codelineno-111-8" href="#__codelineno-111-8"></a><span class="s">  # group name to use for REST API: /apis/&lt;group&gt;/&lt;version&gt;</span>
<a id="__codelineno-111-9" name="__codelineno-111-9" href="#__codelineno-111-9"></a><span class="s">  group: stable.example.com</span>
<a id="__codelineno-111-10" name="__codelineno-111-10" href="#__codelineno-111-10"></a><span class="s">  # list of versions supported by this CustomResourceDefinition</span>
<a id="__codelineno-111-11" name="__codelineno-111-11" href="#__codelineno-111-11"></a><span class="s">  versions:</span>
<a id="__codelineno-111-12" name="__codelineno-111-12" href="#__codelineno-111-12"></a><span class="s">    - name: v1</span>
<a id="__codelineno-111-13" name="__codelineno-111-13" href="#__codelineno-111-13"></a><span class="s">      # Each version can be enabled/disabled by Served flag.</span>
<a id="__codelineno-111-14" name="__codelineno-111-14" href="#__codelineno-111-14"></a><span class="s">      served: true</span>
<a id="__codelineno-111-15" name="__codelineno-111-15" href="#__codelineno-111-15"></a><span class="s">      # One and only one version must be marked as the storage version.</span>
<a id="__codelineno-111-16" name="__codelineno-111-16" href="#__codelineno-111-16"></a><span class="s">      storage: true</span>
<a id="__codelineno-111-17" name="__codelineno-111-17" href="#__codelineno-111-17"></a><span class="s">      schema:</span>
<a id="__codelineno-111-18" name="__codelineno-111-18" href="#__codelineno-111-18"></a><span class="s">        openAPIV3Schema:</span>
<a id="__codelineno-111-19" name="__codelineno-111-19" href="#__codelineno-111-19"></a><span class="s">          type: object</span>
<a id="__codelineno-111-20" name="__codelineno-111-20" href="#__codelineno-111-20"></a><span class="s">          properties:</span>
<a id="__codelineno-111-21" name="__codelineno-111-21" href="#__codelineno-111-21"></a><span class="s">            spec:</span>
<a id="__codelineno-111-22" name="__codelineno-111-22" href="#__codelineno-111-22"></a><span class="s">              type: object</span>
<a id="__codelineno-111-23" name="__codelineno-111-23" href="#__codelineno-111-23"></a><span class="s">              properties:</span>
<a id="__codelineno-111-24" name="__codelineno-111-24" href="#__codelineno-111-24"></a><span class="s">                cronSpec:</span>
<a id="__codelineno-111-25" name="__codelineno-111-25" href="#__codelineno-111-25"></a><span class="s">                  type: string</span>
<a id="__codelineno-111-26" name="__codelineno-111-26" href="#__codelineno-111-26"></a><span class="s">                image:</span>
<a id="__codelineno-111-27" name="__codelineno-111-27" href="#__codelineno-111-27"></a><span class="s">                  type: string</span>
<a id="__codelineno-111-28" name="__codelineno-111-28" href="#__codelineno-111-28"></a><span class="s">                replicas:</span>
<a id="__codelineno-111-29" name="__codelineno-111-29" href="#__codelineno-111-29"></a><span class="s">                  type: integer</span>
<a id="__codelineno-111-30" name="__codelineno-111-30" href="#__codelineno-111-30"></a><span class="s">  # either Namespaced or Cluster</span>
<a id="__codelineno-111-31" name="__codelineno-111-31" href="#__codelineno-111-31"></a><span class="s">  scope: Namespaced</span>
<a id="__codelineno-111-32" name="__codelineno-111-32" href="#__codelineno-111-32"></a><span class="s">  names:</span>
<a id="__codelineno-111-33" name="__codelineno-111-33" href="#__codelineno-111-33"></a><span class="s">    # plural name to be used in the URL: /apis/&lt;group&gt;/&lt;version&gt;/&lt;plural&gt;</span>
<a id="__codelineno-111-34" name="__codelineno-111-34" href="#__codelineno-111-34"></a><span class="s">    plural: crontabs</span>
<a id="__codelineno-111-35" name="__codelineno-111-35" href="#__codelineno-111-35"></a><span class="s">    # singular name to be used as an alias on the CLI and for display</span>
<a id="__codelineno-111-36" name="__codelineno-111-36" href="#__codelineno-111-36"></a><span class="s">    singular: crontab</span>
<a id="__codelineno-111-37" name="__codelineno-111-37" href="#__codelineno-111-37"></a><span class="s">    # kind is normally the CamelCased singular type. Your resource manifests use this.</span>
<a id="__codelineno-111-38" name="__codelineno-111-38" href="#__codelineno-111-38"></a><span class="s">    kind: CronTab</span>
<a id="__codelineno-111-39" name="__codelineno-111-39" href="#__codelineno-111-39"></a><span class="s">    # shortNames allow shorter string to match your resource on the CLI</span>
<a id="__codelineno-111-40" name="__codelineno-111-40" href="#__codelineno-111-40"></a><span class="s">    shortNames:</span>
<a id="__codelineno-111-41" name="__codelineno-111-41" href="#__codelineno-111-41"></a><span class="s">    - ct</span>
<a id="__codelineno-111-42" name="__codelineno-111-42" href="#__codelineno-111-42"></a><span class="s">    categories:</span>
<a id="__codelineno-111-43" name="__codelineno-111-43" href="#__codelineno-111-43"></a><span class="s">    - all</span>
<a id="__codelineno-111-44" name="__codelineno-111-44" href="#__codelineno-111-44"></a><span class="s">EOF</span>
</code></pre></div>
<p>Next, use the following command to wait for the apiserver to process
that definition.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-112-1" name="__codelineno-112-1" href="#__codelineno-112-1"></a>kubectl<span class="w"> </span>--kubeconfig<span class="w"> </span><span class="nv">$wmw_s_space_config</span><span class="w"> </span><span class="nb">wait</span><span class="w"> </span>--for<span class="w"> </span><span class="nv">condition</span><span class="o">=</span>Established<span class="w"> </span>crd<span class="w"> </span>crontabs.stable.example.com
</code></pre></div>
<p>Next, use <code>kubectl</code> to create the following workload objects in that
workspace. The <code>APIService</code> object included here does not contribute
to the httpd workload but is here to demonstrate that <code>APIService</code>
objects can be downsynced.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-113-1" name="__codelineno-113-1" href="#__codelineno-113-1"></a>kubectl<span class="w"> </span>--kubeconfig<span class="w"> </span><span class="nv">$wmw_s_space_config</span><span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>-<span class="w"> </span><span class="s">&lt;&lt;EOF</span>
<a id="__codelineno-113-2" name="__codelineno-113-2" href="#__codelineno-113-2"></a><span class="s">apiVersion: v1</span>
<a id="__codelineno-113-3" name="__codelineno-113-3" href="#__codelineno-113-3"></a><span class="s">kind: Namespace</span>
<a id="__codelineno-113-4" name="__codelineno-113-4" href="#__codelineno-113-4"></a><span class="s">metadata:</span>
<a id="__codelineno-113-5" name="__codelineno-113-5" href="#__codelineno-113-5"></a><span class="s">  name: specialstuff</span>
<a id="__codelineno-113-6" name="__codelineno-113-6" href="#__codelineno-113-6"></a><span class="s">  labels: {special: &quot;yes&quot;}</span>
<a id="__codelineno-113-7" name="__codelineno-113-7" href="#__codelineno-113-7"></a><span class="s">  annotations: {just-for: fun}</span>
<a id="__codelineno-113-8" name="__codelineno-113-8" href="#__codelineno-113-8"></a><span class="s">---</span>
<a id="__codelineno-113-9" name="__codelineno-113-9" href="#__codelineno-113-9"></a><span class="s">apiVersion: &quot;stable.example.com/v1&quot;</span>
<a id="__codelineno-113-10" name="__codelineno-113-10" href="#__codelineno-113-10"></a><span class="s">kind: CronTab</span>
<a id="__codelineno-113-11" name="__codelineno-113-11" href="#__codelineno-113-11"></a><span class="s">metadata:</span>
<a id="__codelineno-113-12" name="__codelineno-113-12" href="#__codelineno-113-12"></a><span class="s">  name: my-new-cron-object</span>
<a id="__codelineno-113-13" name="__codelineno-113-13" href="#__codelineno-113-13"></a><span class="s">  namespace: specialstuff</span>
<a id="__codelineno-113-14" name="__codelineno-113-14" href="#__codelineno-113-14"></a><span class="s">spec:</span>
<a id="__codelineno-113-15" name="__codelineno-113-15" href="#__codelineno-113-15"></a><span class="s">  cronSpec: &quot;* * * * */5&quot;</span>
<a id="__codelineno-113-16" name="__codelineno-113-16" href="#__codelineno-113-16"></a><span class="s">  image: my-awesome-cron-image</span>
<a id="__codelineno-113-17" name="__codelineno-113-17" href="#__codelineno-113-17"></a><span class="s">---</span>
<a id="__codelineno-113-18" name="__codelineno-113-18" href="#__codelineno-113-18"></a><span class="s">apiVersion: v1</span>
<a id="__codelineno-113-19" name="__codelineno-113-19" href="#__codelineno-113-19"></a><span class="s">kind: ConfigMap</span>
<a id="__codelineno-113-20" name="__codelineno-113-20" href="#__codelineno-113-20"></a><span class="s">metadata:</span>
<a id="__codelineno-113-21" name="__codelineno-113-21" href="#__codelineno-113-21"></a><span class="s">  namespace: specialstuff</span>
<a id="__codelineno-113-22" name="__codelineno-113-22" href="#__codelineno-113-22"></a><span class="s">  name: httpd-htdocs</span>
<a id="__codelineno-113-23" name="__codelineno-113-23" href="#__codelineno-113-23"></a><span class="s">  annotations:</span>
<a id="__codelineno-113-24" name="__codelineno-113-24" href="#__codelineno-113-24"></a><span class="s">    edge.kubestellar.io/expand-parameters: &quot;true&quot;</span>
<a id="__codelineno-113-25" name="__codelineno-113-25" href="#__codelineno-113-25"></a><span class="s">data:</span>
<a id="__codelineno-113-26" name="__codelineno-113-26" href="#__codelineno-113-26"></a><span class="s">  index.html: |</span>
<a id="__codelineno-113-27" name="__codelineno-113-27" href="#__codelineno-113-27"></a><span class="s">    &lt;!DOCTYPE html&gt;</span>
<a id="__codelineno-113-28" name="__codelineno-113-28" href="#__codelineno-113-28"></a><span class="s">    &lt;html&gt;</span>
<a id="__codelineno-113-29" name="__codelineno-113-29" href="#__codelineno-113-29"></a><span class="s">      &lt;body&gt;</span>
<a id="__codelineno-113-30" name="__codelineno-113-30" href="#__codelineno-113-30"></a><span class="s">        This is a special web site.</span>
<a id="__codelineno-113-31" name="__codelineno-113-31" href="#__codelineno-113-31"></a><span class="s">        Running in %(loc-name).</span>
<a id="__codelineno-113-32" name="__codelineno-113-32" href="#__codelineno-113-32"></a><span class="s">      &lt;/body&gt;</span>
<a id="__codelineno-113-33" name="__codelineno-113-33" href="#__codelineno-113-33"></a><span class="s">    &lt;/html&gt;</span>
<a id="__codelineno-113-34" name="__codelineno-113-34" href="#__codelineno-113-34"></a><span class="s">---</span>
<a id="__codelineno-113-35" name="__codelineno-113-35" href="#__codelineno-113-35"></a><span class="s">apiVersion: edge.kubestellar.io/v2alpha1</span>
<a id="__codelineno-113-36" name="__codelineno-113-36" href="#__codelineno-113-36"></a><span class="s">kind: Customizer</span>
<a id="__codelineno-113-37" name="__codelineno-113-37" href="#__codelineno-113-37"></a><span class="s">metadata:</span>
<a id="__codelineno-113-38" name="__codelineno-113-38" href="#__codelineno-113-38"></a><span class="s">  namespace: specialstuff</span>
<a id="__codelineno-113-39" name="__codelineno-113-39" href="#__codelineno-113-39"></a><span class="s">  name: example-customizer</span>
<a id="__codelineno-113-40" name="__codelineno-113-40" href="#__codelineno-113-40"></a><span class="s">  annotations:</span>
<a id="__codelineno-113-41" name="__codelineno-113-41" href="#__codelineno-113-41"></a><span class="s">    edge.kubestellar.io/expand-parameters: &quot;true&quot;</span>
<a id="__codelineno-113-42" name="__codelineno-113-42" href="#__codelineno-113-42"></a><span class="s">replacements:</span>
<a id="__codelineno-113-43" name="__codelineno-113-43" href="#__codelineno-113-43"></a><span class="s">- path: &quot;$.spec.template.spec.containers.0.env.0.value&quot;</span>
<a id="__codelineno-113-44" name="__codelineno-113-44" href="#__codelineno-113-44"></a><span class="s">  value: &#39;&quot;in %(env) env&quot;&#39;</span>
<a id="__codelineno-113-45" name="__codelineno-113-45" href="#__codelineno-113-45"></a><span class="s">---</span>
<a id="__codelineno-113-46" name="__codelineno-113-46" href="#__codelineno-113-46"></a><span class="s">apiVersion: apps/v1</span>
<a id="__codelineno-113-47" name="__codelineno-113-47" href="#__codelineno-113-47"></a><span class="s">kind: Deployment</span>
<a id="__codelineno-113-48" name="__codelineno-113-48" href="#__codelineno-113-48"></a><span class="s">metadata:</span>
<a id="__codelineno-113-49" name="__codelineno-113-49" href="#__codelineno-113-49"></a><span class="s">  namespace: specialstuff</span>
<a id="__codelineno-113-50" name="__codelineno-113-50" href="#__codelineno-113-50"></a><span class="s">  name: speciald</span>
<a id="__codelineno-113-51" name="__codelineno-113-51" href="#__codelineno-113-51"></a><span class="s">  annotations:</span>
<a id="__codelineno-113-52" name="__codelineno-113-52" href="#__codelineno-113-52"></a><span class="s">    edge.kubestellar.io/customizer: example-customizer</span>
<a id="__codelineno-113-53" name="__codelineno-113-53" href="#__codelineno-113-53"></a><span class="s">spec:</span>
<a id="__codelineno-113-54" name="__codelineno-113-54" href="#__codelineno-113-54"></a><span class="s">  selector: {matchLabels: {app: special} }</span>
<a id="__codelineno-113-55" name="__codelineno-113-55" href="#__codelineno-113-55"></a><span class="s">  template:</span>
<a id="__codelineno-113-56" name="__codelineno-113-56" href="#__codelineno-113-56"></a><span class="s">    metadata:</span>
<a id="__codelineno-113-57" name="__codelineno-113-57" href="#__codelineno-113-57"></a><span class="s">      labels: {app: special}</span>
<a id="__codelineno-113-58" name="__codelineno-113-58" href="#__codelineno-113-58"></a><span class="s">    spec:</span>
<a id="__codelineno-113-59" name="__codelineno-113-59" href="#__codelineno-113-59"></a><span class="s">      containers:</span>
<a id="__codelineno-113-60" name="__codelineno-113-60" href="#__codelineno-113-60"></a><span class="s">      - name: httpd</span>
<a id="__codelineno-113-61" name="__codelineno-113-61" href="#__codelineno-113-61"></a><span class="s">        env:</span>
<a id="__codelineno-113-62" name="__codelineno-113-62" href="#__codelineno-113-62"></a><span class="s">        - name: EXAMPLE_VAR</span>
<a id="__codelineno-113-63" name="__codelineno-113-63" href="#__codelineno-113-63"></a><span class="s">          value: example value</span>
<a id="__codelineno-113-64" name="__codelineno-113-64" href="#__codelineno-113-64"></a><span class="s">        image: library/httpd:2.4</span>
<a id="__codelineno-113-65" name="__codelineno-113-65" href="#__codelineno-113-65"></a><span class="s">        ports:</span>
<a id="__codelineno-113-66" name="__codelineno-113-66" href="#__codelineno-113-66"></a><span class="s">        - name: http</span>
<a id="__codelineno-113-67" name="__codelineno-113-67" href="#__codelineno-113-67"></a><span class="s">          containerPort: 80</span>
<a id="__codelineno-113-68" name="__codelineno-113-68" href="#__codelineno-113-68"></a><span class="s">          hostPort: 8082</span>
<a id="__codelineno-113-69" name="__codelineno-113-69" href="#__codelineno-113-69"></a><span class="s">          protocol: TCP</span>
<a id="__codelineno-113-70" name="__codelineno-113-70" href="#__codelineno-113-70"></a><span class="s">        volumeMounts:</span>
<a id="__codelineno-113-71" name="__codelineno-113-71" href="#__codelineno-113-71"></a><span class="s">        - name: htdocs</span>
<a id="__codelineno-113-72" name="__codelineno-113-72" href="#__codelineno-113-72"></a><span class="s">          readOnly: true</span>
<a id="__codelineno-113-73" name="__codelineno-113-73" href="#__codelineno-113-73"></a><span class="s">          mountPath: /usr/local/apache2/htdocs</span>
<a id="__codelineno-113-74" name="__codelineno-113-74" href="#__codelineno-113-74"></a><span class="s">      volumes:</span>
<a id="__codelineno-113-75" name="__codelineno-113-75" href="#__codelineno-113-75"></a><span class="s">      - name: htdocs</span>
<a id="__codelineno-113-76" name="__codelineno-113-76" href="#__codelineno-113-76"></a><span class="s">        configMap:</span>
<a id="__codelineno-113-77" name="__codelineno-113-77" href="#__codelineno-113-77"></a><span class="s">          name: httpd-htdocs</span>
<a id="__codelineno-113-78" name="__codelineno-113-78" href="#__codelineno-113-78"></a><span class="s">          optional: false</span>
<a id="__codelineno-113-79" name="__codelineno-113-79" href="#__codelineno-113-79"></a><span class="s">---</span>
<a id="__codelineno-113-80" name="__codelineno-113-80" href="#__codelineno-113-80"></a><span class="s">apiVersion: apiregistration.k8s.io/v1</span>
<a id="__codelineno-113-81" name="__codelineno-113-81" href="#__codelineno-113-81"></a><span class="s">kind: APIService</span>
<a id="__codelineno-113-82" name="__codelineno-113-82" href="#__codelineno-113-82"></a><span class="s">metadata:</span>
<a id="__codelineno-113-83" name="__codelineno-113-83" href="#__codelineno-113-83"></a><span class="s">  name: v1090.example.my</span>
<a id="__codelineno-113-84" name="__codelineno-113-84" href="#__codelineno-113-84"></a><span class="s">spec:</span>
<a id="__codelineno-113-85" name="__codelineno-113-85" href="#__codelineno-113-85"></a><span class="s">  group: example.my</span>
<a id="__codelineno-113-86" name="__codelineno-113-86" href="#__codelineno-113-86"></a><span class="s">  groupPriorityMinimum: 360</span>
<a id="__codelineno-113-87" name="__codelineno-113-87" href="#__codelineno-113-87"></a><span class="s">  service:</span>
<a id="__codelineno-113-88" name="__codelineno-113-88" href="#__codelineno-113-88"></a><span class="s">    name: my-service</span>
<a id="__codelineno-113-89" name="__codelineno-113-89" href="#__codelineno-113-89"></a><span class="s">    namespace: my-example</span>
<a id="__codelineno-113-90" name="__codelineno-113-90" href="#__codelineno-113-90"></a><span class="s">  version: v1090</span>
<a id="__codelineno-113-91" name="__codelineno-113-91" href="#__codelineno-113-91"></a><span class="s">  versionPriority: 42</span>
<a id="__codelineno-113-92" name="__codelineno-113-92" href="#__codelineno-113-92"></a><span class="s">EOF</span>
</code></pre></div>
<p>Finally, use <code>kubectl</code> to create the following EdgePlacement object.
Its "where predicate" (the <code>locationSelectors</code> array) has one label
selector that matches only one of the Location objects created
earlier, thus directing the special workload to just one edge cluster.</p>
<p>The "what predicate" explicitly includes the <code>Namespace</code> object named
"specialstuff", which causes all of its desired state (including
labels and annotations) to be downsynced. This contrasts with the
common EdgePlacement, which does not explicitly mention the
<code>commonstuff</code> namespace, relying on the implicit creation of
namespaces as needed in the WECs.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-114-1" name="__codelineno-114-1" href="#__codelineno-114-1"></a>kubectl<span class="w"> </span>--kubeconfig<span class="w"> </span><span class="nv">$wmw_s_space_config</span><span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>-<span class="w"> </span><span class="s">&lt;&lt;EOF</span>
<a id="__codelineno-114-2" name="__codelineno-114-2" href="#__codelineno-114-2"></a><span class="s">apiVersion: edge.kubestellar.io/v2alpha1</span>
<a id="__codelineno-114-3" name="__codelineno-114-3" href="#__codelineno-114-3"></a><span class="s">kind: EdgePlacement</span>
<a id="__codelineno-114-4" name="__codelineno-114-4" href="#__codelineno-114-4"></a><span class="s">metadata:</span>
<a id="__codelineno-114-5" name="__codelineno-114-5" href="#__codelineno-114-5"></a><span class="s">  name: edge-placement-s</span>
<a id="__codelineno-114-6" name="__codelineno-114-6" href="#__codelineno-114-6"></a><span class="s">spec:</span>
<a id="__codelineno-114-7" name="__codelineno-114-7" href="#__codelineno-114-7"></a><span class="s">  locationSelectors:</span>
<a id="__codelineno-114-8" name="__codelineno-114-8" href="#__codelineno-114-8"></a><span class="s">  - matchLabels: {&quot;env&quot;:&quot;prod&quot;,&quot;extended&quot;:&quot;yes&quot;}</span>
<a id="__codelineno-114-9" name="__codelineno-114-9" href="#__codelineno-114-9"></a><span class="s">  downsync:</span>
<a id="__codelineno-114-10" name="__codelineno-114-10" href="#__codelineno-114-10"></a><span class="s">  - apiGroup: &quot;&quot;</span>
<a id="__codelineno-114-11" name="__codelineno-114-11" href="#__codelineno-114-11"></a><span class="s">    resources: [ configmaps ]</span>
<a id="__codelineno-114-12" name="__codelineno-114-12" href="#__codelineno-114-12"></a><span class="s">    namespaceSelectors:</span>
<a id="__codelineno-114-13" name="__codelineno-114-13" href="#__codelineno-114-13"></a><span class="s">    - matchLabels: {&quot;special&quot;:&quot;yes&quot;}</span>
<a id="__codelineno-114-14" name="__codelineno-114-14" href="#__codelineno-114-14"></a><span class="s">  - apiGroup: apps</span>
<a id="__codelineno-114-15" name="__codelineno-114-15" href="#__codelineno-114-15"></a><span class="s">    resources: [ deployments ]</span>
<a id="__codelineno-114-16" name="__codelineno-114-16" href="#__codelineno-114-16"></a><span class="s">    namespaceSelectors:</span>
<a id="__codelineno-114-17" name="__codelineno-114-17" href="#__codelineno-114-17"></a><span class="s">    - matchLabels: {&quot;special&quot;:&quot;yes&quot;}</span>
<a id="__codelineno-114-18" name="__codelineno-114-18" href="#__codelineno-114-18"></a><span class="s">    objectNames: [ speciald ]</span>
<a id="__codelineno-114-19" name="__codelineno-114-19" href="#__codelineno-114-19"></a><span class="s">  - apiGroup: apiregistration.k8s.io</span>
<a id="__codelineno-114-20" name="__codelineno-114-20" href="#__codelineno-114-20"></a><span class="s">    resources: [ apiservices ]</span>
<a id="__codelineno-114-21" name="__codelineno-114-21" href="#__codelineno-114-21"></a><span class="s">    objectNames: [ v1090.example.my ]</span>
<a id="__codelineno-114-22" name="__codelineno-114-22" href="#__codelineno-114-22"></a><span class="s">  - apiGroup: stable.example.com</span>
<a id="__codelineno-114-23" name="__codelineno-114-23" href="#__codelineno-114-23"></a><span class="s">    resources: [ crontabs ]</span>
<a id="__codelineno-114-24" name="__codelineno-114-24" href="#__codelineno-114-24"></a><span class="s">    namespaces: [ specialstuff ]</span>
<a id="__codelineno-114-25" name="__codelineno-114-25" href="#__codelineno-114-25"></a><span class="s">    objectNames: [ my-new-cron-object ]</span>
<a id="__codelineno-114-26" name="__codelineno-114-26" href="#__codelineno-114-26"></a><span class="s">  - apiGroup: &quot;&quot;</span>
<a id="__codelineno-114-27" name="__codelineno-114-27" href="#__codelineno-114-27"></a><span class="s">    resources: [ namespaces ]</span>
<a id="__codelineno-114-28" name="__codelineno-114-28" href="#__codelineno-114-28"></a><span class="s">    objectNames: [ specialstuff ]</span>
<a id="__codelineno-114-29" name="__codelineno-114-29" href="#__codelineno-114-29"></a><span class="s">  wantSingletonReportedState: true</span>
<a id="__codelineno-114-30" name="__codelineno-114-30" href="#__codelineno-114-30"></a><span class="s">  upsync:</span>
<a id="__codelineno-114-31" name="__codelineno-114-31" href="#__codelineno-114-31"></a><span class="s">  - apiGroup: &quot;group1.test&quot;</span>
<a id="__codelineno-114-32" name="__codelineno-114-32" href="#__codelineno-114-32"></a><span class="s">    resources: [&quot;sprockets&quot;, &quot;flanges&quot;]</span>
<a id="__codelineno-114-33" name="__codelineno-114-33" href="#__codelineno-114-33"></a><span class="s">    namespaces: [&quot;orbital&quot;]</span>
<a id="__codelineno-114-34" name="__codelineno-114-34" href="#__codelineno-114-34"></a><span class="s">    names: [&quot;george&quot;, &quot;cosmo&quot;]</span>
<a id="__codelineno-114-35" name="__codelineno-114-35" href="#__codelineno-114-35"></a><span class="s">  - apiGroup: &quot;group3.test&quot;</span>
<a id="__codelineno-114-36" name="__codelineno-114-36" href="#__codelineno-114-36"></a><span class="s">    resources: [&quot;widgets&quot;]</span>
<a id="__codelineno-114-37" name="__codelineno-114-37" href="#__codelineno-114-37"></a><span class="s">    names: [&quot;*&quot;]</span>
<a id="__codelineno-114-38" name="__codelineno-114-38" href="#__codelineno-114-38"></a><span class="s">EOF</span>
</code></pre></div>
<div class="hide-me highlight"><pre><span></span><code><a id="__codelineno-115-1" name="__codelineno-115-1" href="#__codelineno-115-1"></a>sleep<span class="w"> </span><span class="m">10</span>
</code></pre></div></p>
<h3 id="where-resolver">Where Resolver<a class="headerlink" href="#where-resolver" title="Permanent link">#</a></h3>
<p>In response to each EdgePlacement, the Where Resolver will create a
corresponding SinglePlacementSlice object.  These will indicate the
following resolutions of the "where" predicates.</p>
<table>
<thead>
<tr>
<th>EdgePlacement</th>
<th align="right">Resolved Where</th>
</tr>
</thead>
<tbody>
<tr>
<td>edge-placement-c</td>
<td align="right">florin, guilder</td>
</tr>
<tr>
<td>edge-placement-s</td>
<td align="right">guilder</td>
</tr>
</tbody>
</table>
<p>If you have deployed the KubeStellar core in a Kubernetes cluster then
the where resolver is running in a pod there. If instead you are
running the core controllers are bare processes then you can use the
following commands to launch the where-resolver; it requires the ESPW
to be the current kcp workspace at start time.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-116-1" name="__codelineno-116-1" href="#__codelineno-116-1"></a><span class="nv">espw_space_config</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span><span class="s2">/temp-space-config/spaceprovider-default-espw&quot;</span>
<a id="__codelineno-116-2" name="__codelineno-116-2" href="#__codelineno-116-2"></a>kubectl-kubestellar-get-config-for-space<span class="w"> </span>--space-name<span class="w"> </span>espw<span class="w"> </span>--provider-name<span class="w"> </span>default<span class="w"> </span>--sm-core-config<span class="w"> </span><span class="nv">$SM_CONFIG</span><span class="w"> </span>--space-config-file<span class="w"> </span><span class="nv">$espw_space_config</span>
<a id="__codelineno-116-3" name="__codelineno-116-3" href="#__codelineno-116-3"></a><span class="c1"># TODO: where-resolver needs access to multiple configs. Will remove when controllers support spaces.</span>
<a id="__codelineno-116-4" name="__codelineno-116-4" href="#__codelineno-116-4"></a>kubectl<span class="w"> </span>ws<span class="w"> </span>root:espw<span class="w"> </span>
<a id="__codelineno-116-5" name="__codelineno-116-5" href="#__codelineno-116-5"></a>kubestellar-where-resolver<span class="w"> </span>-v<span class="o">=</span><span class="m">4</span><span class="w"> </span><span class="p">&amp;</span>&gt;<span class="w"> </span>/tmp/where-resolver.log<span class="w"> </span><span class="p">&amp;</span>
<a id="__codelineno-116-6" name="__codelineno-116-6" href="#__codelineno-116-6"></a>sleep<span class="w"> </span><span class="m">10</span>
</code></pre></div>
<p>The following commands wait until the where-resolver has done its job
for the common and special <code>EdgePlacement</code> objects.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-117-1" name="__codelineno-117-1" href="#__codelineno-117-1"></a><span class="k">while</span><span class="w"> </span>!<span class="w"> </span>kubectl<span class="w"> </span>--kubeconfig<span class="w"> </span><span class="nv">$wmw_c_space_config</span><span class="w"> </span>get<span class="w"> </span>SinglePlacementSlice<span class="w"> </span><span class="p">&amp;</span>&gt;<span class="w"> </span>/dev/null<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<a id="__codelineno-117-2" name="__codelineno-117-2" href="#__codelineno-117-2"></a><span class="w">  </span>sleep<span class="w"> </span><span class="m">10</span>
<a id="__codelineno-117-3" name="__codelineno-117-3" href="#__codelineno-117-3"></a><span class="k">done</span>
<a id="__codelineno-117-4" name="__codelineno-117-4" href="#__codelineno-117-4"></a><span class="k">while</span><span class="w"> </span>!<span class="w"> </span>kubectl<span class="w"> </span>--kubeconfig<span class="w"> </span><span class="nv">$wmw_s_space_config</span><span class="w"> </span>get<span class="w"> </span>SinglePlacementSlice<span class="w"> </span><span class="p">&amp;</span>&gt;<span class="w"> </span>/dev/null<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<a id="__codelineno-117-5" name="__codelineno-117-5" href="#__codelineno-117-5"></a><span class="w">  </span>sleep<span class="w"> </span><span class="m">10</span>
<a id="__codelineno-117-6" name="__codelineno-117-6" href="#__codelineno-117-6"></a><span class="k">done</span>
</code></pre></div>
<p>If things are working properly then you will see log lines like the
following (among many others) in the where-resolver's log.</p>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-118-1" name="__codelineno-118-1" href="#__codelineno-118-1"></a>I0423<span class="w"> </span><span class="m">01</span>:33:37.036752<span class="w">   </span><span class="m">11305</span><span class="w"> </span>main.go:212<span class="o">]</span><span class="w"> </span><span class="s2">&quot;Found APIExport view&quot;</span><span class="w"> </span><span class="nv">exportName</span><span class="o">=</span><span class="s2">&quot;edge.kubestellar.io&quot;</span><span class="w"> </span><span class="nv">serverURL</span><span class="o">=</span><span class="s2">&quot;https://192.168.58.123:6443/services/apiexport/7qkse309upzrv0fy/edge.kubestellar.io&quot;</span>
<a id="__codelineno-118-2" name="__codelineno-118-2" href="#__codelineno-118-2"></a>...
<a id="__codelineno-118-3" name="__codelineno-118-3" href="#__codelineno-118-3"></a>I0423<span class="w"> </span><span class="m">01</span>:33:37.320859<span class="w">   </span><span class="m">11305</span><span class="w"> </span>reconcile_on_location.go:192<span class="o">]</span><span class="w"> </span><span class="s2">&quot;updated SinglePlacementSlice&quot;</span><span class="w"> </span><span class="nv">controller</span><span class="o">=</span><span class="s2">&quot;kubestellar-where-resolver&quot;</span><span class="w"> </span><span class="nv">triggeringKind</span><span class="o">=</span>Location<span class="w"> </span><span class="nv">key</span><span class="o">=</span><span class="s2">&quot;apmziqj9p9fqlflm|florin&quot;</span><span class="w"> </span><span class="nv">locationWorkspace</span><span class="o">=</span><span class="s2">&quot;apmziqj9p9fqlflm&quot;</span><span class="w"> </span><span class="nv">location</span><span class="o">=</span><span class="s2">&quot;florin&quot;</span><span class="w"> </span><span class="nv">workloadWorkspace</span><span class="o">=</span><span class="s2">&quot;10l175x6ejfjag3e&quot;</span><span class="w"> </span><span class="nv">singlePlacementSlice</span><span class="o">=</span><span class="s2">&quot;edge-placement-c&quot;</span>
<a id="__codelineno-118-4" name="__codelineno-118-4" href="#__codelineno-118-4"></a>...
<a id="__codelineno-118-5" name="__codelineno-118-5" href="#__codelineno-118-5"></a>I0423<span class="w"> </span><span class="m">01</span>:33:37.391772<span class="w">   </span><span class="m">11305</span><span class="w"> </span>reconcile_on_location.go:192<span class="o">]</span><span class="w"> </span><span class="s2">&quot;updated SinglePlacementSlice&quot;</span><span class="w"> </span><span class="nv">controller</span><span class="o">=</span><span class="s2">&quot;kubestellar-where-resolver&quot;</span><span class="w"> </span><span class="nv">triggeringKind</span><span class="o">=</span>Location<span class="w"> </span><span class="nv">key</span><span class="o">=</span><span class="s2">&quot;apmziqj9p9fqlflm|guilder&quot;</span><span class="w"> </span><span class="nv">locationWorkspace</span><span class="o">=</span><span class="s2">&quot;apmziqj9p9fqlflm&quot;</span><span class="w"> </span><span class="nv">location</span><span class="o">=</span><span class="s2">&quot;guilder&quot;</span><span class="w"> </span><span class="nv">workloadWorkspace</span><span class="o">=</span><span class="s2">&quot;10l175x6ejfjag3e&quot;</span><span class="w"> </span><span class="nv">singlePlacementSlice</span><span class="o">=</span><span class="s2">&quot;edge-placement-c&quot;</span>
</code></pre></div>
<p>Check out a SinglePlacementSlice object as follows.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-119-1" name="__codelineno-119-1" href="#__codelineno-119-1"></a>kubectl<span class="w"> </span>--kubeconfig<span class="w"> </span><span class="nv">$wmw_c_space_config</span><span class="w"> </span>get<span class="w"> </span>SinglePlacementSlice<span class="w"> </span>-o<span class="w"> </span>yaml
</code></pre></div>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-120-1" name="__codelineno-120-1" href="#__codelineno-120-1"></a>apiVersion:<span class="w"> </span>v1
<a id="__codelineno-120-2" name="__codelineno-120-2" href="#__codelineno-120-2"></a>items:
<a id="__codelineno-120-3" name="__codelineno-120-3" href="#__codelineno-120-3"></a>-<span class="w"> </span>apiVersion:<span class="w"> </span>edge.kubestellar.io/v2alpha1
<a id="__codelineno-120-4" name="__codelineno-120-4" href="#__codelineno-120-4"></a><span class="w">  </span>destinations:
<a id="__codelineno-120-5" name="__codelineno-120-5" href="#__codelineno-120-5"></a><span class="w">  </span>-<span class="w"> </span>cluster:<span class="w"> </span>apmziqj9p9fqlflm
<a id="__codelineno-120-6" name="__codelineno-120-6" href="#__codelineno-120-6"></a><span class="w">    </span>locationName:<span class="w"> </span>florin
<a id="__codelineno-120-7" name="__codelineno-120-7" href="#__codelineno-120-7"></a><span class="w">    </span>syncTargetName:<span class="w"> </span>florin
<a id="__codelineno-120-8" name="__codelineno-120-8" href="#__codelineno-120-8"></a><span class="w">    </span>syncTargetUID:<span class="w"> </span>b8c64c64-070c-435b-b3bd-9c0f0c040a54
<a id="__codelineno-120-9" name="__codelineno-120-9" href="#__codelineno-120-9"></a><span class="w">  </span>-<span class="w"> </span>cluster:<span class="w"> </span>apmziqj9p9fqlflm
<a id="__codelineno-120-10" name="__codelineno-120-10" href="#__codelineno-120-10"></a><span class="w">    </span>locationName:<span class="w"> </span>guilder
<a id="__codelineno-120-11" name="__codelineno-120-11" href="#__codelineno-120-11"></a><span class="w">    </span>syncTargetName:<span class="w"> </span>guilder
<a id="__codelineno-120-12" name="__codelineno-120-12" href="#__codelineno-120-12"></a><span class="w">    </span>syncTargetUID:<span class="w"> </span>bf452e1f-45a0-4d5d-b35c-ef1ece2879ba
<a id="__codelineno-120-13" name="__codelineno-120-13" href="#__codelineno-120-13"></a><span class="w">  </span>kind:<span class="w"> </span>SinglePlacementSlice
<a id="__codelineno-120-14" name="__codelineno-120-14" href="#__codelineno-120-14"></a><span class="w">  </span>metadata:
<a id="__codelineno-120-15" name="__codelineno-120-15" href="#__codelineno-120-15"></a><span class="w">    </span>annotations:
<a id="__codelineno-120-16" name="__codelineno-120-16" href="#__codelineno-120-16"></a><span class="w">      </span>kcp.io/cluster:<span class="w"> </span>10l175x6ejfjag3e
<a id="__codelineno-120-17" name="__codelineno-120-17" href="#__codelineno-120-17"></a><span class="w">    </span>creationTimestamp:<span class="w"> </span><span class="s2">&quot;2023-04-23T05:33:37Z&quot;</span>
<a id="__codelineno-120-18" name="__codelineno-120-18" href="#__codelineno-120-18"></a><span class="w">    </span>generation:<span class="w"> </span><span class="m">4</span>
<a id="__codelineno-120-19" name="__codelineno-120-19" href="#__codelineno-120-19"></a><span class="w">    </span>name:<span class="w"> </span>edge-placement-c
<a id="__codelineno-120-20" name="__codelineno-120-20" href="#__codelineno-120-20"></a><span class="w">    </span>ownerReferences:
<a id="__codelineno-120-21" name="__codelineno-120-21" href="#__codelineno-120-21"></a><span class="w">    </span>-<span class="w"> </span>apiVersion:<span class="w"> </span>edge.kubestellar.io/v2alpha1
<a id="__codelineno-120-22" name="__codelineno-120-22" href="#__codelineno-120-22"></a><span class="w">      </span>kind:<span class="w"> </span>EdgePlacement
<a id="__codelineno-120-23" name="__codelineno-120-23" href="#__codelineno-120-23"></a><span class="w">      </span>name:<span class="w"> </span>edge-placement-c
<a id="__codelineno-120-24" name="__codelineno-120-24" href="#__codelineno-120-24"></a><span class="w">      </span>uid:<span class="w"> </span>199cfe1e-48d9-4351-af5c-e66c83bf50dd
<a id="__codelineno-120-25" name="__codelineno-120-25" href="#__codelineno-120-25"></a><span class="w">    </span>resourceVersion:<span class="w"> </span><span class="s2">&quot;1316&quot;</span>
<a id="__codelineno-120-26" name="__codelineno-120-26" href="#__codelineno-120-26"></a><span class="w">    </span>uid:<span class="w"> </span>b5db1f9d-1aed-4a25-91da-26dfbb5d8879
<a id="__codelineno-120-27" name="__codelineno-120-27" href="#__codelineno-120-27"></a>kind:<span class="w"> </span>List
<a id="__codelineno-120-28" name="__codelineno-120-28" href="#__codelineno-120-28"></a>metadata:
<a id="__codelineno-120-29" name="__codelineno-120-29" href="#__codelineno-120-29"></a><span class="w">  </span>resourceVersion:<span class="w"> </span><span class="s2">&quot;&quot;</span>
</code></pre></div></p>
<p>Also check out the SinglePlacementSlice objects in
<code>root:wmw-s</code>.  It should go similarly, but the <code>destinations</code>
should include only the entry for guilder.</p>
<!-- END INCLUDE -->

<!-- BEGIN INCLUDE ./example1-stage-3.md '&lt;!--example1-stage-3-start--&gt;' '&lt;!--example1-stage-3-end--&gt;' -->

<h2 id="stage-3">Stage 3<a class="headerlink" href="#stage-3" title="Permanent link">#</a></h2>
<p><img alt="Placement translation" src="../Edge-PoC-2023q1-Scenario-1-stage-3.svg" title="Stage 3 summary" /></p>
<p>In Stage 3, in response to the EdgePlacement and SinglePlacementSlice
objects, the placement translator will copy the workload prescriptions
into the mailbox workspaces and create <code>SyncerConfig</code> objects there.</p>
<p>If you have deployed the KubeStellar core as workload in a Kubernetes
cluster then the placement translator is running in a Pod there. If
instead you are running the core controllers as bare processes then
use the following commands to launch the placement translator; it
requires the ESPW to be current at start time.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-121-1" name="__codelineno-121-1" href="#__codelineno-121-1"></a><span class="c1"># TODO: placement-translator needs access to multiple configs. Will remove when controllers support spaces.</span>
<a id="__codelineno-121-2" name="__codelineno-121-2" href="#__codelineno-121-2"></a>kubectl<span class="w"> </span>ws<span class="w"> </span>root:espw
<a id="__codelineno-121-3" name="__codelineno-121-3" href="#__codelineno-121-3"></a>placement-translator<span class="w"> </span>-v<span class="o">=</span><span class="m">4</span><span class="w"> </span><span class="p">&amp;</span>&gt;<span class="w"> </span>/tmp/placement-translator.log<span class="w"> </span><span class="p">&amp;</span>
<a id="__codelineno-121-4" name="__codelineno-121-4" href="#__codelineno-121-4"></a>sleep<span class="w"> </span><span class="m">10</span>
</code></pre></div>
<p>The following commands wait for the placement translator to get its
job done for this example.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-122-1" name="__codelineno-122-1" href="#__codelineno-122-1"></a><span class="c1"># TODO: unfortunately, the $FLORIN_WS and $GUILDER_WS are mailbox ws names that we are not supporting in the space framework yet</span>
<a id="__codelineno-122-2" name="__codelineno-122-2" href="#__codelineno-122-2"></a><span class="c1"># wait until SyncerConfig, ReplicaSets and Deployments are ready</span>
<a id="__codelineno-122-3" name="__codelineno-122-3" href="#__codelineno-122-3"></a><span class="nv">mbxws</span><span class="o">=(</span><span class="nv">$FLORIN_WS</span><span class="w"> </span><span class="nv">$GUILDER_WS</span><span class="o">)</span>
<a id="__codelineno-122-4" name="__codelineno-122-4" href="#__codelineno-122-4"></a><span class="k">for</span><span class="w"> </span>ii<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">mbxws</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<a id="__codelineno-122-5" name="__codelineno-122-5" href="#__codelineno-122-5"></a><span class="w">  </span>kubectl<span class="w"> </span>ws<span class="w"> </span>root:<span class="nv">$ii</span>
<a id="__codelineno-122-6" name="__codelineno-122-6" href="#__codelineno-122-6"></a><span class="w">  </span><span class="c1"># wait for SyncerConfig resource</span>
<a id="__codelineno-122-7" name="__codelineno-122-7" href="#__codelineno-122-7"></a><span class="w">  </span><span class="k">while</span><span class="w"> </span>!<span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>SyncerConfig<span class="w"> </span>the-one<span class="w"> </span><span class="p">&amp;</span>&gt;<span class="w"> </span>/dev/null<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<a id="__codelineno-122-8" name="__codelineno-122-8" href="#__codelineno-122-8"></a><span class="w">    </span>sleep<span class="w"> </span><span class="m">10</span>
<a id="__codelineno-122-9" name="__codelineno-122-9" href="#__codelineno-122-9"></a><span class="w">  </span><span class="k">done</span>
<a id="__codelineno-122-10" name="__codelineno-122-10" href="#__codelineno-122-10"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;* SyncerConfig resource exists in mailbox </span><span class="nv">$ii</span><span class="s2">&quot;</span>
<a id="__codelineno-122-11" name="__codelineno-122-11" href="#__codelineno-122-11"></a><span class="w">  </span><span class="c1"># wait for ReplicaSet resource</span>
<a id="__codelineno-122-12" name="__codelineno-122-12" href="#__codelineno-122-12"></a><span class="w">  </span><span class="k">while</span><span class="w"> </span>!<span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>rs<span class="w"> </span><span class="p">&amp;</span>&gt;<span class="w"> </span>/dev/null<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<a id="__codelineno-122-13" name="__codelineno-122-13" href="#__codelineno-122-13"></a><span class="w">    </span>sleep<span class="w"> </span><span class="m">10</span>
<a id="__codelineno-122-14" name="__codelineno-122-14" href="#__codelineno-122-14"></a><span class="w">  </span><span class="k">done</span>
<a id="__codelineno-122-15" name="__codelineno-122-15" href="#__codelineno-122-15"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;* ReplicaSet resource exists in mailbox </span><span class="nv">$ii</span><span class="s2">&quot;</span>
<a id="__codelineno-122-16" name="__codelineno-122-16" href="#__codelineno-122-16"></a><span class="w">  </span><span class="c1"># wait until ReplicaSet in mailbox</span>
<a id="__codelineno-122-17" name="__codelineno-122-17" href="#__codelineno-122-17"></a><span class="w">  </span><span class="k">while</span><span class="w"> </span>!<span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>rs<span class="w"> </span>-n<span class="w"> </span>commonstuff<span class="w"> </span>commond<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<a id="__codelineno-122-18" name="__codelineno-122-18" href="#__codelineno-122-18"></a><span class="w">    </span>sleep<span class="w"> </span><span class="m">10</span>
<a id="__codelineno-122-19" name="__codelineno-122-19" href="#__codelineno-122-19"></a><span class="w">  </span><span class="k">done</span>
<a id="__codelineno-122-20" name="__codelineno-122-20" href="#__codelineno-122-20"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;* commonstuff ReplicaSet in mailbox </span><span class="nv">$ii</span><span class="s2">&quot;</span>
<a id="__codelineno-122-21" name="__codelineno-122-21" href="#__codelineno-122-21"></a><span class="k">done</span>
<a id="__codelineno-122-22" name="__codelineno-122-22" href="#__codelineno-122-22"></a><span class="c1"># check for deployment in guilder</span>
<a id="__codelineno-122-23" name="__codelineno-122-23" href="#__codelineno-122-23"></a><span class="k">while</span><span class="w"> </span>!<span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>deploy<span class="w"> </span>-A<span class="w"> </span><span class="p">&amp;</span>&gt;<span class="w"> </span>/dev/null<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<a id="__codelineno-122-24" name="__codelineno-122-24" href="#__codelineno-122-24"></a><span class="w">  </span>sleep<span class="w"> </span><span class="m">10</span>
<a id="__codelineno-122-25" name="__codelineno-122-25" href="#__codelineno-122-25"></a><span class="k">done</span>
<a id="__codelineno-122-26" name="__codelineno-122-26" href="#__codelineno-122-26"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;* Deployment resource exists&quot;</span>
<a id="__codelineno-122-27" name="__codelineno-122-27" href="#__codelineno-122-27"></a><span class="k">while</span><span class="w"> </span>!<span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>deploy<span class="w"> </span>-n<span class="w"> </span>specialstuff<span class="w"> </span>speciald<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<a id="__codelineno-122-28" name="__codelineno-122-28" href="#__codelineno-122-28"></a><span class="w">  </span>sleep<span class="w"> </span><span class="m">10</span>
<a id="__codelineno-122-29" name="__codelineno-122-29" href="#__codelineno-122-29"></a><span class="k">done</span>
<a id="__codelineno-122-30" name="__codelineno-122-30" href="#__codelineno-122-30"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;* specialstuff Deployment in its mailbox&quot;</span>
<a id="__codelineno-122-31" name="__codelineno-122-31" href="#__codelineno-122-31"></a><span class="c1"># wait for crontab CRD to be established</span>
<a id="__codelineno-122-32" name="__codelineno-122-32" href="#__codelineno-122-32"></a><span class="k">while</span><span class="w"> </span>!<span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>crd<span class="w"> </span>crontabs.stable.example.com<span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span>sleep<span class="w"> </span><span class="m">10</span><span class="p">;</span><span class="w"> </span><span class="k">done</span>
<a id="__codelineno-122-33" name="__codelineno-122-33" href="#__codelineno-122-33"></a>kubectl<span class="w"> </span><span class="nb">wait</span><span class="w"> </span>--for<span class="w"> </span><span class="nv">condition</span><span class="o">=</span>Established<span class="w"> </span>crd<span class="w"> </span>crontabs.stable.example.com
<a id="__codelineno-122-34" name="__codelineno-122-34" href="#__codelineno-122-34"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;* CronTab CRD is established in its mailbox&quot;</span>
<a id="__codelineno-122-35" name="__codelineno-122-35" href="#__codelineno-122-35"></a><span class="c1"># wait for my-new-cron-object to be in its mailbox</span>
<a id="__codelineno-122-36" name="__codelineno-122-36" href="#__codelineno-122-36"></a><span class="k">while</span><span class="w"> </span>!<span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>ct<span class="w"> </span>-n<span class="w"> </span>specialstuff<span class="w"> </span>my-new-cron-object<span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span>sleep<span class="w"> </span><span class="m">10</span><span class="p">;</span><span class="w"> </span><span class="k">done</span>
<a id="__codelineno-122-37" name="__codelineno-122-37" href="#__codelineno-122-37"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;* CronTab my-new-cron-object is in its mailbox&quot;</span>
</code></pre></div>
<p>You can check that the common workload's ReplicaSet objects got to
their mailbox workspaces with the following command. It will list the
two copies of that object, each with an annotation whose key is
<code>kcp.io/cluster</code> and whose value is the kcp <code>logicalcluster.Name</code> of
the mailbox workspace; those names appear in the "CLUSTER" column of
the custom-columns listing near the end of <a href="./#the-mailbox-controller">the section above about
the mailbox controller</a>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-123-1" name="__codelineno-123-1" href="#__codelineno-123-1"></a><span class="c1"># TODO: kubestellar-list-syncing-objects has kcp dependencies. Will remove when controllers support spaces.</span>
<a id="__codelineno-123-2" name="__codelineno-123-2" href="#__codelineno-123-2"></a>kubestellar-list-syncing-objects<span class="w"> </span>--api-group<span class="w"> </span>apps<span class="w"> </span>--api-kind<span class="w"> </span>ReplicaSet
</code></pre></div>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-124-1" name="__codelineno-124-1" href="#__codelineno-124-1"></a>---
<a id="__codelineno-124-2" name="__codelineno-124-2" href="#__codelineno-124-2"></a>apiVersion:<span class="w"> </span>apps/v1
<a id="__codelineno-124-3" name="__codelineno-124-3" href="#__codelineno-124-3"></a>kind:<span class="w"> </span>ReplicaSet
<a id="__codelineno-124-4" name="__codelineno-124-4" href="#__codelineno-124-4"></a>metadata:
<a id="__codelineno-124-5" name="__codelineno-124-5" href="#__codelineno-124-5"></a><span class="w">  </span>annotations:
<a id="__codelineno-124-6" name="__codelineno-124-6" href="#__codelineno-124-6"></a><span class="w">    </span>edge.kubestellar.io/customizer:<span class="w"> </span>example-customizer
<a id="__codelineno-124-7" name="__codelineno-124-7" href="#__codelineno-124-7"></a><span class="w">    </span>kcp.io/cluster:<span class="w"> </span>1y7wll1dz806h3sb
<a id="__codelineno-124-8" name="__codelineno-124-8" href="#__codelineno-124-8"></a><span class="w">    </span>...<span class="w"> </span><span class="o">(</span>lots<span class="w"> </span>of<span class="w"> </span>other<span class="w"> </span>details<span class="o">)</span><span class="w"> </span>...
<a id="__codelineno-124-9" name="__codelineno-124-9" href="#__codelineno-124-9"></a><span class="w">  </span>name:<span class="w"> </span>commond
<a id="__codelineno-124-10" name="__codelineno-124-10" href="#__codelineno-124-10"></a><span class="w">  </span>namespace:<span class="w"> </span>commonstuff
<a id="__codelineno-124-11" name="__codelineno-124-11" href="#__codelineno-124-11"></a>spec:
<a id="__codelineno-124-12" name="__codelineno-124-12" href="#__codelineno-124-12"></a><span class="w">  </span>...<span class="w"> </span><span class="o">(</span>the<span class="w"> </span>customized<span class="w"> </span>spec<span class="o">)</span><span class="w"> </span>...
<a id="__codelineno-124-13" name="__codelineno-124-13" href="#__codelineno-124-13"></a>status:
<a id="__codelineno-124-14" name="__codelineno-124-14" href="#__codelineno-124-14"></a><span class="w">  </span>...<span class="w"> </span><span class="o">(</span>may<span class="w"> </span>be<span class="w"> </span>filled<span class="w"> </span><span class="k">in</span><span class="w"> </span>by<span class="w"> </span>the<span class="w"> </span><span class="nb">time</span><span class="w"> </span>you<span class="w"> </span>look<span class="o">)</span><span class="w"> </span>...
<a id="__codelineno-124-15" name="__codelineno-124-15" href="#__codelineno-124-15"></a>
<a id="__codelineno-124-16" name="__codelineno-124-16" href="#__codelineno-124-16"></a>---
<a id="__codelineno-124-17" name="__codelineno-124-17" href="#__codelineno-124-17"></a>apiVersion:<span class="w"> </span>apps/v1
<a id="__codelineno-124-18" name="__codelineno-124-18" href="#__codelineno-124-18"></a>kind:<span class="w"> </span>ReplicaSet
<a id="__codelineno-124-19" name="__codelineno-124-19" href="#__codelineno-124-19"></a>metadata:
<a id="__codelineno-124-20" name="__codelineno-124-20" href="#__codelineno-124-20"></a><span class="w">  </span>annotations:
<a id="__codelineno-124-21" name="__codelineno-124-21" href="#__codelineno-124-21"></a><span class="w">    </span>edge.kubestellar.io/customizer:<span class="w"> </span>example-customizer
<a id="__codelineno-124-22" name="__codelineno-124-22" href="#__codelineno-124-22"></a><span class="w">    </span>kcp.io/cluster:<span class="w"> </span>1najcltzt2nqax47
<a id="__codelineno-124-23" name="__codelineno-124-23" href="#__codelineno-124-23"></a><span class="w">    </span>...<span class="w"> </span><span class="o">(</span>lots<span class="w"> </span>of<span class="w"> </span>other<span class="w"> </span>details<span class="o">)</span><span class="w"> </span>...
<a id="__codelineno-124-24" name="__codelineno-124-24" href="#__codelineno-124-24"></a><span class="w">  </span>name:<span class="w"> </span>commond
<a id="__codelineno-124-25" name="__codelineno-124-25" href="#__codelineno-124-25"></a><span class="w">  </span>namespace:<span class="w"> </span>commonstuff
<a id="__codelineno-124-26" name="__codelineno-124-26" href="#__codelineno-124-26"></a>spec:
<a id="__codelineno-124-27" name="__codelineno-124-27" href="#__codelineno-124-27"></a><span class="w">  </span>...<span class="w"> </span><span class="o">(</span>the<span class="w"> </span>customized<span class="w"> </span>spec<span class="o">)</span><span class="w"> </span>...
<a id="__codelineno-124-28" name="__codelineno-124-28" href="#__codelineno-124-28"></a>status:
<a id="__codelineno-124-29" name="__codelineno-124-29" href="#__codelineno-124-29"></a><span class="w">  </span>...<span class="w"> </span><span class="o">(</span>may<span class="w"> </span>be<span class="w"> </span>filled<span class="w"> </span><span class="k">in</span><span class="w"> </span>by<span class="w"> </span>the<span class="w"> </span><span class="nb">time</span><span class="w"> </span>you<span class="w"> </span>look<span class="o">)</span><span class="w"> </span>...
</code></pre></div>
<p>That display should show objects in two different mailbox workspaces;
the following command checks that.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-125-1" name="__codelineno-125-1" href="#__codelineno-125-1"></a><span class="c1"># TODO: kubestellar-list-syncing-objects has kcp dependencies. Will remove when controllers support spaces.</span>
<a id="__codelineno-125-2" name="__codelineno-125-2" href="#__codelineno-125-2"></a><span class="nb">test</span><span class="w"> </span><span class="k">$(</span>kubestellar-list-syncing-objects<span class="w"> </span>--api-group<span class="w"> </span>apps<span class="w"> </span>--api-kind<span class="w"> </span>ReplicaSet<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;^ *kcp.io/cluster: [0-9a-z]*</span>$<span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span><span class="p">|</span><span class="w"> </span>uniq<span class="w"> </span><span class="p">|</span><span class="w"> </span>wc<span class="w"> </span>-l<span class="k">)</span><span class="w"> </span>-ge<span class="w"> </span><span class="m">2</span>
</code></pre></div>
<p>The CustomResourceDefinition objects involved
should also appear in the mailbox workspaces.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-126-1" name="__codelineno-126-1" href="#__codelineno-126-1"></a><span class="c1"># TODO: kubestellar-list-syncing-objects has kcp dependencies. Will remove when controllers support spaces.</span>
<a id="__codelineno-126-2" name="__codelineno-126-2" href="#__codelineno-126-2"></a>kubestellar-list-syncing-objects<span class="w"> </span>--api-group<span class="w"> </span>apiextensions.k8s.io<span class="w"> </span>--api-kind<span class="w"> </span>CustomResourceDefinition<span class="w"> </span><span class="p">|</span><span class="w"> </span>fgrep<span class="w"> </span>-w<span class="w"> </span><span class="s2">&quot;name: crontabs.stable.example.com&quot;</span>
<a id="__codelineno-126-3" name="__codelineno-126-3" href="#__codelineno-126-3"></a><span class="nb">test</span><span class="w"> </span><span class="k">$(</span>kubestellar-list-syncing-objects<span class="w"> </span>--api-group<span class="w"> </span>apiextensions.k8s.io<span class="w"> </span>--api-kind<span class="w"> </span>CustomResourceDefinition<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-cw<span class="w"> </span><span class="s2">&quot;name: replicasets.apps&quot;</span><span class="k">)</span><span class="w"> </span>-ge<span class="w"> </span><span class="m">2</span>
<a id="__codelineno-126-4" name="__codelineno-126-4" href="#__codelineno-126-4"></a><span class="nb">test</span><span class="w"> </span><span class="k">$(</span>kubestellar-list-syncing-objects<span class="w"> </span>--api-group<span class="w"> </span>apiextensions.k8s.io<span class="w"> </span>--api-kind<span class="w"> </span>CustomResourceDefinition<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-cw<span class="w"> </span><span class="s2">&quot;name: deployments.apps&quot;</span><span class="k">)</span><span class="w"> </span>-ge<span class="w"> </span><span class="m">1</span>
</code></pre></div>
<p>The <code>APIService</code> of the special workload should also appear, along
with some error messages about <code>APIService</code> not being known in the
other mailbox workspaces.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-127-1" name="__codelineno-127-1" href="#__codelineno-127-1"></a><span class="c1"># TODO: kubestellar-list-syncing-objects has kcp dependencies. Will remove when controllers support spaces.</span>
<a id="__codelineno-127-2" name="__codelineno-127-2" href="#__codelineno-127-2"></a>kubestellar-list-syncing-objects<span class="w"> </span>--api-group<span class="w"> </span>apiregistration.k8s.io<span class="w"> </span>--api-kind<span class="w"> </span>APIService<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-v<span class="w"> </span><span class="s2">&quot;APIService.*the server could not find the requested resource&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>fgrep<span class="w"> </span>-w<span class="w"> </span><span class="s2">&quot;name: v1090.example.my&quot;</span>
</code></pre></div>
<p>The florin cluster gets only the common workload.  Examine florin's
<code>SyncerConfig</code> as follows.  Utilize the name of the mailbox workspace
for florin (which you stored in Stage 1) here.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-128-1" name="__codelineno-128-1" href="#__codelineno-128-1"></a><span class="c1"># TODO: $FLORIN_WS is a mailbox workspace </span>
<a id="__codelineno-128-2" name="__codelineno-128-2" href="#__codelineno-128-2"></a>kubectl<span class="w"> </span>ws<span class="w"> </span>root:<span class="nv">$FLORIN_WS</span>
</code></pre></div>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-129-1" name="__codelineno-129-1" href="#__codelineno-129-1"></a>Current<span class="w"> </span>workspace<span class="w"> </span>is<span class="w"> </span><span class="s2">&quot;root:1t82bk54r6gjnzsp-mb-1a045336-8178-4026-8a56-5cd5609c0ec1&quot;</span><span class="w"> </span><span class="o">(</span><span class="nb">type</span><span class="w"> </span>root:universal<span class="o">)</span>.
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-130-1" name="__codelineno-130-1" href="#__codelineno-130-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>SyncerConfig<span class="w"> </span>the-one<span class="w"> </span>-o<span class="w"> </span>yaml
</code></pre></div>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-131-1" name="__codelineno-131-1" href="#__codelineno-131-1"></a>apiVersion:<span class="w"> </span>edge.kubestellar.io/v2alpha1
<a id="__codelineno-131-2" name="__codelineno-131-2" href="#__codelineno-131-2"></a>kind:<span class="w"> </span>SyncerConfig
<a id="__codelineno-131-3" name="__codelineno-131-3" href="#__codelineno-131-3"></a>metadata:
<a id="__codelineno-131-4" name="__codelineno-131-4" href="#__codelineno-131-4"></a><span class="w">  </span>annotations:
<a id="__codelineno-131-5" name="__codelineno-131-5" href="#__codelineno-131-5"></a><span class="w">    </span>kcp.io/cluster:<span class="w"> </span>12299slctppnhjnn
<a id="__codelineno-131-6" name="__codelineno-131-6" href="#__codelineno-131-6"></a><span class="w">  </span>creationTimestamp:<span class="w"> </span><span class="s2">&quot;2023-04-23T05:39:56Z&quot;</span>
<a id="__codelineno-131-7" name="__codelineno-131-7" href="#__codelineno-131-7"></a><span class="w">  </span>generation:<span class="w"> </span><span class="m">3</span>
<a id="__codelineno-131-8" name="__codelineno-131-8" href="#__codelineno-131-8"></a><span class="w">  </span>name:<span class="w"> </span>the-one
<a id="__codelineno-131-9" name="__codelineno-131-9" href="#__codelineno-131-9"></a><span class="w">  </span>resourceVersion:<span class="w"> </span><span class="s2">&quot;1323&quot;</span>
<a id="__codelineno-131-10" name="__codelineno-131-10" href="#__codelineno-131-10"></a><span class="w">  </span>uid:<span class="w"> </span>8840fee6-37dc-407e-ad01-2ad59389d4ff
<a id="__codelineno-131-11" name="__codelineno-131-11" href="#__codelineno-131-11"></a>spec:
<a id="__codelineno-131-12" name="__codelineno-131-12" href="#__codelineno-131-12"></a><span class="w">  </span>namespaceScope:<span class="w"> </span><span class="o">{}</span>
<a id="__codelineno-131-13" name="__codelineno-131-13" href="#__codelineno-131-13"></a><span class="w">  </span>namespacedObjects:
<a id="__codelineno-131-14" name="__codelineno-131-14" href="#__codelineno-131-14"></a><span class="w">  </span>-<span class="w"> </span>apiVersion:<span class="w"> </span>v1
<a id="__codelineno-131-15" name="__codelineno-131-15" href="#__codelineno-131-15"></a><span class="w">    </span>group:<span class="w"> </span><span class="s2">&quot;&quot;</span>
<a id="__codelineno-131-16" name="__codelineno-131-16" href="#__codelineno-131-16"></a><span class="w">    </span>objectsByNamespace:
<a id="__codelineno-131-17" name="__codelineno-131-17" href="#__codelineno-131-17"></a><span class="w">    </span>-<span class="w"> </span>names:
<a id="__codelineno-131-18" name="__codelineno-131-18" href="#__codelineno-131-18"></a><span class="w">      </span>-<span class="w"> </span>httpd-htdocs
<a id="__codelineno-131-19" name="__codelineno-131-19" href="#__codelineno-131-19"></a><span class="w">      </span>namespace:<span class="w"> </span>commonstuff
<a id="__codelineno-131-20" name="__codelineno-131-20" href="#__codelineno-131-20"></a><span class="w">    </span>resource:<span class="w"> </span>configmaps
<a id="__codelineno-131-21" name="__codelineno-131-21" href="#__codelineno-131-21"></a><span class="w">  </span>-<span class="w"> </span>apiVersion:<span class="w"> </span>v1
<a id="__codelineno-131-22" name="__codelineno-131-22" href="#__codelineno-131-22"></a><span class="w">    </span>group:<span class="w"> </span>apps
<a id="__codelineno-131-23" name="__codelineno-131-23" href="#__codelineno-131-23"></a><span class="w">    </span>objectsByNamespace:
<a id="__codelineno-131-24" name="__codelineno-131-24" href="#__codelineno-131-24"></a><span class="w">    </span>-<span class="w"> </span>names:
<a id="__codelineno-131-25" name="__codelineno-131-25" href="#__codelineno-131-25"></a><span class="w">      </span>-<span class="w"> </span>commond
<a id="__codelineno-131-26" name="__codelineno-131-26" href="#__codelineno-131-26"></a><span class="w">      </span>namespace:<span class="w"> </span>commonstuff
<a id="__codelineno-131-27" name="__codelineno-131-27" href="#__codelineno-131-27"></a><span class="w">    </span>resource:<span class="w"> </span>replicasets
<a id="__codelineno-131-28" name="__codelineno-131-28" href="#__codelineno-131-28"></a><span class="w">  </span>upsync:
<a id="__codelineno-131-29" name="__codelineno-131-29" href="#__codelineno-131-29"></a><span class="w">  </span>-<span class="w"> </span>apiGroup:<span class="w"> </span>group1.test
<a id="__codelineno-131-30" name="__codelineno-131-30" href="#__codelineno-131-30"></a><span class="w">    </span>names:
<a id="__codelineno-131-31" name="__codelineno-131-31" href="#__codelineno-131-31"></a><span class="w">    </span>-<span class="w"> </span>george
<a id="__codelineno-131-32" name="__codelineno-131-32" href="#__codelineno-131-32"></a><span class="w">    </span>-<span class="w"> </span>cosmo
<a id="__codelineno-131-33" name="__codelineno-131-33" href="#__codelineno-131-33"></a><span class="w">    </span>namespaces:
<a id="__codelineno-131-34" name="__codelineno-131-34" href="#__codelineno-131-34"></a><span class="w">    </span>-<span class="w"> </span>orbital
<a id="__codelineno-131-35" name="__codelineno-131-35" href="#__codelineno-131-35"></a><span class="w">    </span>resources:
<a id="__codelineno-131-36" name="__codelineno-131-36" href="#__codelineno-131-36"></a><span class="w">    </span>-<span class="w"> </span>sprockets
<a id="__codelineno-131-37" name="__codelineno-131-37" href="#__codelineno-131-37"></a><span class="w">    </span>-<span class="w"> </span>flanges
<a id="__codelineno-131-38" name="__codelineno-131-38" href="#__codelineno-131-38"></a><span class="w">  </span>-<span class="w"> </span>apiGroup:<span class="w"> </span>group2.test
<a id="__codelineno-131-39" name="__codelineno-131-39" href="#__codelineno-131-39"></a><span class="w">    </span>names:
<a id="__codelineno-131-40" name="__codelineno-131-40" href="#__codelineno-131-40"></a><span class="w">    </span>-<span class="w"> </span>william
<a id="__codelineno-131-41" name="__codelineno-131-41" href="#__codelineno-131-41"></a><span class="w">    </span>resources:
<a id="__codelineno-131-42" name="__codelineno-131-42" href="#__codelineno-131-42"></a><span class="w">    </span>-<span class="w"> </span>cogs
<a id="__codelineno-131-43" name="__codelineno-131-43" href="#__codelineno-131-43"></a>status:<span class="w"> </span><span class="o">{}</span>
</code></pre></div>
<p>The guilder cluster gets both the common and special workloads.
Examine guilder's <code>SyncerConfig</code> object and workloads as follows,
using the mailbox workspace name that you stored in Stage 1.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-132-1" name="__codelineno-132-1" href="#__codelineno-132-1"></a><span class="c1"># TODO: $GUILDER_WS is a mailbox workspace </span>
<a id="__codelineno-132-2" name="__codelineno-132-2" href="#__codelineno-132-2"></a>kubectl<span class="w"> </span>ws<span class="w"> </span>root:<span class="nv">$GUILDER_WS</span>
</code></pre></div>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-133-1" name="__codelineno-133-1" href="#__codelineno-133-1"></a>Current<span class="w"> </span>workspace<span class="w"> </span>is<span class="w"> </span><span class="s2">&quot;root:1t82bk54r6gjnzsp-mb-f0a82ab1-63f4-49ea-954d-3a41a35a9f1c&quot;</span><span class="w"> </span><span class="o">(</span><span class="nb">type</span><span class="w"> </span>root:universal<span class="o">)</span>.
</code></pre></div></p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-134-1" name="__codelineno-134-1" href="#__codelineno-134-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>SyncerConfig<span class="w"> </span>the-one<span class="w"> </span>-o<span class="w"> </span>yaml
</code></pre></div>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-135-1" name="__codelineno-135-1" href="#__codelineno-135-1"></a>apiVersion:<span class="w"> </span>edge.kubestellar.io/v2alpha1
<a id="__codelineno-135-2" name="__codelineno-135-2" href="#__codelineno-135-2"></a>kind:<span class="w"> </span>SyncerConfig
<a id="__codelineno-135-3" name="__codelineno-135-3" href="#__codelineno-135-3"></a>metadata:
<a id="__codelineno-135-4" name="__codelineno-135-4" href="#__codelineno-135-4"></a><span class="w">  </span>annotations:
<a id="__codelineno-135-5" name="__codelineno-135-5" href="#__codelineno-135-5"></a><span class="w">    </span>kcp.io/cluster:<span class="w"> </span>yk9a66vjms1pi8hu
<a id="__codelineno-135-6" name="__codelineno-135-6" href="#__codelineno-135-6"></a><span class="w">  </span>creationTimestamp:<span class="w"> </span><span class="s2">&quot;2023-04-23T05:39:56Z&quot;</span>
<a id="__codelineno-135-7" name="__codelineno-135-7" href="#__codelineno-135-7"></a><span class="w">  </span>generation:<span class="w"> </span><span class="m">4</span>
<a id="__codelineno-135-8" name="__codelineno-135-8" href="#__codelineno-135-8"></a><span class="w">  </span>name:<span class="w"> </span>the-one
<a id="__codelineno-135-9" name="__codelineno-135-9" href="#__codelineno-135-9"></a><span class="w">  </span>resourceVersion:<span class="w"> </span><span class="s2">&quot;1325&quot;</span>
<a id="__codelineno-135-10" name="__codelineno-135-10" href="#__codelineno-135-10"></a><span class="w">  </span>uid:<span class="w"> </span>3da056c7-0d5c-45a3-9d91-d04f04415f30
<a id="__codelineno-135-11" name="__codelineno-135-11" href="#__codelineno-135-11"></a>spec:
<a id="__codelineno-135-12" name="__codelineno-135-12" href="#__codelineno-135-12"></a><span class="w">  </span>clusterScope:
<a id="__codelineno-135-13" name="__codelineno-135-13" href="#__codelineno-135-13"></a><span class="w">  </span>-<span class="w"> </span>apiVersion:<span class="w"> </span>v1
<a id="__codelineno-135-14" name="__codelineno-135-14" href="#__codelineno-135-14"></a><span class="w">    </span>group:<span class="w"> </span><span class="s2">&quot;&quot;</span>
<a id="__codelineno-135-15" name="__codelineno-135-15" href="#__codelineno-135-15"></a><span class="w">    </span>objects:
<a id="__codelineno-135-16" name="__codelineno-135-16" href="#__codelineno-135-16"></a><span class="w">    </span>-<span class="w"> </span>specialstuff
<a id="__codelineno-135-17" name="__codelineno-135-17" href="#__codelineno-135-17"></a><span class="w">    </span>resource:<span class="w"> </span>namespaces
<a id="__codelineno-135-18" name="__codelineno-135-18" href="#__codelineno-135-18"></a><span class="w">  </span>-<span class="w"> </span>apiVersion:<span class="w"> </span>v1
<a id="__codelineno-135-19" name="__codelineno-135-19" href="#__codelineno-135-19"></a><span class="w">    </span>group:<span class="w"> </span>apiextensions.k8s.io
<a id="__codelineno-135-20" name="__codelineno-135-20" href="#__codelineno-135-20"></a><span class="w">    </span>objects:
<a id="__codelineno-135-21" name="__codelineno-135-21" href="#__codelineno-135-21"></a><span class="w">    </span>-<span class="w"> </span>crontabs.stable.example.com
<a id="__codelineno-135-22" name="__codelineno-135-22" href="#__codelineno-135-22"></a><span class="w">    </span>resource:<span class="w"> </span>customresourcedefinitions
<a id="__codelineno-135-23" name="__codelineno-135-23" href="#__codelineno-135-23"></a><span class="w">  </span>-<span class="w"> </span>apiVersion:<span class="w"> </span>v1
<a id="__codelineno-135-24" name="__codelineno-135-24" href="#__codelineno-135-24"></a><span class="w">    </span>group:<span class="w"> </span>apiregistration.k8s.io
<a id="__codelineno-135-25" name="__codelineno-135-25" href="#__codelineno-135-25"></a><span class="w">    </span>objects:
<a id="__codelineno-135-26" name="__codelineno-135-26" href="#__codelineno-135-26"></a><span class="w">    </span>-<span class="w"> </span>v1090.example.my
<a id="__codelineno-135-27" name="__codelineno-135-27" href="#__codelineno-135-27"></a><span class="w">    </span>resource:<span class="w"> </span>apiservices
<a id="__codelineno-135-28" name="__codelineno-135-28" href="#__codelineno-135-28"></a><span class="w">  </span>namespaceScope:<span class="w"> </span><span class="o">{}</span>
<a id="__codelineno-135-29" name="__codelineno-135-29" href="#__codelineno-135-29"></a><span class="w">  </span>namespacedObjects:
<a id="__codelineno-135-30" name="__codelineno-135-30" href="#__codelineno-135-30"></a><span class="w">  </span>-<span class="w"> </span>apiVersion:<span class="w"> </span>v1
<a id="__codelineno-135-31" name="__codelineno-135-31" href="#__codelineno-135-31"></a><span class="w">    </span>group:<span class="w"> </span>apps
<a id="__codelineno-135-32" name="__codelineno-135-32" href="#__codelineno-135-32"></a><span class="w">    </span>objectsByNamespace:
<a id="__codelineno-135-33" name="__codelineno-135-33" href="#__codelineno-135-33"></a><span class="w">    </span>-<span class="w"> </span>names:
<a id="__codelineno-135-34" name="__codelineno-135-34" href="#__codelineno-135-34"></a><span class="w">      </span>-<span class="w"> </span>commond
<a id="__codelineno-135-35" name="__codelineno-135-35" href="#__codelineno-135-35"></a><span class="w">      </span>namespace:<span class="w"> </span>commonstuff
<a id="__codelineno-135-36" name="__codelineno-135-36" href="#__codelineno-135-36"></a><span class="w">    </span>resource:<span class="w"> </span>replicasets
<a id="__codelineno-135-37" name="__codelineno-135-37" href="#__codelineno-135-37"></a><span class="w">  </span>-<span class="w"> </span>apiVersion:<span class="w"> </span>v1
<a id="__codelineno-135-38" name="__codelineno-135-38" href="#__codelineno-135-38"></a><span class="w">    </span>group:<span class="w"> </span>stable.example.com
<a id="__codelineno-135-39" name="__codelineno-135-39" href="#__codelineno-135-39"></a><span class="w">    </span>objectsByNamespace:
<a id="__codelineno-135-40" name="__codelineno-135-40" href="#__codelineno-135-40"></a><span class="w">    </span>-<span class="w"> </span>names:
<a id="__codelineno-135-41" name="__codelineno-135-41" href="#__codelineno-135-41"></a><span class="w">      </span>-<span class="w"> </span>my-new-cron-object
<a id="__codelineno-135-42" name="__codelineno-135-42" href="#__codelineno-135-42"></a><span class="w">      </span>namespace:<span class="w"> </span>specialstuff
<a id="__codelineno-135-43" name="__codelineno-135-43" href="#__codelineno-135-43"></a><span class="w">    </span>resource:<span class="w"> </span>crontabs
<a id="__codelineno-135-44" name="__codelineno-135-44" href="#__codelineno-135-44"></a><span class="w">  </span>-<span class="w"> </span>apiVersion:<span class="w"> </span>v1
<a id="__codelineno-135-45" name="__codelineno-135-45" href="#__codelineno-135-45"></a><span class="w">    </span>group:<span class="w"> </span>apps
<a id="__codelineno-135-46" name="__codelineno-135-46" href="#__codelineno-135-46"></a><span class="w">    </span>objectsByNamespace:
<a id="__codelineno-135-47" name="__codelineno-135-47" href="#__codelineno-135-47"></a><span class="w">    </span>-<span class="w"> </span>names:
<a id="__codelineno-135-48" name="__codelineno-135-48" href="#__codelineno-135-48"></a><span class="w">      </span>-<span class="w"> </span>speciald
<a id="__codelineno-135-49" name="__codelineno-135-49" href="#__codelineno-135-49"></a><span class="w">      </span>namespace:<span class="w"> </span>specialstuff
<a id="__codelineno-135-50" name="__codelineno-135-50" href="#__codelineno-135-50"></a><span class="w">    </span>resource:<span class="w"> </span>deployments
<a id="__codelineno-135-51" name="__codelineno-135-51" href="#__codelineno-135-51"></a><span class="w">  </span>-<span class="w"> </span>apiVersion:<span class="w"> </span>v1
<a id="__codelineno-135-52" name="__codelineno-135-52" href="#__codelineno-135-52"></a><span class="w">    </span>group:<span class="w"> </span><span class="s2">&quot;&quot;</span>
<a id="__codelineno-135-53" name="__codelineno-135-53" href="#__codelineno-135-53"></a><span class="w">    </span>objectsByNamespace:
<a id="__codelineno-135-54" name="__codelineno-135-54" href="#__codelineno-135-54"></a><span class="w">    </span>-<span class="w"> </span>names:
<a id="__codelineno-135-55" name="__codelineno-135-55" href="#__codelineno-135-55"></a><span class="w">      </span>-<span class="w"> </span>httpd-htdocs
<a id="__codelineno-135-56" name="__codelineno-135-56" href="#__codelineno-135-56"></a><span class="w">      </span>namespace:<span class="w"> </span>commonstuff
<a id="__codelineno-135-57" name="__codelineno-135-57" href="#__codelineno-135-57"></a><span class="w">    </span>-<span class="w"> </span>names:
<a id="__codelineno-135-58" name="__codelineno-135-58" href="#__codelineno-135-58"></a><span class="w">      </span>-<span class="w"> </span>httpd-htdocs
<a id="__codelineno-135-59" name="__codelineno-135-59" href="#__codelineno-135-59"></a><span class="w">      </span>namespace:<span class="w"> </span>specialstuff
<a id="__codelineno-135-60" name="__codelineno-135-60" href="#__codelineno-135-60"></a><span class="w">    </span>resource:<span class="w"> </span>configmaps
<a id="__codelineno-135-61" name="__codelineno-135-61" href="#__codelineno-135-61"></a><span class="w">  </span>upsync:
<a id="__codelineno-135-62" name="__codelineno-135-62" href="#__codelineno-135-62"></a><span class="w">  </span>-<span class="w"> </span>apiGroup:<span class="w"> </span>group3.test
<a id="__codelineno-135-63" name="__codelineno-135-63" href="#__codelineno-135-63"></a><span class="w">    </span>names:
<a id="__codelineno-135-64" name="__codelineno-135-64" href="#__codelineno-135-64"></a><span class="w">    </span>-<span class="w"> </span><span class="s1">&#39;*&#39;</span>
<a id="__codelineno-135-65" name="__codelineno-135-65" href="#__codelineno-135-65"></a><span class="w">    </span>resources:
<a id="__codelineno-135-66" name="__codelineno-135-66" href="#__codelineno-135-66"></a><span class="w">    </span>-<span class="w"> </span>widgets
<a id="__codelineno-135-67" name="__codelineno-135-67" href="#__codelineno-135-67"></a><span class="w">  </span>-<span class="w"> </span>apiGroup:<span class="w"> </span>group1.test
<a id="__codelineno-135-68" name="__codelineno-135-68" href="#__codelineno-135-68"></a><span class="w">    </span>names:
<a id="__codelineno-135-69" name="__codelineno-135-69" href="#__codelineno-135-69"></a><span class="w">    </span>-<span class="w"> </span>george
<a id="__codelineno-135-70" name="__codelineno-135-70" href="#__codelineno-135-70"></a><span class="w">    </span>-<span class="w"> </span>cosmo
<a id="__codelineno-135-71" name="__codelineno-135-71" href="#__codelineno-135-71"></a><span class="w">    </span>namespaces:
<a id="__codelineno-135-72" name="__codelineno-135-72" href="#__codelineno-135-72"></a><span class="w">    </span>-<span class="w"> </span>orbital
<a id="__codelineno-135-73" name="__codelineno-135-73" href="#__codelineno-135-73"></a><span class="w">    </span>resources:
<a id="__codelineno-135-74" name="__codelineno-135-74" href="#__codelineno-135-74"></a><span class="w">    </span>-<span class="w"> </span>sprockets
<a id="__codelineno-135-75" name="__codelineno-135-75" href="#__codelineno-135-75"></a><span class="w">    </span>-<span class="w"> </span>flanges
<a id="__codelineno-135-76" name="__codelineno-135-76" href="#__codelineno-135-76"></a><span class="w">  </span>-<span class="w"> </span>apiGroup:<span class="w"> </span>group2.test
<a id="__codelineno-135-77" name="__codelineno-135-77" href="#__codelineno-135-77"></a><span class="w">    </span>names:
<a id="__codelineno-135-78" name="__codelineno-135-78" href="#__codelineno-135-78"></a><span class="w">    </span>-<span class="w"> </span>william
<a id="__codelineno-135-79" name="__codelineno-135-79" href="#__codelineno-135-79"></a><span class="w">    </span>resources:
<a id="__codelineno-135-80" name="__codelineno-135-80" href="#__codelineno-135-80"></a><span class="w">    </span>-<span class="w"> </span>cogs
<a id="__codelineno-135-81" name="__codelineno-135-81" href="#__codelineno-135-81"></a>status:<span class="w"> </span><span class="o">{}</span>
</code></pre></div></p>
<p>You can check for specific workload objects here with the following
command.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-136-1" name="__codelineno-136-1" href="#__codelineno-136-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>deployments,replicasets<span class="w"> </span>-A
</code></pre></div>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-137-1" name="__codelineno-137-1" href="#__codelineno-137-1"></a>NAMESPACE<span class="w">      </span>NAME<span class="w">                       </span>READY<span class="w">   </span>UP-TO-DATE<span class="w">   </span>AVAILABLE<span class="w">   </span>AGE
<a id="__codelineno-137-2" name="__codelineno-137-2" href="#__codelineno-137-2"></a>specialstuff<span class="w">   </span>deployment.apps/speciald<span class="w">   </span><span class="m">0</span>/0<span class="w">     </span><span class="m">1</span><span class="w">            </span><span class="m">0</span><span class="w">           </span>12m
<a id="__codelineno-137-3" name="__codelineno-137-3" href="#__codelineno-137-3"></a>
<a id="__codelineno-137-4" name="__codelineno-137-4" href="#__codelineno-137-4"></a>NAMESPACE<span class="w">     </span>NAME<span class="w">                      </span>DESIRED<span class="w">   </span>CURRENT<span class="w">   </span>READY<span class="w">   </span>AGE
<a id="__codelineno-137-5" name="__codelineno-137-5" href="#__codelineno-137-5"></a>commonstuff<span class="w">   </span>replicaset.apps/commond<span class="w">   </span><span class="m">0</span><span class="w">         </span><span class="m">1</span><span class="w">         </span><span class="m">1</span><span class="w">       </span>7m4s
</code></pre></div></p>
<!--example1-stage-3-stop-->

<!-- END INCLUDE -->

<!-- BEGIN INCLUDE ./example1-stage-4.md '&lt;!--example1-stage-4-start--&gt;' '&lt;!--example1-stage-4-end--&gt;' -->

<h2 id="stage-4">Stage 4<a class="headerlink" href="#stage-4" title="Permanent link">#</a></h2>
<p><img alt="Syncer effects" src="../Edge-PoC-2023q1-Scenario-1-stage-4.svg" title="Stage 4 summary" /></p>
<p>In Stage 4, the edge syncer does its thing.  Actually, it should have
done it as soon as the relevant inputs became available in stage 3.
Now we examine what happened.</p>
<p>You can check that the workloads are running in the edge clusters as
they should be.</p>
<p>The syncer does its thing between the florin cluster and its mailbox
workspace.  This is driven by the <code>SyncerConfig</code> object named
<code>the-one</code> in that mailbox workspace.</p>
<p>The syncer does its thing between the guilder cluster and its mailbox
workspace.  This is driven by the <code>SyncerConfig</code> object named
<code>the-one</code> in that mailbox workspace.</p>
<p>Using the kubeconfig that <code>kind</code> modified, examine the florin cluster.
Find just the <code>commonstuff</code> namespace and the <code>commond</code> Deployment.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-138-1" name="__codelineno-138-1" href="#__codelineno-138-1"></a><span class="o">(</span><span class="w"> </span><span class="nv">KUBECONFIG</span><span class="o">=</span>~/.kube/config
<a id="__codelineno-138-2" name="__codelineno-138-2" href="#__codelineno-138-2"></a><span class="w">  </span><span class="nb">let</span><span class="w"> </span><span class="nv">tries</span><span class="o">=</span><span class="m">1</span>
<a id="__codelineno-138-3" name="__codelineno-138-3" href="#__codelineno-138-3"></a><span class="w">  </span><span class="k">while</span><span class="w"> </span>!<span class="w"> </span>kubectl<span class="w"> </span>--context<span class="w"> </span>kind-florin<span class="w"> </span>get<span class="w"> </span>ns<span class="w"> </span>commonstuff<span class="w"> </span><span class="p">&amp;</span>&gt;<span class="w"> </span>/dev/null<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<a id="__codelineno-138-4" name="__codelineno-138-4" href="#__codelineno-138-4"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">((</span><span class="w"> </span>tries<span class="w"> </span>&gt;<span class="o">=</span><span class="w"> </span><span class="m">30</span><span class="o">))</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<a id="__codelineno-138-5" name="__codelineno-138-5" href="#__codelineno-138-5"></a><span class="w">      </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;The commonstuff namespace failed to appear in florin!&#39;</span><span class="w"> </span>&gt;<span class="p">&amp;</span><span class="m">2</span>
<a id="__codelineno-138-6" name="__codelineno-138-6" href="#__codelineno-138-6"></a><span class="w">      </span><span class="nb">exit</span><span class="w"> </span><span class="m">10</span>
<a id="__codelineno-138-7" name="__codelineno-138-7" href="#__codelineno-138-7"></a><span class="w">    </span><span class="k">fi</span>
<a id="__codelineno-138-8" name="__codelineno-138-8" href="#__codelineno-138-8"></a><span class="w">    </span><span class="nb">let</span><span class="w"> </span><span class="nv">tries</span><span class="o">=</span>tries+1
<a id="__codelineno-138-9" name="__codelineno-138-9" href="#__codelineno-138-9"></a><span class="w">    </span>sleep<span class="w"> </span><span class="m">10</span>
<a id="__codelineno-138-10" name="__codelineno-138-10" href="#__codelineno-138-10"></a><span class="w">  </span><span class="k">done</span>
<a id="__codelineno-138-11" name="__codelineno-138-11" href="#__codelineno-138-11"></a><span class="w">  </span>kubectl<span class="w"> </span>--context<span class="w"> </span>kind-florin<span class="w"> </span>get<span class="w"> </span>ns
<a id="__codelineno-138-12" name="__codelineno-138-12" href="#__codelineno-138-12"></a><span class="o">)</span>
</code></pre></div>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-139-1" name="__codelineno-139-1" href="#__codelineno-139-1"></a>NAME<span class="w">                                 </span>STATUS<span class="w">   </span>AGE
<a id="__codelineno-139-2" name="__codelineno-139-2" href="#__codelineno-139-2"></a>commonstuff<span class="w">                          </span>Active<span class="w">   </span>6m51s
<a id="__codelineno-139-3" name="__codelineno-139-3" href="#__codelineno-139-3"></a>default<span class="w">                              </span>Active<span class="w">   </span>57m
<a id="__codelineno-139-4" name="__codelineno-139-4" href="#__codelineno-139-4"></a>kubestellar-syncer-florin-1t9zgidy<span class="w">   </span>Active<span class="w">   </span>17m
<a id="__codelineno-139-5" name="__codelineno-139-5" href="#__codelineno-139-5"></a>kube-node-lease<span class="w">                      </span>Active<span class="w">   </span>57m
<a id="__codelineno-139-6" name="__codelineno-139-6" href="#__codelineno-139-6"></a>kube-public<span class="w">                          </span>Active<span class="w">   </span>57m
<a id="__codelineno-139-7" name="__codelineno-139-7" href="#__codelineno-139-7"></a>kube-system<span class="w">                          </span>Active<span class="w">   </span>57m
<a id="__codelineno-139-8" name="__codelineno-139-8" href="#__codelineno-139-8"></a>local-path-storage<span class="w">                   </span>Active<span class="w">   </span>57m
</code></pre></div></p>
<div class="hide-me highlight"><pre><span></span><code><a id="__codelineno-140-1" name="__codelineno-140-1" href="#__codelineno-140-1"></a>sleep<span class="w"> </span><span class="m">15</span>
</code></pre></div>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-141-1" name="__codelineno-141-1" href="#__codelineno-141-1"></a><span class="nv">KUBECONFIG</span><span class="o">=</span>~/.kube/config<span class="w"> </span>kubectl<span class="w"> </span>--context<span class="w"> </span>kind-florin<span class="w"> </span>get<span class="w"> </span>deploy,rs<span class="w"> </span>-A<span class="w"> </span><span class="p">|</span><span class="w"> </span>egrep<span class="w"> </span><span class="s1">&#39;NAME|stuff&#39;</span>
</code></pre></div>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-142-1" name="__codelineno-142-1" href="#__codelineno-142-1"></a>NAMESPACE<span class="w">                            </span>NAME<span class="w">                                                 </span>READY<span class="w">   </span>UP-TO-DATE<span class="w">   </span>AVAILABLE<span class="w">   </span>AGE
<a id="__codelineno-142-2" name="__codelineno-142-2" href="#__codelineno-142-2"></a>NAMESPACE<span class="w">                            </span>NAME<span class="w">                                                            </span>DESIRED<span class="w">   </span>CURRENT<span class="w">   </span>READY<span class="w">   </span>AGE
<a id="__codelineno-142-3" name="__codelineno-142-3" href="#__codelineno-142-3"></a>commonstuff<span class="w">                          </span>replicaset.apps/commond<span class="w">                                         </span><span class="m">1</span><span class="w">         </span><span class="m">1</span><span class="w">         </span><span class="m">1</span><span class="w">       </span>13m
</code></pre></div></p>
<p>Examine the guilder cluster.  Find both workload namespaces, the
Deployment, and both ReplicaSets.</p>
<div class="hide-me highlight"><pre><span></span><code><a id="__codelineno-143-1" name="__codelineno-143-1" href="#__codelineno-143-1"></a>sleep<span class="w"> </span><span class="m">15</span>
</code></pre></div>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-144-1" name="__codelineno-144-1" href="#__codelineno-144-1"></a><span class="nv">KUBECONFIG</span><span class="o">=</span>~/.kube/config<span class="w"> </span>kubectl<span class="w"> </span>--context<span class="w"> </span>kind-guilder<span class="w"> </span>get<span class="w"> </span>ns<span class="w"> </span><span class="p">|</span><span class="w"> </span>egrep<span class="w"> </span>NAME<span class="se">\|</span>stuff
</code></pre></div>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-145-1" name="__codelineno-145-1" href="#__codelineno-145-1"></a>NAME<span class="w">                               </span>STATUS<span class="w">   </span>AGE
<a id="__codelineno-145-2" name="__codelineno-145-2" href="#__codelineno-145-2"></a>commonstuff<span class="w">                        </span>Active<span class="w">   </span>8m33s
<a id="__codelineno-145-3" name="__codelineno-145-3" href="#__codelineno-145-3"></a>specialstuff<span class="w">                       </span>Active<span class="w">   </span>8m33s
</code></pre></div></p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-146-1" name="__codelineno-146-1" href="#__codelineno-146-1"></a><span class="nv">KUBECONFIG</span><span class="o">=</span>~/.kube/config<span class="w"> </span>kubectl<span class="w"> </span>--context<span class="w"> </span>kind-guilder<span class="w"> </span>get<span class="w"> </span>deploy,rs<span class="w"> </span>-A<span class="w"> </span><span class="p">|</span><span class="w"> </span>egrep<span class="w"> </span>NAME<span class="se">\|</span>stuff
</code></pre></div>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-147-1" name="__codelineno-147-1" href="#__codelineno-147-1"></a>NAMESPACE<span class="w">                             </span>NAME<span class="w">                                                  </span>READY<span class="w">   </span>UP-TO-DATE<span class="w">   </span>AVAILABLE<span class="w">   </span>AGE
<a id="__codelineno-147-2" name="__codelineno-147-2" href="#__codelineno-147-2"></a>specialstuff<span class="w">                          </span>deployment.apps/speciald<span class="w">                              </span><span class="m">1</span>/1<span class="w">     </span><span class="m">1</span><span class="w">            </span><span class="m">1</span><span class="w">           </span>23m
<a id="__codelineno-147-3" name="__codelineno-147-3" href="#__codelineno-147-3"></a>NAMESPACE<span class="w">                             </span>NAME<span class="w">                                                            </span>DESIRED<span class="w">   </span>CURRENT<span class="w">   </span>READY<span class="w">   </span>AGE
<a id="__codelineno-147-4" name="__codelineno-147-4" href="#__codelineno-147-4"></a>commonstuff<span class="w">                           </span>replicaset.apps/commond<span class="w">                                         </span><span class="m">1</span><span class="w">         </span><span class="m">1</span><span class="w">         </span><span class="m">1</span><span class="w">       </span>23m
<a id="__codelineno-147-5" name="__codelineno-147-5" href="#__codelineno-147-5"></a>specialstuff<span class="w">                          </span>replicaset.apps/speciald-76cdbb69b5<span class="w">                             </span><span class="m">1</span><span class="w">         </span><span class="m">1</span><span class="w">         </span><span class="m">1</span><span class="w">       </span>14s
</code></pre></div></p>
<p>Examine the <code>APIService</code> objects in the guilder cluster, find the one
named <code>v1090.example.my</code>. It is broken because it refers to a Service
object that we have not bothered to create.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-148-1" name="__codelineno-148-1" href="#__codelineno-148-1"></a><span class="nv">KUBECONFIG</span><span class="o">=</span>~/.kube/config<span class="w"> </span>kubectl<span class="w"> </span>--context<span class="w"> </span>kind-guilder<span class="w"> </span>get<span class="w"> </span>apiservices<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="m">1090</span>
</code></pre></div>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-149-1" name="__codelineno-149-1" href="#__codelineno-149-1"></a>v1090.example.my<span class="w">                       </span>my-example/my-service<span class="w">   </span>False<span class="w"> </span><span class="o">(</span>ServiceNotFound<span class="o">)</span><span class="w">   </span>2m39s
</code></pre></div></p>
<p>See the crontab in the guilder cluster.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-150-1" name="__codelineno-150-1" href="#__codelineno-150-1"></a><span class="nv">KUBECONFIG</span><span class="o">=</span>~/.kube/config<span class="w"> </span>kubectl<span class="w"> </span>--context<span class="w"> </span>kind-guilder<span class="w"> </span>get<span class="w"> </span>crontabs<span class="w"> </span>-n<span class="w"> </span>specialstuff
</code></pre></div>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-151-1" name="__codelineno-151-1" href="#__codelineno-151-1"></a>NAME<span class="w">                 </span>AGE
<a id="__codelineno-151-2" name="__codelineno-151-2" href="#__codelineno-151-2"></a>my-new-cron-object<span class="w">   </span>37m
</code></pre></div></p>
<p>Examining the common workload in the guilder cluster, for example,
will show that the replacement-style customization happened.</p>
<div class="hide-me highlight"><pre><span></span><code><a id="__codelineno-152-1" name="__codelineno-152-1" href="#__codelineno-152-1"></a>sleep<span class="w"> </span><span class="m">15</span>
</code></pre></div>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-153-1" name="__codelineno-153-1" href="#__codelineno-153-1"></a><span class="nv">KUBECONFIG</span><span class="o">=</span>~/.kube/config<span class="w"> </span>kubectl<span class="w"> </span>--context<span class="w"> </span>kind-guilder<span class="w"> </span>get<span class="w"> </span>rs<span class="w"> </span>-n<span class="w"> </span>commonstuff<span class="w"> </span>commond<span class="w"> </span>-o<span class="w"> </span>yaml
</code></pre></div>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-154-1" name="__codelineno-154-1" href="#__codelineno-154-1"></a>...
<a id="__codelineno-154-2" name="__codelineno-154-2" href="#__codelineno-154-2"></a><span class="w">      </span>containers:
<a id="__codelineno-154-3" name="__codelineno-154-3" href="#__codelineno-154-3"></a><span class="w">      </span>-<span class="w"> </span>env:
<a id="__codelineno-154-4" name="__codelineno-154-4" href="#__codelineno-154-4"></a><span class="w">        </span>-<span class="w"> </span>name:<span class="w"> </span>EXAMPLE_VAR
<a id="__codelineno-154-5" name="__codelineno-154-5" href="#__codelineno-154-5"></a><span class="w">          </span>value:<span class="w"> </span>env<span class="w"> </span>is<span class="w"> </span>prod
<a id="__codelineno-154-6" name="__codelineno-154-6" href="#__codelineno-154-6"></a><span class="w">        </span>image:<span class="w"> </span>library/httpd:2.4
<a id="__codelineno-154-7" name="__codelineno-154-7" href="#__codelineno-154-7"></a><span class="w">        </span>imagePullPolicy:<span class="w"> </span>IfNotPresent
<a id="__codelineno-154-8" name="__codelineno-154-8" href="#__codelineno-154-8"></a><span class="w">        </span>name:<span class="w"> </span>httpd
<a id="__codelineno-154-9" name="__codelineno-154-9" href="#__codelineno-154-9"></a>...
</code></pre></div></p>
<p>Check that the common workload on the florin cluster is working.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-155-1" name="__codelineno-155-1" href="#__codelineno-155-1"></a><span class="nb">let</span><span class="w"> </span><span class="nv">tries</span><span class="o">=</span><span class="m">1</span>
<a id="__codelineno-155-2" name="__codelineno-155-2" href="#__codelineno-155-2"></a><span class="k">while</span><span class="w"> </span>!<span class="w"> </span>curl<span class="w"> </span>http://localhost:8094<span class="w"> </span><span class="p">&amp;</span>&gt;<span class="w"> </span>/dev/null<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<a id="__codelineno-155-3" name="__codelineno-155-3" href="#__codelineno-155-3"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">((</span><span class="w"> </span>tries<span class="w"> </span>&gt;<span class="o">=</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="o">))</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<a id="__codelineno-155-4" name="__codelineno-155-4" href="#__codelineno-155-4"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;The common workload failed to come up on florin!&#39;</span><span class="w"> </span>&gt;<span class="p">&amp;</span><span class="m">2</span>
<a id="__codelineno-155-5" name="__codelineno-155-5" href="#__codelineno-155-5"></a><span class="w">    </span><span class="nb">exit</span><span class="w"> </span><span class="m">10</span>
<a id="__codelineno-155-6" name="__codelineno-155-6" href="#__codelineno-155-6"></a><span class="w">  </span><span class="k">fi</span>
<a id="__codelineno-155-7" name="__codelineno-155-7" href="#__codelineno-155-7"></a><span class="w">  </span><span class="nb">let</span><span class="w"> </span><span class="nv">tries</span><span class="o">=</span>tries+1
<a id="__codelineno-155-8" name="__codelineno-155-8" href="#__codelineno-155-8"></a><span class="w">  </span>sleep<span class="w"> </span><span class="m">10</span>
<a id="__codelineno-155-9" name="__codelineno-155-9" href="#__codelineno-155-9"></a><span class="k">done</span>
<a id="__codelineno-155-10" name="__codelineno-155-10" href="#__codelineno-155-10"></a>curl<span class="w"> </span>http://localhost:8094
</code></pre></div>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-156-1" name="__codelineno-156-1" href="#__codelineno-156-1"></a>&lt;!DOCTYPE<span class="w"> </span>html&gt;
<a id="__codelineno-156-2" name="__codelineno-156-2" href="#__codelineno-156-2"></a>&lt;html&gt;
<a id="__codelineno-156-3" name="__codelineno-156-3" href="#__codelineno-156-3"></a><span class="w">  </span>&lt;body&gt;
<a id="__codelineno-156-4" name="__codelineno-156-4" href="#__codelineno-156-4"></a><span class="w">    </span>This<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>common<span class="w"> </span>web<span class="w"> </span>site.
<a id="__codelineno-156-5" name="__codelineno-156-5" href="#__codelineno-156-5"></a><span class="w">    </span>Running<span class="w"> </span><span class="k">in</span><span class="w"> </span>florin.
<a id="__codelineno-156-6" name="__codelineno-156-6" href="#__codelineno-156-6"></a><span class="w">  </span>&lt;/body&gt;
<a id="__codelineno-156-7" name="__codelineno-156-7" href="#__codelineno-156-7"></a>&lt;/html&gt;
</code></pre></div></p>
<p>Check that the special workload on the guilder cluster is working.
<div class="highlight"><pre><span></span><code><a id="__codelineno-157-1" name="__codelineno-157-1" href="#__codelineno-157-1"></a><span class="nb">let</span><span class="w"> </span><span class="nv">tries</span><span class="o">=</span><span class="m">1</span>
<a id="__codelineno-157-2" name="__codelineno-157-2" href="#__codelineno-157-2"></a><span class="k">while</span><span class="w"> </span>!<span class="w"> </span>curl<span class="w"> </span>http://localhost:8097<span class="w"> </span><span class="p">&amp;</span>&gt;<span class="w"> </span>/dev/null<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<a id="__codelineno-157-3" name="__codelineno-157-3" href="#__codelineno-157-3"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">((</span><span class="w"> </span>tries<span class="w"> </span>&gt;<span class="o">=</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="o">))</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<a id="__codelineno-157-4" name="__codelineno-157-4" href="#__codelineno-157-4"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;The special workload failed to come up on guilder!&#39;</span><span class="w"> </span>&gt;<span class="p">&amp;</span><span class="m">2</span>
<a id="__codelineno-157-5" name="__codelineno-157-5" href="#__codelineno-157-5"></a><span class="w">    </span><span class="nb">exit</span><span class="w"> </span><span class="m">10</span>
<a id="__codelineno-157-6" name="__codelineno-157-6" href="#__codelineno-157-6"></a><span class="w">  </span><span class="k">fi</span>
<a id="__codelineno-157-7" name="__codelineno-157-7" href="#__codelineno-157-7"></a><span class="w">  </span><span class="nb">let</span><span class="w"> </span><span class="nv">tries</span><span class="o">=</span>tries+1
<a id="__codelineno-157-8" name="__codelineno-157-8" href="#__codelineno-157-8"></a><span class="w">  </span>sleep<span class="w"> </span><span class="m">10</span>
<a id="__codelineno-157-9" name="__codelineno-157-9" href="#__codelineno-157-9"></a><span class="k">done</span>
<a id="__codelineno-157-10" name="__codelineno-157-10" href="#__codelineno-157-10"></a>curl<span class="w"> </span>http://localhost:8097
</code></pre></div>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-158-1" name="__codelineno-158-1" href="#__codelineno-158-1"></a>&lt;!DOCTYPE<span class="w"> </span>html&gt;
<a id="__codelineno-158-2" name="__codelineno-158-2" href="#__codelineno-158-2"></a>&lt;html&gt;
<a id="__codelineno-158-3" name="__codelineno-158-3" href="#__codelineno-158-3"></a><span class="w">  </span>&lt;body&gt;
<a id="__codelineno-158-4" name="__codelineno-158-4" href="#__codelineno-158-4"></a><span class="w">    </span>This<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>special<span class="w"> </span>web<span class="w"> </span>site.
<a id="__codelineno-158-5" name="__codelineno-158-5" href="#__codelineno-158-5"></a><span class="w">    </span>Running<span class="w"> </span><span class="k">in</span><span class="w"> </span>guilder.
<a id="__codelineno-158-6" name="__codelineno-158-6" href="#__codelineno-158-6"></a><span class="w">  </span>&lt;/body&gt;
<a id="__codelineno-158-7" name="__codelineno-158-7" href="#__codelineno-158-7"></a>&lt;/html&gt;
</code></pre></div></p>
<p>Check that the common workload on the guilder cluster is working.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-159-1" name="__codelineno-159-1" href="#__codelineno-159-1"></a><span class="nb">let</span><span class="w"> </span><span class="nv">tries</span><span class="o">=</span><span class="m">1</span>
<a id="__codelineno-159-2" name="__codelineno-159-2" href="#__codelineno-159-2"></a><span class="k">while</span><span class="w"> </span>!<span class="w"> </span>curl<span class="w"> </span>http://localhost:8096<span class="w"> </span><span class="p">&amp;</span>&gt;<span class="w"> </span>/dev/null<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<a id="__codelineno-159-3" name="__codelineno-159-3" href="#__codelineno-159-3"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">((</span><span class="w"> </span>tries<span class="w"> </span>&gt;<span class="o">=</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="o">))</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<a id="__codelineno-159-4" name="__codelineno-159-4" href="#__codelineno-159-4"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;The common workload failed to come up on guilder!&#39;</span><span class="w"> </span>&gt;<span class="p">&amp;</span><span class="m">2</span>
<a id="__codelineno-159-5" name="__codelineno-159-5" href="#__codelineno-159-5"></a><span class="w">    </span><span class="nb">exit</span><span class="w"> </span><span class="m">10</span>
<a id="__codelineno-159-6" name="__codelineno-159-6" href="#__codelineno-159-6"></a><span class="w">  </span><span class="k">fi</span>
<a id="__codelineno-159-7" name="__codelineno-159-7" href="#__codelineno-159-7"></a><span class="w">  </span><span class="nb">let</span><span class="w"> </span><span class="nv">tries</span><span class="o">=</span>tries+1
<a id="__codelineno-159-8" name="__codelineno-159-8" href="#__codelineno-159-8"></a><span class="w">  </span>sleep<span class="w"> </span><span class="m">10</span>
<a id="__codelineno-159-9" name="__codelineno-159-9" href="#__codelineno-159-9"></a><span class="k">done</span>
<a id="__codelineno-159-10" name="__codelineno-159-10" href="#__codelineno-159-10"></a>curl<span class="w"> </span>http://localhost:8096
</code></pre></div>
<div class="no-copy highlight"><pre><span></span><code><a id="__codelineno-160-1" name="__codelineno-160-1" href="#__codelineno-160-1"></a>&lt;!DOCTYPE<span class="w"> </span>html&gt;
<a id="__codelineno-160-2" name="__codelineno-160-2" href="#__codelineno-160-2"></a>&lt;html&gt;
<a id="__codelineno-160-3" name="__codelineno-160-3" href="#__codelineno-160-3"></a><span class="w">  </span>&lt;body&gt;
<a id="__codelineno-160-4" name="__codelineno-160-4" href="#__codelineno-160-4"></a><span class="w">    </span>This<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>common<span class="w"> </span>web<span class="w"> </span>site.
<a id="__codelineno-160-5" name="__codelineno-160-5" href="#__codelineno-160-5"></a><span class="w">    </span>Running<span class="w"> </span><span class="k">in</span><span class="w"> </span>guilder.
<a id="__codelineno-160-6" name="__codelineno-160-6" href="#__codelineno-160-6"></a><span class="w">  </span>&lt;/body&gt;
<a id="__codelineno-160-7" name="__codelineno-160-7" href="#__codelineno-160-7"></a>&lt;/html&gt;
</code></pre></div></p>
<!--example1-stage-4-stop-->

<!-- END INCLUDE -->
<!--example1-post-espw-stop-->
<!-- END INCLUDE -->

<h2 id="stage-5">Stage 5<a class="headerlink" href="#stage-5" title="Permanent link">#</a></h2>
<h3 id="singleton-reported-state-return">Singleton reported state return<a class="headerlink" href="#singleton-reported-state-return" title="Permanent link">#</a></h3>
<p>The two <code>EdgePlacement</code> objects above assert that the expected number
of executing copies of their matching workload objects is 1 and
request return of reported state to the WDS when the number of
executing copies is exactly 1.</p>
<p>For the common workload, that assertion is not correct: the number of
executing copies should be 2.  The assertion causes the actual number
of executing copies to be reported.  Check that the reported number is
2.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-161-1" name="__codelineno-161-1" href="#__codelineno-161-1"></a>kubectl<span class="w"> </span>--kubeconfig<span class="w"> </span><span class="nv">$wmw_c_space_config</span><span class="w"> </span>get<span class="w"> </span>rs<span class="w"> </span>-n<span class="w"> </span>commonstuff<span class="w"> </span>commond<span class="w"> </span>-o<span class="w"> </span>yaml<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s1">&#39;kubestellar.io/executing-count: &quot;2&quot;&#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">{</span><span class="w"> </span>kubectl<span class="w"> </span>--kubeconfig<span class="w"> </span><span class="nv">$wmw_c_space_config</span><span class="w"> </span>get<span class="w"> </span>rs<span class="w"> </span>-n<span class="w"> </span>commonstuff<span class="w"> </span>commond<span class="w"> </span>-o<span class="w"> </span>yaml<span class="p">;</span><span class="w"> </span>false<span class="p">;</span><span class="w"> </span><span class="o">}</span>
</code></pre></div>
<p>For the special workload, the number of executing copies should be 1.
Check that the reported number agrees.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-162-1" name="__codelineno-162-1" href="#__codelineno-162-1"></a>kubectl<span class="w"> </span>--kubeconfig<span class="w"> </span><span class="nv">$wmw_s_space_config</span><span class="w"> </span>get<span class="w"> </span>deploy<span class="w"> </span>-n<span class="w"> </span>specialstuff<span class="w"> </span>speciald<span class="w"> </span>-o<span class="w"> </span>yaml<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s1">&#39;kubestellar.io/executing-count: &quot;1&quot;&#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">{</span><span class="w"> </span>kubectl<span class="w"> </span>--kubeconfig<span class="w"> </span><span class="nv">$wmw_s_space_config</span><span class="w"> </span>get<span class="w"> </span>deploy<span class="w"> </span>-n<span class="w"> </span>specialstuff<span class="w"> </span>speciald<span class="w"> </span>-o<span class="w"> </span>yaml<span class="p">;</span><span class="w"> </span>false<span class="p">;</span><span class="w"> </span><span class="o">}</span>
</code></pre></div>
<p>Look at the status section of the "speciald" <code>Deployment</code> and see that
it has been filled in with the information from the guilder cluster.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-163-1" name="__codelineno-163-1" href="#__codelineno-163-1"></a>kubectl<span class="w"> </span>--kubeconfig<span class="w"> </span><span class="nv">$wmw_s_space_config</span><span class="w"> </span>get<span class="w"> </span>deploy<span class="w"> </span>-n<span class="w"> </span>specialstuff<span class="w"> </span>speciald<span class="w"> </span>-o<span class="w"> </span>yaml
</code></pre></div>
<p>Current status might not be there yet. The following command waits for
status that reports that there is a special workload pod "ready".</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-164-1" name="__codelineno-164-1" href="#__codelineno-164-1"></a><span class="nb">let</span><span class="w"> </span><span class="nv">count</span><span class="o">=</span><span class="m">1</span>
<a id="__codelineno-164-2" name="__codelineno-164-2" href="#__codelineno-164-2"></a><span class="k">while</span><span class="w"> </span>true<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<a id="__codelineno-164-3" name="__codelineno-164-3" href="#__codelineno-164-3"></a><span class="w">    </span><span class="nv">rsyaml</span><span class="o">=</span><span class="k">$(</span>kubectl<span class="w"> </span>--kubeconfig<span class="w"> </span><span class="nv">$wmw_s_space_config</span><span class="w"> </span>get<span class="w"> </span>deploy<span class="w"> </span>-n<span class="w"> </span>specialstuff<span class="w"> </span>speciald<span class="w"> </span>-o<span class="w"> </span>yaml<span class="k">)</span>
<a id="__codelineno-164-4" name="__codelineno-164-4" href="#__codelineno-164-4"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span>grep<span class="w"> </span><span class="s1">&#39;readyReplicas: 1&#39;</span><span class="w"> </span><span class="o">&lt;&lt;&lt;</span><span class="s2">&quot;</span><span class="nv">$rsyaml</span><span class="s2">&quot;</span>
<a id="__codelineno-164-5" name="__codelineno-164-5" href="#__codelineno-164-5"></a><span class="w">    </span><span class="k">then</span><span class="w"> </span><span class="nb">break</span>
<a id="__codelineno-164-6" name="__codelineno-164-6" href="#__codelineno-164-6"></a><span class="w">    </span><span class="k">fi</span>
<a id="__codelineno-164-7" name="__codelineno-164-7" href="#__codelineno-164-7"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<a id="__codelineno-164-8" name="__codelineno-164-8" href="#__codelineno-164-8"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Got:&quot;</span>
<a id="__codelineno-164-9" name="__codelineno-164-9" href="#__codelineno-164-9"></a><span class="w">    </span>cat<span class="w"> </span><span class="o">&lt;&lt;&lt;</span><span class="s2">&quot;</span><span class="nv">$rsyaml</span><span class="s2">&quot;</span>
<a id="__codelineno-164-10" name="__codelineno-164-10" href="#__codelineno-164-10"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">((</span><span class="w"> </span>count<span class="w"> </span>&gt;<span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="o">))</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<a id="__codelineno-164-11" name="__codelineno-164-11" href="#__codelineno-164-11"></a><span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;Giving up!&#39;</span><span class="w"> </span>&gt;<span class="p">&amp;</span><span class="m">2</span>
<a id="__codelineno-164-12" name="__codelineno-164-12" href="#__codelineno-164-12"></a><span class="w">        </span><span class="nb">false</span>
<a id="__codelineno-164-13" name="__codelineno-164-13" href="#__codelineno-164-13"></a><span class="w">    </span><span class="k">fi</span>
<a id="__codelineno-164-14" name="__codelineno-164-14" href="#__codelineno-164-14"></a><span class="w">    </span>sleep<span class="w"> </span><span class="m">15</span>
<a id="__codelineno-164-15" name="__codelineno-164-15" href="#__codelineno-164-15"></a><span class="w">    </span><span class="nb">let</span><span class="w"> </span><span class="nv">count</span><span class="o">=</span>count+1
<a id="__codelineno-164-16" name="__codelineno-164-16" href="#__codelineno-164-16"></a><span class="k">done</span>
</code></pre></div>
<h3 id="status-summarization-aspirational">Status Summarization (aspirational)<a class="headerlink" href="#status-summarization-aspirational" title="Permanent link">#</a></h3>
<p><img alt="Summarization for special" src="../Edge-PoC-2023q1-Scenario-1-stage-5s.svg" title="Status summarization for special" /></p>
<p>The status summarizer, driven by the EdgePlacement and
SinglePlacementSlice for the special workload, creates a status
summary object in the specialstuff namespace in the special workload
workspace holding a summary of the corresponding Deployment objects.
In this case there is just one such object, in the mailbox workspace
for the guilder cluster.</p>
<p><img alt="Summarization for common" src="../Edge-PoC-2023q1-Scenario-1-stage-5c.svg" title="Status summarization for common" /></p>
<p>The status summarizer, driven by the EdgePlacement and
SinglePlacementSlice for the common workload, creates a status summary
object in the commonstuff namespace in the common workload workspace
holding a summary of the corresponding Deployment objects.  Those are
the <code>commond</code> Deployment objects in the two mailbox workspaces.</p>
<h2 id="teardown-the-environment">Teardown the environment<a class="headerlink" href="#teardown-the-environment" title="Permanent link">#</a></h2>
<!-- BEGIN INCLUDE example1-subs/example1-teardown.md '&lt;!--example1-teardown-start--&gt;' '&lt;!--example1-teardown-end--&gt;' -->

<p>To remove the example usage, delete the IMW and WMW and kind clusters run the following commands:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-165-1" name="__codelineno-165-1" href="#__codelineno-165-1"></a>rm<span class="w"> </span>florin-syncer.yaml<span class="w"> </span>guilder-syncer.yaml<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">true</span>
<a id="__codelineno-165-2" name="__codelineno-165-2" href="#__codelineno-165-2"></a>kubectl<span class="w"> </span>ws<span class="w"> </span>root
<a id="__codelineno-165-3" name="__codelineno-165-3" href="#__codelineno-165-3"></a>kubectl<span class="w"> </span>delete<span class="w"> </span>workspace<span class="w"> </span>imw1
<a id="__codelineno-165-4" name="__codelineno-165-4" href="#__codelineno-165-4"></a>kubectl<span class="w"> </span>delete<span class="w"> </span>workspace<span class="w"> </span><span class="nv">$FLORIN_WS</span>
<a id="__codelineno-165-5" name="__codelineno-165-5" href="#__codelineno-165-5"></a>kubectl<span class="w"> </span>delete<span class="w"> </span>workspace<span class="w"> </span><span class="nv">$GUILDER_WS</span>
<a id="__codelineno-165-6" name="__codelineno-165-6" href="#__codelineno-165-6"></a>kubectl<span class="w"> </span>kubestellar<span class="w"> </span>remove<span class="w"> </span>wmw<span class="w"> </span>wmw-c
<a id="__codelineno-165-7" name="__codelineno-165-7" href="#__codelineno-165-7"></a>kubectl<span class="w"> </span>kubestellar<span class="w"> </span>remove<span class="w"> </span>wmw<span class="w"> </span>wmw-s
<a id="__codelineno-165-8" name="__codelineno-165-8" href="#__codelineno-165-8"></a>kind<span class="w"> </span>delete<span class="w"> </span>cluster<span class="w"> </span>--name<span class="w"> </span>florin
<a id="__codelineno-165-9" name="__codelineno-165-9" href="#__codelineno-165-9"></a>kind<span class="w"> </span>delete<span class="w"> </span>cluster<span class="w"> </span>--name<span class="w"> </span>guilder
</code></pre></div>
<p>Teardown of KubeStellar depends on which style of deployment was used.</p>
<h3 id="teardown-bare-processes">Teardown bare processes<a class="headerlink" href="#teardown-bare-processes" title="Permanent link">#</a></h3>
<p>The following command will stop whatever KubeStellar controllers are running.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-166-1" name="__codelineno-166-1" href="#__codelineno-166-1"></a>kubestellar<span class="w"> </span>stop
</code></pre></div>
<p>Stop and uninstall KubeStellar and kcp with the following command:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-167-1" name="__codelineno-167-1" href="#__codelineno-167-1"></a>remove-kubestellar
</code></pre></div>
<h3 id="teardown-kubernetes-workload">Teardown Kubernetes workload<a class="headerlink" href="#teardown-kubernetes-workload" title="Permanent link">#</a></h3>
<p>With <code>kubectl</code> configured to manipulate the hosting cluster, the following command will remove the workload that is kcp and KubeStellar.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-168-1" name="__codelineno-168-1" href="#__codelineno-168-1"></a>helm<span class="w"> </span>delete<span class="w"> </span>kubestellar
</code></pre></div>
<!-- END INCLUDE -->


  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81Z"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14Z"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              Thanks for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              Thanks for your feedback! Help us improve this page by using our <a href="https://github.com/kubestellar/kubestellar/issues/new?assignees=&labels=kind%2Fbug&projects=&template=bug_report.yaml&title=bug%3A+" target="_blank" rel="noopener">feedback form</a>.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../kubestellar-syncer/" class="md-footer__link md-footer__link--prev" aria-label="Previous: KubeStellar-Syncer" rel="prev">
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <div class="md-ellipsis">
                <span class="md-footer__direction">
                  Previous
                </span>
                KubeStellar-Syncer
              </div>
            </div>
          </a>
        
        
          
          <a href="../where-resolver/" class="md-footer__link md-footer__link--next" aria-label="Next: KubeStellar Where Resolver" rel="next">
            <div class="md-footer__title">
              <div class="md-ellipsis">
                <span class="md-footer__direction">
                  Next
                </span>
                KubeStellar Where Resolver
              </div>
            </div>
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["content.action.edit", "content.action.view", "navigation.indexes", "navigation.tabs", "navigation.path", "navigation.footer", "content.code.copy", "content.code.annotate"], "search": "../../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "stable", "provider": "mike"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.ce72ebac.min.js"></script>
      
        <script src="../../../../js/open_in_new_tab.js"></script>
      
    
  </body>
</html>